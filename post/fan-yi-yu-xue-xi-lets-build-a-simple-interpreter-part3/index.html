<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ztree
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="ztree">
<meta name="description" content="ç«¹æ–èŠ’é‹è½»èƒœé©¬ï¼Œè°æ€•ï¼Ÿä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿã€‚">
<meta name="keywords" content="Binary">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://lzxzl.github.io/styles/main.css" />
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                        <!--CDNæ ·å¼-->
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://lzxzl.github.io">
                    ztree
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        é¦–é¡µ
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        å½’æ¡£
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        æ ‡ç­¾
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        å…³äº
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://lzxzl.github.io">
                            ztree
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            é¦–é¡µ
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            å½’æ¡£
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            æ ‡ç­¾
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            å…³äº
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part3.
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            ztree
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2021-11-11</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">25.8
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">5235</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">ç¼–è¯‘åŸç†</a>
                                
                            </span>
                                            
                                                é˜…è¯»é‡:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <p>I woke up this morning and I thought to myself: â€œWhy do we find it so difficult to learn a newÂ skill?â€</p>
<p>ä»Šå¤©æ—©ä¸Šæˆ‘é†’æ¥ï¼Œæˆ‘å¯¹è‡ªå·±è¯´: â€œä¸ºä»€ä¹ˆæˆ‘ä»¬å‘ç°å­¦ä¹ ä¸€é¡¹æ–°æŠ€èƒ½å¦‚æ­¤å›°éš¾?â€</p>
<p>I donâ€™t think itâ€™s just because of the hard work. I think that one of the reasons might be that we spend a lot of time and hard work acquiring knowledge by reading and watching and not enough time translating that knowledge into a skill by practicing it. Take swimming, for example. You can spend a lot of time reading hundreds of books about swimming, talk for hours with experienced swimmers and coaches, watch all the training videos available, and you still will sink like a rock the first time you jump in theÂ pool.</p>
<p>æˆ‘è®¤ä¸ºè¿™ä¸ä»…ä»…æ˜¯å› ä¸ºè¾›è‹¦çš„å·¥ä½œã€‚æˆ‘è®¤ä¸ºå…¶ä¸­ä¸€ä¸ªåŸå› å¯èƒ½æ˜¯æˆ‘ä»¬èŠ±è´¹äº†å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›é€šè¿‡é˜…è¯»å’Œè§‚å¯Ÿæ¥è·å–çŸ¥è¯†ï¼Œè€Œæ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´é€šè¿‡å®è·µå°†çŸ¥è¯†è½¬åŒ–ä¸ºæŠ€èƒ½ã€‚ä»¥æ¸¸æ³³ä¸ºä¾‹ã€‚ä½ å¯ä»¥èŠ±å¾ˆå¤šæ—¶é—´é˜…è¯»æ•°ç™¾æœ¬å…³äºæ¸¸æ³³çš„ä¹¦ç±ï¼Œä¸ç»éªŒä¸°å¯Œçš„æ¸¸æ³³è¿åŠ¨å‘˜å’Œæ•™ç»ƒäº¤è°ˆå‡ ä¸ªå°æ—¶ï¼Œè§‚çœ‹æ‰€æœ‰å¯ç”¨çš„è®­ç»ƒè§†é¢‘ï¼Œä½†æ˜¯ä½ ä»ç„¶ä¼šåœ¨ç¬¬ä¸€æ¬¡è·³è¿›æ¸¸æ³³æ± çš„æ—¶å€™åƒä¸€å—çŸ³å¤´ä¸€æ ·æ²‰ä¸‹å»ã€‚</p>
<p>The bottom line is: it doesnâ€™t matter how well you think you know the subject - you have to put that knowledge into practice to turn it into a skill. To help you with the practice part I put exercises into <a href="http://ruslanspivak.com/lsbasi-part1/">Part 1</a> and <a href="http://ruslanspivak.com/lsbasi-part2/">Part 2</a> of the series. And yes, you will see more exercises in todayâ€™s article and in future articles, I promiseÂ ğŸ˜ƒ</p>
<p>åº•çº¿æ˜¯: æ— è®ºä½ è®¤ä¸ºè‡ªå·±å¤šä¹ˆäº†è§£è¿™é—¨å­¦ç§‘â€”â€”ä½ å¿…é¡»æŠŠè¿™äº›çŸ¥è¯†è½¬åŒ–ä¸ºå®è·µï¼ŒæŠŠå®ƒå˜æˆä¸€ç§æŠ€èƒ½ã€‚ä¸ºäº†å¸®åŠ©æ‚¨è¿›è¡Œç»ƒä¹ ï¼Œæˆ‘å°†ç»ƒä¹ æ”¾åœ¨æœ¬ç³»åˆ—çš„ç¬¬1éƒ¨åˆ†å’Œç¬¬2éƒ¨åˆ†ä¸­ã€‚æ˜¯çš„ï¼Œä½ ä¼šåœ¨ä»Šå¤©çš„æ–‡ç« å’Œä»¥åçš„æ–‡ç« ä¸­çœ‹åˆ°æ›´å¤šçš„ç»ƒä¹ ï¼Œæˆ‘ä¿è¯:)</p>
<p>Okay, letâ€™s get started with todayâ€™s material, shallÂ we?</p>
<p>å¥½äº†ï¼Œè®©æˆ‘ä»¬å¼€å§‹ä»Šå¤©çš„å†…å®¹ï¼Œå¥½å—ï¼Ÿ</p>
<p>So far, youâ€™ve learned how to interpret arithmetic expressions that add or subtract two integers like â€œ7 + 3â€ or â€œ12 - 9â€. Today Iâ€™m going to talk about how to parse (recognize) and interpret arithmetic expressions that have any number of plus or minus operators in it, for example â€œ7 - 3 + 2 -Â 1â€.</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»å­¦ä¹ äº†å¦‚ä½•è§£é‡ŠåŠ å‡ä¸¤ä¸ªæ•´æ•°çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œæ¯”å¦‚â€œ7 + 3â€æˆ–â€œ12-9â€ã€‚ä»Šå¤©æˆ‘å°†è®¨è®ºå¦‚ä½•è§£æï¼ˆè¯†åˆ«ï¼‰å’Œè§£é‡ŠåŒ…å«ä»»æ„æ•°é‡æ­£è´Ÿè¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œä¾‹å¦‚â€œ7-3 + 2-1â€ã€‚</p>
<p>Graphically, the arithmetic expressions in this article can be represented with the following syntaxÂ diagram:</p>
<p>ä»å›¾å½¢ä¸Šçœ‹ï¼Œæœ¬æ–‡ä¸­çš„ç®—æœ¯è¡¨è¾¾å¼å¯ä»¥ç”¨ä»¥ä¸‹è¯­æ³•å›¾è¡¨ç¤º:</p>
<figure data-type="image" tabindex="1"><img src="https://ruslanspivak.com/lsbasi-part3/lsbasi_part3_syntax_diagram.png" alt="" loading="lazy"></figure>
<p>What is a syntax diagram? A <strong>syntax diagram</strong> is a graphical representation of a programming languageâ€™s syntax rules. Basically, a syntax diagram visually shows you which statements are allowed in your programming language and which areÂ not.</p>
<p>ä»€ä¹ˆæ˜¯è¯­æ³•å›¾ï¼Ÿè¯­æ³•å›¾æ˜¯ç¼–ç¨‹è¯­è¨€è¯­æ³•è§„åˆ™çš„å›¾å½¢åŒ–è¡¨ç¤ºã€‚åŸºæœ¬ä¸Šï¼Œè¯­æ³•å›¾å¯è§†åŒ–åœ°æ˜¾ç¤ºç¼–ç¨‹è¯­è¨€ä¸­å“ªäº›è¯­å¥æ˜¯å…è®¸çš„ï¼Œå“ªäº›æ˜¯ä¸å…è®¸çš„ã€‚</p>
<p>Syntax diagrams are pretty easy to read: just follow the paths indicated by the arrows. Some paths indicate choices. And some paths indicateÂ loops.</p>
<p>è¯­æ³•å›¾å¾ˆå®¹æ˜“é˜…è¯»: åªéœ€æ²¿ç€ç®­å¤´æ‰€æŒ‡ç¤ºçš„è·¯å¾„èµ°å°±å¯ä»¥äº†ã€‚æœ‰äº›è·¯å¾„è¡¨ç¤ºé€‰æ‹©ã€‚æœ‰äº›è·¯å¾„è¡¨ç¤ºå¾ªç¯ã€‚</p>
<p>You can read the above syntax diagram as following: a term optionally followed by a plus or minus sign, followed by another term, which in turn is optionally followed by a plus or minus sign followed by another term and so on. You get the picture, literally. You might wonder what a <em>â€œtermâ€</em> is. For the purpose of this article a <em>â€œtermâ€</em> is just anÂ integer.</p>
<p>ä½ å¯ä»¥é˜…è¯»ä¸Šé¢çš„è¯­æ³•å›¾: ä¸€ä¸ªtermå¯é€‰åœ°åè·Ÿä¸€ä¸ªåŠ å·æˆ–å‡å·ï¼Œå†åé¢è·Ÿç€å¦ä¸€ä¸ªtermï¼Œè¿™ä¸ªtermåˆå¯é€‰åœ°åè·Ÿä¸€ä¸ªåŠ å·æˆ–å‡å·ï¼Œåé¢åˆè·Ÿç€å¦ä¸€ä¸ªtermç­‰ç­‰ã€‚ä½ æ˜ç™½äº†å§ï¼ŒçœŸçš„ã€‚ä½ å¯èƒ½æƒ³çŸ¥é“â€œtermâ€æ˜¯ä»€ä¹ˆã€‚å¯¹äºæœ¬æ–‡æ¥è¯´ï¼Œâ€œ termâ€åªæ˜¯ä¸€ä¸ªæ•´æ•°ã€‚</p>
<p>Syntax diagrams serve two mainÂ purposes:</p>
<p>è¯­æ³•å›¾æœ‰ä¸¤ä¸ªä¸»è¦ç”¨é€”:</p>
<ul>
<li>They graphically represent the specification (grammar) of a programmingÂ language.
<ul>
<li>å®ƒä»¬ä»¥å›¾å½¢æ–¹å¼è¡¨ç¤ºç¼–ç¨‹è¯­è¨€çš„è§„èŒƒ(è¯­æ³•)</li>
</ul>
</li>
<li>They can be used to help you write your parser - you can map a diagram to code by following simpleÂ rules.
<ul>
<li>å®ƒä»¬å¯ä»¥ç”¨æ¥å¸®åŠ©ä½ ç¼–å†™è§£æå™¨â€”â€”ä½ å¯ä»¥é€šè¿‡éµå¾ªç®€å•çš„è§„åˆ™å°†å›¾è¡¨æ˜ å°„åˆ°ä»£ç </li>
</ul>
</li>
</ul>
<p>Youâ€™ve learned that the process of recognizing a phrase in the stream of tokens is called <strong>parsing</strong>. And the part of an interpreter or compiler that performs that job is called a <strong>parser</strong>. Parsing is also called <strong>syntax analysis</strong>, and the parser is also aptly called, you guessed it right, a <strong>syntax analyzer</strong>.</p>
<p>ä½ å·²ç»äº†è§£åˆ°ï¼Œè¯†åˆ«tokenæµä¸­çš„phraseçš„è¿‡ç¨‹ç§°ä¸ºè§£æã€‚è§£é‡Šå™¨æˆ–ç¼–è¯‘å™¨ä¸­æ‰§è¡Œè¿™é¡¹å·¥ä½œçš„éƒ¨åˆ†ç§°ä¸ºè§£æå™¨ã€‚è§£æä¹Ÿç§°ä¸ºè¯­æ³•åˆ†æï¼Œ<strong>è§£æå™¨ä¹Ÿæ°å¦‚å…¶åˆ†åœ°ç§°ä¸ºè¯­æ³•åˆ†æå™¨</strong>ï¼ˆä½ çŒœå¯¹äº†ï¼‰ã€‚</p>
<p>According to the syntax diagram above, all of the following arithmetic expressions areÂ valid:</p>
<p>æ ¹æ®ä¸Šé¢çš„è¯­æ³•å›¾ï¼Œä¸‹é¢æ‰€æœ‰çš„ç®—æœ¯è¡¨è¾¾å¼éƒ½æ˜¯æœ‰æ•ˆçš„:</p>
<ul>
<li>3</li>
<li>3 +Â 4 3 + 4</li>
<li>7 - 3 + 2 -Â 1 7-3 + 2-1</li>
</ul>
<p>Because syntax rules for arithmetic expressions in different programming languages are very similar we can use a Python shell to â€œtestâ€ our syntax diagram. Launch your Python shell and see forÂ yourself:</p>
<p>å› ä¸ºä¸åŒç¼–ç¨‹è¯­è¨€ä¸­ç®—æœ¯è¡¨è¾¾å¼çš„è¯­æ³•è§„åˆ™éå¸¸ç›¸ä¼¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Python shell æ¥â€œæµ‹è¯•â€æˆ‘ä»¬çš„è¯­æ³•å›¾ã€‚å¯åŠ¨ä½ çš„ Python shellï¼Œè‡ªå·±çœ‹çœ‹:</p>
<pre><code class="language-python">&gt;&gt;&gt; 3
3
&gt;&gt;&gt; 3 + 4
7
&gt;&gt;&gt; 7 - 3 + 2 - 1
5
</code></pre>
<p>No surprisesÂ here.</p>
<p>è¿™é‡Œæ²¡æœ‰æƒŠå–œã€‚</p>
<p>The expression â€œ3 + â€ is not a valid arithmetic expression though because according to the syntax diagram the plus sign must be followed by a <em>term</em> (integer), otherwise itâ€™s a syntax error. Again, try it with a Python shell and see forÂ yourself:</p>
<p>è¡¨è¾¾å¼â€œ3 +â€ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œå› ä¸ºæ ¹æ®è¯­æ³•å›¾è¡¨ï¼ŒåŠ å·åé¢å¿…é¡»è·Ÿç€ä¸€ä¸ªterm(æ•´æ•°) ï¼Œå¦åˆ™å®ƒæ˜¯ä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚å†æ¬¡ï¼Œç”¨ Python shell å°è¯•ä¸€ä¸‹ï¼Œä½ è‡ªå·±çœ‹çœ‹:</p>
<pre><code class="language-python">&gt;&gt;&gt; 3 +
  File &quot;&lt;stdin&gt;&quot;, line 1
    3 +
      ^
SyntaxError: invalid syntax
</code></pre>
<p>Itâ€™s great to be able to use a Python shell to do some testing but letâ€™s map the above syntax diagram to code and use our own interpreter for testing, allÂ right?</p>
<p>èƒ½å¤Ÿä½¿ç”¨ Python shell è¿›è¡Œä¸€äº›æµ‹è¯•æ˜¯å¾ˆæ£’çš„ï¼Œä½†æ˜¯è®©æˆ‘ä»¬å°†ä¸Šé¢çš„è¯­æ³•å›¾æ˜ å°„åˆ°ä»£ç ä¸­ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„è§£é‡Šå™¨è¿›è¡Œæµ‹è¯•ï¼Œå¥½å—ï¼Ÿ</p>
<p>You know from the previous articles (<a href="http://ruslanspivak.com/lsbasi-part1/">Part 1</a> and <a href="http://ruslanspivak.com/lsbasi-part2/">Part 2</a>) that the <em>expr</em> method is where both our parser and interpreter live. Again, the parser just recognizes the structure making sure that it corresponds to some specifications and the interpreter actually evaluates the expression once the parser has successfully recognized (parsed)Â it.</p>
<p>ä»å‰é¢çš„æ–‡ç« ï¼ˆç¬¬1éƒ¨åˆ†å’Œç¬¬2éƒ¨åˆ†ï¼‰ä¸­å¯ä»¥çŸ¥é“ï¼Œexpr æ–¹æ³•æ˜¯æˆ‘ä»¬çš„è§£æå™¨å’Œè§£é‡Šå™¨æ‰€åœ¨çš„åœ°æ–¹ã€‚åŒæ ·ï¼Œè§£æå™¨åªæ˜¯è¯†åˆ«ç»“æ„ï¼Œç¡®ä¿å®ƒå¯¹åº”äºæŸäº›è§„èŒƒï¼Œå¹¶ä¸”è§£é‡Šå™¨å®é™…ä¸Šåœ¨è§£æå™¨æˆåŠŸè¯†åˆ«ï¼ˆè§£æï¼‰è¡¨è¾¾å¼ä¹‹åå¯¹å…¶è¿›è¡Œè®¡ç®—ã€‚</p>
<p>The following code snippet shows the parser code corresponding to the diagram. The rectangular box from the syntax diagram (<em>term</em>) becomes a <em>term</em> method that parses an integer and the <em>expr</em> method just follows the syntax diagramÂ flow:</p>
<p>ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†ä¸å›¾å¯¹åº”çš„è§£æå™¨ä»£ç ã€‚è¯­æ³•å›¾ï¼ˆtermï¼‰ä¸­çš„çŸ©å½¢æ¡†å˜æˆäº†è§£ææ•´æ•°çš„ term æ–¹æ³•ï¼Œexpr æ–¹æ³•åªéµå¾ªè¯­æ³•å›¾æµç¨‹ï¼š</p>
<pre><code class="language-python">def term(self):
    self.eat(INTEGER)

def expr(self):
    # set current token to the first token taken from the input
    self.current_token = self.get_next_token()

    self.term()
    while self.current_token.type in (PLUS, MINUS):
        token = self.current_token
        if token.type == PLUS:
            self.eat(PLUS)
            self.term()
        elif token.type == MINUS:
            self.eat(MINUS)
            self.term()
</code></pre>
<p>You can see that <em>expr</em> first calls the <em>term</em> method. Then the <em>expr</em> method has a <em>while</em> loop which can execute zero or more times. And inside the loop the parser makes a choice based on the token (whether itâ€™s a plus or minus sign). Spend some time proving to yourself that the code above does indeed follow the syntax diagram flow for arithmeticÂ expressions.</p>
<p>å¯ä»¥çœ‹åˆ° expr é¦–å…ˆè°ƒç”¨ term æ–¹æ³•ã€‚ç„¶å expr æ–¹æ³•æœ‰ä¸€ä¸ª while å¾ªç¯ï¼Œå¯ä»¥æ‰§è¡Œé›¶æ¬¡æˆ–æ›´å¤šæ¬¡ã€‚åœ¨å¾ªç¯ä¸­ï¼Œè§£æå™¨æ ¹æ®tokenï¼ˆæ˜¯åŠ å·è¿˜æ˜¯å‡å·ï¼‰åšå‡ºé€‰æ‹©ã€‚èŠ±äº›æ—¶é—´è¯æ˜ä¸Šé¢çš„ä»£ç ç¡®å®éµå¾ªäº†ç®—æœ¯è¡¨è¾¾å¼çš„è¯­æ³•å›¾æµç¨‹ã€‚</p>
<p>The parser itself does not interpret anything though: if it recognizes an expression itâ€™s silent and if it doesnâ€™t, it throws out a syntax error. Letâ€™s modify the <em>expr</em> method and add the interpreterÂ code:</p>
<p>ä½†æ˜¯è§£æå™¨æœ¬èº«å¹¶ä¸è§£é‡Šä»»ä½•ä¸œè¥¿ï¼šå¦‚æœå®ƒè¯†åˆ«å‡ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é™é»˜çš„ï¼Œå¦‚æœå®ƒæ²¡æœ‰ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæŠ›å‡ºä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚è®©æˆ‘ä»¬ä¿®æ”¹ expr æ–¹æ³•å¹¶æ·»åŠ è§£é‡Šå™¨ä»£ç :</p>
<pre><code class="language-python">def term(self):
    &quot;&quot;&quot;Return an INTEGER token value&quot;&quot;&quot;
    token = self.current_token # è·å–å½“å‰token
    self.eat(INTEGER) # å¦‚æœå½“å‰tokenæ˜¯æ•´æ•°
    return token.value # é‚£ä¹ˆè¿”å›tokençš„å€¼

def expr(self):
    &quot;&quot;&quot;Parser / Interpreter &quot;&quot;&quot;
    # set current token to the first token taken from the input
    self.current_token = self.get_next_token()

    result = self.term()
    while self.current_token.type in (PLUS, MINUS):
        token = self.current_token
        if token.type == PLUS:
            self.eat(PLUS)
            result = result + self.term()
        elif token.type == MINUS:
            self.eat(MINUS)
            result = result - self.term()

    return result
</code></pre>
<p>Because the interpreter needs to evaluate an expression the <em>term</em> method was modified to return an integer value and the <em>expr</em> method was modified to perform addition and subtraction at the appropriate places and return the result of interpretation. Even though the code is pretty straightforward I recommend spending some time studyingÂ it.</p>
<p>ç”±äºè§£é‡Šå™¨éœ€è¦è®¡ç®—ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å¯¹ term æ–¹æ³•è¿›è¡Œäº†ä¿®æ”¹ï¼Œä»¥è¿”å›ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè€Œå¯¹ expr æ–¹æ³•è¿›è¡Œäº†ä¿®æ”¹ï¼Œä»¥ä¾¿åœ¨é€‚å½“çš„ä½ç½®æ‰§è¡ŒåŠ å‡æ“ä½œï¼Œå¹¶è¿”å›è§£é‡Šç»“æœã€‚å°½ç®¡ä»£ç éå¸¸ç®€å•ï¼Œæˆ‘è¿˜æ˜¯å»ºè®®ä½ èŠ±ç‚¹æ—¶é—´ç ”ç©¶ä¸€ä¸‹ã€‚</p>
<p>Leâ€™s get moving and see the complete code of the interpreter now,Â okay?</p>
<p>æˆ‘ä»¬ç°åœ¨å¼€å§‹ï¼Œçœ‹çœ‹è§£é‡Šå™¨çš„å®Œæ•´ä»£ç ï¼Œå¥½å—ï¼Ÿ</p>
<p>Here is the source code for your new version of the calculator that can handle valid arithmetic expressions containing integers and any number of addition and subtractionÂ operators:</p>
<p>ä¸‹é¢æ˜¯æ–°ç‰ˆè®¡ç®—å™¨çš„æºä»£ç ï¼Œå®ƒå¯ä»¥å¤„ç†åŒ…å«æ•´æ•°å’Œä»»æ„æ•°é‡çš„åŠ å‡è¿ç®—ç¬¦çš„æœ‰æ•ˆç®—æœ¯è¡¨è¾¾å¼:</p>
<pre><code class="language-python"># Token types
#
# EOF (end-of-file) token is used to indicate that
# there is no more input left for lexical analysis
INTEGER, PLUS, MINUS, EOF = 'INTEGER', 'PLUS', 'MINUS', 'EOF'


class Token(object):
    def __init__(self, type, value):
        # token type: INTEGER, PLUS, MINUS, or EOF
        self.type = type
        # token value: non-negative integer value, '+', '-', or None
        self.value = value

    def __str__(self):
        &quot;&quot;&quot;String representation of the class instance.

        Examples:
            Token(INTEGER, 3)
            Token(PLUS, '+')
        &quot;&quot;&quot;
        return 'Token({type}, {value})'.format(
            type=self.type,
            value=repr(self.value)
        )

    def __repr__(self):
        return self.__str__()


class Interpreter(object):
    def __init__(self, text):
        # client string input, e.g. &quot;3 + 5&quot;, &quot;12 - 5 + 3&quot;, etc
        self.text = text
        # self.pos is an index into self.text
        self.pos = 0
        # current token instance
        self.current_token = None
        self.current_char = self.text[self.pos]

    ##########################################################
    # Lexer code            è¯æ³•åˆ†æå™¨ä»£ç                      #
    ##########################################################
    def error(self):
        raise Exception('Invalid syntax')

    def advance(self):
        &quot;&quot;&quot;Advance the `pos` pointer and set the `current_char` variable.&quot;&quot;&quot;
        self.pos += 1
        if self.pos &gt; len(self.text) - 1:
            self.current_char = None  # Indicates end of input
        else:
            self.current_char = self.text[self.pos]

    def skip_whitespace(self):
        while self.current_char is not None and self.current_char.isspace():
            self.advance()

    def integer(self):
        &quot;&quot;&quot;Return a (multidigit) integer consumed from the input.&quot;&quot;&quot;
        result = ''
        while self.current_char is not None and self.current_char.isdigit():
            result += self.current_char
            self.advance()
        return int(result)

    def get_next_token(self):
        &quot;&quot;&quot;Lexical analyzer (also known as scanner or tokenizer)

        This method is responsible for breaking a sentence
        apart into tokens. One token at a time.
        &quot;&quot;&quot;
        while self.current_char is not None:

            if self.current_char.isspace():
                self.skip_whitespace()
                continue

            if self.current_char.isdigit():
                return Token(INTEGER, self.integer())

            if self.current_char == '+':
                self.advance()
                return Token(PLUS, '+')

            if self.current_char == '-':
                self.advance()
                return Token(MINUS, '-')

            self.error()

        return Token(EOF, None)

    ##########################################################
    # Parser / Interpreter code         è§£æå™¨/è§£é‡Šå™¨ä»£ç       #
    ##########################################################
    def eat(self, token_type):
        # compare the current token type with the passed token æ¯”è¾ƒå½“å‰tokençš„typeå’Œä¼ å…¥çš„tokençš„typeæ˜¯å¦ä¸€æ ·
        # type and if they match then &quot;eat&quot; the current token
        # and assign the next token to the self.current_token, å¦‚æœä¸€æ ·ï¼Œåˆ™å°†self.get_next_tokenè¿”å›çš„å€¼èµ‹å€¼ç»™self.current_token
        # otherwise raise an exception.
        if self.current_token.type == token_type:
            self.current_token = self.get_next_token()
        else:
            self.error()

    def term(self):
        &quot;&quot;&quot;Return an INTEGER token value.
        è¿”å›ä¸€ä¸ª INTERGER tokençš„å€¼
        &quot;&quot;&quot; 
        token = self.current_token
        self.eat(INTEGER)
        return token.value

    def expr(self):
        &quot;&quot;&quot;Arithmetic expression parser / interpreter.
        ç®—æœ¯è¡¨è¾¾å¼è§£æå™¨/è§£é‡Šå™¨
        &quot;&quot;&quot;
        # set current token to the first token taken from the input
        self.current_token = self.get_next_token() # ä»è¾“å…¥è·å–ç¬¬ä¸€ä¸ªtoken

        result = self.term() # å¾—åˆ°ç¬¬ä¸€ä¸ªtokençš„å€¼ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªtokenç»™self.current_token
        while self.current_token.type in (PLUS, MINUS): # é€šè¿‡åˆ¤æ–­å½“å‰tokençš„å€¼æ˜¯å¦æ˜¯åŠ æ³•æˆ–å‡æ³•
            token = self.current_token # æ“ä½œç¬¦
            if token.type == PLUS:    # æ ¹æ®æ“ä½œç¬¦çš„ç±»å‹ï¼Œåšç›¸åº”çš„æ“ä½œ
                self.eat(PLUS) # åƒæ‰+æ“ä½œç¬¦ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªtokenç»™self.current_token
                result = result + self.term() # self.term()è¿”å›â€œç¬¬äºŒä¸ªâ€æ“ä½œæ•°çš„å€¼ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªtokenèµ‹å€¼ç»™self.current_tokenï¼Œç”¨äºå¾ªç¯çš„è¿›è¡Œï¼Œè¿™æ˜¯å¾ªç¯çš„å…³é”®ï¼ï¼ï¼
            elif token.type == MINUS:
                self.eat(MINUS)
                result = result - self.term()

        return result


def main():
    while True:
        try:
            text = input('calc&gt; ')
        except EOFError:
            break
        if not text:
            continue
        interpreter = Interpreter(text)
        result = interpreter.expr()
        print(result)


if __name__ == '__main__':
    main()

</code></pre>
<p>Save the above code into the <em>calc3.py</em> file or download it directly from <a href="https://github.com/rspivak/lsbasi/blob/master/part3/calc3.py">GitHub</a>. Try it out. See for yourself that it can handle arithmetic expressions that you can derive from the syntax diagram I showed youÂ earlier.</p>
<p>å°†ä¸Šé¢çš„ä»£ç ä¿å­˜åˆ° calc3.py æ–‡ä»¶ä¸­ï¼Œæˆ–è€…ç›´æ¥ä» GitHub ä¸‹è½½ã€‚å°è¯•ä¸€ä¸‹ã€‚ä½ è‡ªå·±çœ‹çœ‹ï¼Œå®ƒå¯ä»¥å¤„ç†æ‚¨å¯ä»¥ä»æˆ‘å‰é¢ç»™ä½ å±•ç¤ºçš„è¯­æ³•å›¾ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ç®—æœ¯è¡¨è¾¾å¼ã€‚</p>
<p>Here is a sample session that I ran on myÂ laptop:</p>
<p>ä¸‹é¢æ˜¯æˆ‘åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šè¿è¡Œçš„ä¸€ä¸ªç¤ºä¾‹ä¼šè¯:</p>
<pre><code class="language-python">$ python calc3.py
calc&gt; 3
3
calc&gt; 7 - 4
3
calc&gt; 10 + 5
15
calc&gt; 7 - 3 + 2 - 1
5
calc&gt; 10 + 1 + 2 - 3 + 4 + 6 - 15
5
calc&gt; 3 +
Traceback (most recent call last):
  File &quot;calc3.py&quot;, line 147, in &lt;module&gt;
    main()
  File &quot;calc3.py&quot;, line 142, in main
    result = interpreter.expr()
  File &quot;calc3.py&quot;, line 123, in expr
    result = result + self.term()
  File &quot;calc3.py&quot;, line 110, in term
    self.eat(INTEGER)
  File &quot;calc3.py&quot;, line 105, in eat
    self.error()
  File &quot;calc3.py&quot;, line 45, in error
    raise Exception('Invalid syntax')
Exception: Invalid syntax
</code></pre>
<p>Remember those exercises I mentioned at the beginning of the article: here they are, as promisedÂ ğŸ˜ƒ</p>
<p>è¿˜è®°å¾—æˆ‘åœ¨æ–‡ç« å¼€å¤´æåˆ°çš„å¤§é‡ç»ƒä¹ å—</p>
<figure data-type="image" tabindex="2"><img src="https://ruslanspivak.com/lsbasi-part3/lsbasi_part3_exercises.png" alt="" loading="lazy"></figure>
<ul>
<li>Draw a syntax diagram for arithmetic expressions that contain only multiplication and division, for example â€œ7 * 4 / 2 * 3â€. Seriously, just grab a pen or a pencil and try to drawÂ one.
<ul>
<li>ä¸ºåªåŒ…å«ä¹˜æ³•å’Œé™¤æ³•çš„ç®—æœ¯è¡¨è¾¾å¼ç»˜åˆ¶è¯­æ³•å›¾ï¼Œä¾‹å¦‚â€œ7 * 4/2 * 3â€ã€‚è¯´çœŸçš„ï¼ŒæŠ“èµ·ä¸€æ”¯é’¢ç¬”æˆ–é“…ç¬”è¯•ç€ç”»ä¸€ä¸ª</li>
</ul>
</li>
<li>Modify the source code of the calculator to interpret arithmetic expressions that contain only multiplication and division, for example â€œ7 * 4 / 2 *Â 3â€.
<ul>
<li>ä¿®æ”¹è®¡ç®—å™¨çš„æºä»£ç ä»¥è§£é‡ŠåªåŒ…å«ä¹˜æ³•å’Œé™¤æ³•çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œä¾‹å¦‚â€œ7 * 4/2 * 3â€</li>
</ul>
</li>
<li>Write an interpreter that handles arithmetic expressions like â€œ7 - 3 + 2 - 1â€ from scratch. Use any programming language youâ€™re comfortable with and write it off the top of your head without looking at the examples. When you do that, think about components involved: a <em>lexer</em> that takes an input and converts it into a stream of tokens, a <em>parser</em> that feeds off the stream of the tokens provided by the <em>lexer</em> and tries to recognize a structure in that stream, and an <em>interpreter</em> that generates results after the <em>parser</em> has successfully parsed (recognized) a valid arithmetic expression. String those pieces together. Spend some time translating the knowledge youâ€™ve acquired into a working interpreter for arithmetic expressions.
<ul>
<li>ç¼–å†™ä¸€ä¸ªè§£é‡Šå™¨ï¼Œä»å¤´å¼€å§‹å¤„ç†ç®—æœ¯è¡¨è¾¾å¼ï¼Œå¦‚â€œ7 - 3 + 2 - 1â€ã€‚ä½¿ç”¨ä»»ä½•ä½ ç†Ÿæ‚‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸ç”¨çœ‹ä¾‹å­å°±ç›´æ¥å†™ä¸‹æ¥ã€‚å½“ä½ è¿™æ ·åšæ—¶ï¼Œè€ƒè™‘ä¸€ä¸‹ç›¸å…³çš„ç»„ä»¶ï¼šä¸€ä¸ªè·å–è¾“å…¥å¹¶å°†å…¶è½¬æ¢ä¸ºä¸€è¿ä¸²çš„tokençš„è¯æ³•åˆ†æå™¨ï¼Œä¸€ä¸ªä»è¯æ³•åˆ†æå™¨è·å–tokenæµï¼Œå¹¶å°è¯•è¯†åˆ«æµç»“æ„çš„è§£æå™¨ï¼Œå’Œä¸€ä¸ªåœ¨è§£æå™¨æˆåŠŸè§£æä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼åç”Ÿæˆç»“æœçš„è§£é‡Šå™¨ã€‚æŠŠè¿™äº›ç¢ç‰‡ä¸²åœ¨ä¸€èµ·ï¼ŒèŠ±äº›æ—¶é—´æŠŠä½ å­¦åˆ°çš„çŸ¥è¯†è½¬æ¢æˆä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼è§£é‡Šå™¨ã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘çš„ç­”æ¡ˆï¼š</p>
<pre><code class="language-python"># Token types
#
# EOF (end-of-file) token is used to indicate that
# there is no more input left for lexical analysis
INTEGER, PLUS, MINUS, MUL, DIV, EOF = 'INTEGER', 'PLUS', 'MINUS', 'MUL', 'DIV', 'EOF'


class Token(object):
    def __init__(self, type, value):
        # token type: INTEGER, PLUS, MINUS, or EOF
        self.type = type
        # token value: non-negative integer value, '+', '-', or None
        self.value = value

    def __str__(self):
        &quot;&quot;&quot;String representation of the class instance.

        Examples:
            Token(INTEGER, 3)
            Token(PLUS, '+')
        &quot;&quot;&quot;
        return 'Token({type}, {value})'.format(
            type=self.type,
            value=repr(self.value)
        )

    def __repr__(self):
        return self.__str__()


class Interpreter(object):
    def __init__(self, text):
        # client string input, e.g. &quot;3 + 5&quot;, &quot;12 - 5 + 3&quot;, etc
        self.text = text
        # self.pos is an index into self.text
        self.pos = 0
        # current token instance
        self.current_token = None
        self.current_char = self.text[self.pos]

    ##########################################################
    # Lexer code            è¯æ³•åˆ†æå™¨ä»£ç                      #
    ##########################################################
    def error(self):
        raise Exception('Invalid syntax')

    def advance(self):
        &quot;&quot;&quot;Advance the `pos` pointer and set the `current_char` variable.&quot;&quot;&quot;
        self.pos += 1
        if self.pos &gt; len(self.text) - 1:
            self.current_char = None  # Indicates end of input
        else:
            self.current_char = self.text[self.pos]

    def skip_whitespace(self):
        while self.current_char is not None and self.current_char.isspace():
            self.advance()

    def integer(self):
        &quot;&quot;&quot;Return a (multidigit) integer consumed from the input.&quot;&quot;&quot;
        result = ''
        while self.current_char is not None and self.current_char.isdigit():
            result += self.current_char
            self.advance()
        return int(result)

    def get_next_token(self):
        &quot;&quot;&quot;Lexical analyzer (also known as scanner or tokenizer)

        This method is responsible for breaking a sentence
        apart into tokens. One token at a time.
        &quot;&quot;&quot;
        while self.current_char is not None:

            if self.current_char.isspace():
                self.skip_whitespace()
                continue

            if self.current_char.isdigit():
                return Token(INTEGER, self.integer())

            if self.current_char == '+':
                self.advance()
                return Token(PLUS, '+')

            if self.current_char == '-':
                self.advance()
                return Token(MINUS, '-')

            if self.current_char == '*':
                self.advance()
                return Token(MUL, '*')

            if self.current_char == '/':
                self.advance()
                return Token(DIV, '/')

            self.error()

        return Token(EOF, None)

    ##########################################################
    # Parser / Interpreter code         è§£æå™¨/è§£é‡Šå™¨ä»£ç       #
    ##########################################################
    def eat(self, token_type):
        # compare the current token type with the passed token æ¯”è¾ƒå½“å‰tokençš„typeå’Œä¼ å…¥çš„tokençš„typeæ˜¯å¦ä¸€æ ·
        # type and if they match then &quot;eat&quot; the current token
        # and assign the next token to the self.current_token, å¦‚æœä¸€æ ·ï¼Œåˆ™å°†self.get_next_tokenè¿”å›çš„å€¼èµ‹å€¼ç»™self.current_token
        # otherwise raise an exception.
        if self.current_token.type == token_type:
            self.current_token = self.get_next_token()
        else:
            self.error()

    def term(self):
        &quot;&quot;&quot;Return an INTEGER token value.
        è¿”å›ä¸€ä¸ª INTERGER tokençš„å€¼
        &quot;&quot;&quot; 
        token = self.current_token
        self.eat(INTEGER)
        return token.value

    def expr(self):
        &quot;&quot;&quot;Arithmetic expression parser / interpreter.
        ç®—æœ¯è¡¨è¾¾å¼è§£æå™¨/è§£é‡Šå™¨
        &quot;&quot;&quot;
        # set current token to the first token taken from the input
        self.current_token = self.get_next_token() # ä»è¾“å…¥è·å–ç¬¬ä¸€ä¸ªtoken

        result = self.term() # å¾—åˆ°ç¬¬ä¸€ä¸ªtokençš„å€¼ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªtokenç»™self.current_token
        while self.current_token.type in (PLUS, MINUS, MUL, DIV): # é€šè¿‡åˆ¤æ–­å½“å‰tokençš„å€¼æ˜¯å¦æ˜¯åŠ æ³•æˆ–å‡æ³•
            token = self.current_token # æ“ä½œç¬¦
            if token.type == PLUS:    # æ ¹æ®æ“ä½œç¬¦çš„ç±»å‹ï¼Œåšç›¸åº”çš„æ“ä½œ
                self.eat(PLUS) # åƒæ‰+æ“ä½œç¬¦ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªtokenç»™self.current_token
                result = result + self.term() # self.term()è¿”å›â€œç¬¬äºŒä¸ªâ€æ“ä½œæ•°çš„å€¼ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªtokenèµ‹å€¼ç»™self.current_tokenï¼Œç”¨äºå¾ªç¯çš„è¿›è¡Œï¼Œè¿™æ˜¯å¾ªç¯çš„å…³é”®ï¼ï¼ï¼
            elif token.type == MINUS:
                self.eat(MINUS)
                result = result - self.term()
            elif token.type == MUL:
                self.eat(MUL)
                result = result * self.term()
            elif token.type == DIV:
                self.eat(DIV)
                right = self.term()
                if right == 0:
                    self.error()
                else:
                    result = result / right

        return result


def main():
    while True:
        try:
            text = input('calc&gt; ')
        except EOFError:
            break
        if not text:
            continue
        interpreter = Interpreter(text)
        result = interpreter.expr()
        print(result)


if __name__ == '__main__':
    main()

</code></pre>
<p><strong>Check yourÂ understanding.</strong></p>
<p>æ£€æŸ¥ä½ çš„ç†è§£ã€‚</p>
<ol>
<li>What is a syntaxÂ diagram? ä»€ä¹ˆæ˜¯è¯­æ³•å›¾ï¼Ÿ</li>
</ol>
<blockquote>
<p>ç¼–ç¨‹è¯­è¨€è¯­æ³•è§„åˆ™çš„å›¾å½¢åŒ–è¡¨ç¤ºã€‚è¯­æ³•å›¾å¯è§†åŒ–åœ°æ˜¾ç¤ºç¼–ç¨‹è¯­è¨€ä¸­å“ªäº›è¯­å¥æ˜¯å…è®¸çš„ï¼Œå“ªäº›æ˜¯ä¸å…è®¸çš„</p>
</blockquote>
<ol start="2">
<li>What is syntaxÂ analysis? ä»€ä¹ˆæ˜¯è¯­æ³•åˆ†æï¼Ÿ</li>
</ol>
<blockquote>
<p>å³è§£æã€‚ä»tokenæµä¸­è¯†åˆ«ç»“æ„ï¼Œå¾—åˆ°phraseçš„è¿‡ç¨‹</p>
</blockquote>
<ol start="3">
<li>What is a syntaxÂ analyzer? ä»€ä¹ˆæ˜¯è¯­æ³•åˆ†æå™¨ï¼Ÿ</li>
</ol>
<blockquote>
<p>å³è§£æå™¨ã€‚è§£é‡Šå™¨/ç¼–è¯‘å™¨æ‰§è¡Œè§£æçš„é‚£éƒ¨åˆ†ã€‚</p>
</blockquote>
<p>Hey, look! You read all the way to the end. Thanks for hanging out here today and donâ€™t forget to do the exercises. ğŸ˜ƒ Iâ€™ll be back next time with a new article - stayÂ tuned.</p>
<p>å˜¿ï¼Œçœ‹ï¼ä½ ä»å¤´è¯»åˆ°å°¾ã€‚è°¢è°¢ä½ ä»Šå¤©æ¥è¿™é‡Œï¼Œåˆ«å¿˜äº†åšç»ƒä¹ ã€‚(æ”¶é›†æ•´ç†ä¸‹æ¬¡æˆ‘ä¼šå¸¦æ¥ä¸€ç¯‡æ–°æ–‡ç« ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
<p>Here is a list of books I recommend that will help you in your study of interpreters andÂ compilers:</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘æ¨èçš„ä¸€äº›ä¹¦ç±ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©ä½ å­¦ä¹ è§£é‡Šå™¨å’Œç¼–è¯‘å™¨:</p>
<ol>
<li><a href="http://www.amazon.com/gp/product/193435645X/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=193435645X&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=MP4DCXDV6DJMEJBL">Language Implementation Patterns: Create Your Own Domain-Specific and General Programming Languages (Pragmatic Programmers)</a><br>
è¯­è¨€å®ç°æ¨¡å¼: åˆ›å»ºæ‚¨è‡ªå·±çš„ç‰¹å®šé¢†åŸŸå’Œé€šç”¨ç¼–ç¨‹è¯­è¨€(å®ç”¨ç¨‹åºå‘˜)</li>
<li><a href="http://www.amazon.com/gp/product/0470177071/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0470177071&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=UCLGQTPIYSWYKRRM">Writing Compilers and Interpreters: A Software Engineering Approach</a><br>
ç¼–å†™ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨: ä¸€ç§è½¯ä»¶å·¥ç¨‹æ–¹æ³•</li>
<li><a href="http://www.amazon.com/gp/product/052182060X/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=052182060X&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=ZSKKZMV7YWR22NMW">Modern Compiler Implementation in Java</a><br>
ç°ä»£ç¼–è¯‘å™¨åœ¨ Java ä¸­çš„å®ç°</li>
<li><a href="http://www.amazon.com/gp/product/1461446988/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1461446988&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=PAXWJP5WCPZ7RKRD">Modern Compiler Design</a><br>
ç°ä»£ç¼–è¯‘å™¨è®¾è®¡</li>
<li><a href="http://www.amazon.com/gp/product/0321486811/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0321486811&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=GOEGDQG4HIHU56FQ">Compilers: Principles, Techniques, and Tools (2nd Edition)</a><br>
ç¼–è¯‘å™¨: åŸç†ã€æŠ€æœ¯å’Œå·¥å…·(ç¬¬äºŒç‰ˆ)</li>
</ol>
<p><strong>All articles in this series:</strong></p>
<p>æœ¬ç³»åˆ—çš„æ‰€æœ‰æ–‡ç« :</p>
<ul>
<li><a href="https://ruslanspivak.com/lsbasi-part1/">Let's Build A Simple Interpreter. Part 1. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part2/">Let's Build A Simple Interpreter. Part 2. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part3/">Let's Build A Simple Interpreter. Part 3. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part4/">Let's Build A Simple Interpreter. Part 4. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part5/">Let's Build A Simple Interpreter. Part 5. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part6/">Let's Build A Simple Interpreter. Part 6. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part7/">Let's Build A Simple Interpreter. Part 7: Abstract Syntax Trees è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬7éƒ¨åˆ†: æŠ½è±¡è¯­æ³•æ ‘</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part8/">Let's Build A Simple Interpreter. Part 8. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part9/">Let's Build A Simple Interpreter. Part 9. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part10/">Let's Build A Simple Interpreter. Part 10. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part11/">Let's Build A Simple Interpreter. Part 11. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part12/">Let's Build A Simple Interpreter. Part 12.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part13/">Let's Build A Simple Interpreter. Part 13: Semantic Analysis</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part14/">Let's Build A Simple Interpreter. Part 14: Nested Scopes and a Source-to-Source Compiler</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part15/">Let's Build A Simple Interpreter. Part 15.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part16/">Let's Build A Simple Interpreter. Part 16: Recognizing Procedure Calls</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part17/">Let's Build A Simple Interpreter. Part 17: Call Stack and Activation Records</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part18/">Let's Build A Simple Interpreter. Part 18: Executing Procedure Calls</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part19/">Let's Build A Simple Interpreter. Part 19: Nested Procedure Calls</a></li>
</ul>

                        </div>
                        
                            <div class="post-toc">
                                
                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>ztree</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/">https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR ç " target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/&sharesource=qzone&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part3.&pics=https://lzxzl.github.io/images/avatar.png?v=1747748455692&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="æ–°æµªå¾®åš" target="_blank" href="https://service.weibo.com/share/share.php?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/&sharesource=weibo&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part3. + " - " + &pic="https://lzxzl.github.io/images/avatar.png?v=1747748455692 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">#
                    ç¼–è¯‘åŸç†
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/">
                                                                                            [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part4.
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part2/">
                                                                                                    [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part2.
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '2a44a295dd16ae7d05b8',
        clientSecret: '8030257bc11446a193cf383767567daca0e26312',
        repo: 'lzxzl.github.io',
        owner: 'lzxzl',
        admin: ['lzxzl'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        ztree
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        ztree &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://lzxzl.github.io/" target="_blank">
                                                ztree
                                            </a>
            </div>
            <div id="update" style="display:none;">
                off
            </div>
            
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
                <script>
                    
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    var newDate = new Date();
                    newDate.setTime(1747748455692);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>