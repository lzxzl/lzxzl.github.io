<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ztree
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="ztree">
<meta name="description" content="ç«¹æ–èŠ’é‹è½»èƒœé©¬ï¼Œè°æ€•ï¼Ÿä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿã€‚">
<meta name="keywords" content="Binary">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://lzxzl.github.io/styles/main.css" />
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                        <!--CDNæ ·å¼-->
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://lzxzl.github.io">
                    ztree
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        é¦–é¡µ
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        å½’æ¡£
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        æ ‡ç­¾
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        å…³äº
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://lzxzl.github.io">
                            ztree
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            é¦–é¡µ
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            å½’æ¡£
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            æ ‡ç­¾
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            å…³äº
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part 10.
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            ztree
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2021-12-06</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">23.0
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">4642</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">ç¼–è¯‘åŸç†</a>
                                
                            </span>
                                            
                                                é˜…è¯»é‡:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <p>Today we will continue closing the gap between where we are right now and where we want to be: <a href="https://ruslanspivak.com/lsbasi-part1/">a fully functional interpreter for a subset of Pascal programming language</a>.</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ç»§ç»­ç¼©å°æˆ‘ä»¬ç°åœ¨æ‰€å¤„çš„ä½ç½®å’Œæˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ä½ç½®ä¹‹é—´çš„å·®è·: ä¸€ä¸ªç”¨äº Pascal ç¼–ç¨‹è¯­è¨€å­é›†çš„å…¨åŠŸèƒ½è§£é‡Šå™¨ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://ruslanspivak.com/lsbasi-part10/lsbasi_part10_intro.png" alt="" loading="lazy"></figure>
<p>In this article we will update our interpreter to parse and interpret our very first complete Pascal program. The program can also be compiled by the <a href="http://www.freepascal.org/">Free Pascal compiler, <em>fpc</em></a>.</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ–°æˆ‘ä»¬çš„è§£é‡Šå™¨æ¥è§£æå’Œè§£é‡Šæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå®Œæ•´çš„ Pascal ç¨‹åºã€‚è¯¥ç¨‹åºä¹Ÿå¯ä»¥é€šè¿‡Free Pascal compiler, fpc ç¼–è¯‘ã€‚</p>
<p>Here is the programÂ itself:</p>
<p>ä¸‹é¢æ˜¯ç¨‹åº:</p>
<pre><code class="language-pascal">PROGRAM Part10;
VAR
   number     : INTEGER;
   a, b, c, x : INTEGER;
   y          : REAL;

BEGIN {Part10}
   BEGIN
      number := 2;
      a := number;
      b := 10 * a + 10 * number DIV 4;
      c := a - - b
   END;
   x := 11;
   y := 20 / 7 + 3.14;
   { writeln('a = ', a); }
   { writeln('b = ', b); }
   { writeln('c = ', c); }
   { writeln('number = ', number); }
   { writeln('x = ', x); }
   { writeln('y = ', y); }
END.  {Part10}
</code></pre>
<p>Before we start digging into the details, download the source code of the interpreter from <a href="https://github.com/rspivak/lsbasi/blob/master/part10/python/spi.py">GitHub</a> and the <a href="https://github.com/rspivak/lsbasi/blob/master/part10/python/part10.pas">Pascal source code above</a>, and try it on the commandÂ line:</p>
<p>åœ¨æˆ‘ä»¬å¼€å§‹æ·±å…¥ç ”ç©¶ç»†èŠ‚ä¹‹å‰ï¼Œå…ˆä» GitHub ä¸‹è½½è§£é‡Šå™¨çš„æºä»£ç å’Œä¸Šé¢çš„ Pascal æºä»£ç ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸Šè¯•ä¸€è¯•:</p>
<pre><code class="language-shell">$ python spi.py part10.pas
a = 2
b = 25
c = 27
number = 2
x = 11
y = 5.99714285714
</code></pre>
<p>If I remove the comments around the <em>writeln</em> statements in the <a href="https://github.com/rspivak/lsbasi/blob/master/part10/python/part10.pas">part10.pas</a> file, compile the source code with <a href="http://www.freepascal.org/"><em>fpc</em></a> and then run the produced executable, this is what I get on myÂ laptop:</p>
<p>å¦‚æœæˆ‘åˆ é™¤ part10.pas æ–‡ä»¶ä¸­ writeln è¯­å¥å‘¨å›´çš„æ³¨é‡Šï¼Œç”¨ fpc ç¼–è¯‘æºä»£ç ï¼Œç„¶åè¿è¡Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™å°±æ˜¯æˆ‘åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šå¾—åˆ°çš„ç»“æœ:</p>
<pre><code class="language-shell">$ fpc part10.pas
$ ./part10
a = 2
b = 25
c = 27
number = 2
x = 11
y =  5.99714285714286E+000
</code></pre>
<p>Okay, letâ€™s see what weâ€™re going coverÂ today:</p>
<p>å¥½çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»Šå¤©æˆ‘ä»¬è¦å­¦ä¹ ä»€ä¹ˆ:</p>
<ol>
<li>We will learn how to parse and interpret the Pascal <strong>_PROGRAM _</strong>Â header<br>
æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•è§£æå’Œè§£é‡Š Pascal PROGRAM header</li>
<li>We will learn how to parse Pascal variableÂ declarations<br>
æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•è§£æ Pascal å˜é‡å£°æ˜</li>
<li>We will update our interpreter to use the <strong><em>DIV</em></strong> keyword for integer division and a forward slash / for floatÂ division<br>
æˆ‘ä»¬å°†æ›´æ–°æˆ‘ä»¬çš„è§£é‡Šå™¨ä»¥ä½¿ç”¨DIVå…³é”®å­—è¡¨ç¤ºæ•´æ•°é™¤æ³•ï¼Œæ–œæ /è¡¨ç¤ºæµ®ç‚¹é™¤æ³•</li>
<li>We will add support for PascalÂ comments<br>
æˆ‘ä»¬å°†å¢åŠ å¯¹ Pascal æ³¨é‡Šçš„æ”¯æŒ</li>
</ol>
<p>Letâ€™s dive in and look at the grammar changes first. Today we will add some new rules and update some of the existing rules. <img src="https://ruslanspivak.com/lsbasi-part10/lsbasi_part10_grammar1.png" alt="" loading="lazy"></p>
<p>è®©æˆ‘ä»¬å…ˆæ·±å…¥ç ”ç©¶ä¸€ä¸‹è¯­æ³•çš„å˜åŒ–ã€‚ä»Šå¤©æˆ‘ä»¬å°†æ·»åŠ ä¸€äº›æ–°çš„è§„åˆ™å¹¶æ›´æ–°ä¸€äº›ç°æœ‰çš„è§„åˆ™ã€‚</p>
<ol>
<li>The <em><strong>program</strong></em> definition grammar rule is updated to include the <em><strong>PROGRAM</strong></em> reserved keyword, the program name, and a block that ends with a dot. Here is an example of a complete PascalÂ program:<br>
_**program **_å®šä¹‰grammarè§„åˆ™è¢«æ›´æ–°ä¸ºåŒ…å« PROGRAM ä¿ç•™å…³é”®å­—ã€ç¨‹åºåç§°å’Œä»¥ç‚¹ç»“å°¾çš„å—ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Pascal ç¨‹åºçš„ä¾‹å­:</li>
</ol>
<pre><code class="language-pascal">PROGRAM Part10;
BEGIN
END.
</code></pre>
<ol start="2">
<li>The <em><strong>block</strong></em> rule combines a <em>declarations</em> rule and a <em>compound_statement</em> rule. Weâ€™ll also use the rule later in the series when we add procedure declarations. Here is an example of aÂ block:<br>
<strong><em>block</em></strong> è§„åˆ™ç»“åˆäº†ä¸€ä¸ª _declarations _è§„åˆ™å’Œä¸€ä¸ª _compound_statement _è§„åˆ™ã€‚åœ¨æœ¬ç³»åˆ—åé¢æ·»åŠ  procedure declarations æ—¶ï¼Œæˆ‘ä»¬è¿˜å°†ä½¿ç”¨è¯¥è§„åˆ™ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª block çš„ä¾‹å­:</li>
</ol>
<pre><code class="language-pascal">VAR
   number : INTEGER;

BEGIN
END
</code></pre>
<p>Here is anotherÂ example:<br>
ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­:</p>
<pre><code class="language-pascal">BEGIN
END
</code></pre>
<ol start="3">
<li>Pascal declarations have several parts and each part is optional. In this article, weâ€™ll cover the variable declaration part only. The <em><strong>declarations</strong></em> rule has either a variable declaration sub-rule or itâ€™sÂ empty.<br>
Pascal declarations æœ‰å‡ ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æ˜¯å¯é€‰çš„ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åªè®¨è®ºå˜é‡å£°æ˜éƒ¨åˆ†ã€‚å£°æ˜è§„åˆ™è¦ä¹ˆæœ‰ä¸€ä¸ªå˜é‡å£°æ˜å­è§„åˆ™ï¼Œè¦ä¹ˆä¸ºç©ºã€‚</li>
<li>Pascal is a statically typed language, which means that every variable needs a variable declaration that explicitly specifies its type. In Pascal, variables must be declared before they are used. This is achieved by declaring variables in the program variable declaration section using the <em><strong>VAR</strong></em> reserved keyword. You can define variables likeÂ this:<br>
Pascal æ˜¯ä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå˜é‡éƒ½éœ€è¦ä¸€ä¸ªå˜é‡å£°æ˜æ¥æ˜ç¡®æŒ‡å®šå®ƒçš„ç±»å‹ã€‚åœ¨ Pascal è¯­è¨€ä¸­ï¼Œå˜é‡åœ¨ä½¿ç”¨ä¹‹å‰å¿…é¡»è¢«å£°æ˜ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ VAR ä¿ç•™å…³é”®å­—åœ¨ç¨‹åºå˜é‡å£°æ˜éƒ¨åˆ†ä¸­å£°æ˜å˜é‡æ¥å®ç°çš„ã€‚ä½ å¯ä»¥è¿™æ ·å®šä¹‰å˜é‡:</li>
</ol>
<pre><code class="language-pascal">VAR
   number     : INTEGER;
   a, b, c, x : INTEGER;
   y          : REAL;
</code></pre>
<ol start="5">
<li>The <em><strong>type_spec</strong></em> rule is for handling <em>INTEGER</em> and <em>REAL</em> types and is used in variable declarations. In the exampleÂ below<br>
<strong>type_spec</strong> è§„åˆ™ç”¨äºå¤„ç† <strong><em>INTEGER</em></strong> å’Œ <strong><em>REAL</em></strong> ç±»å‹ï¼Œå¹¶ç”¨äºå˜é‡å£°æ˜</li>
</ol>
<pre><code class="language-pascal">VAR
   a : INTEGER;
   b : REAL;
</code></pre>
<p>the variable â€œaâ€ is declared with the type <em>INTEGER</em> and the variable â€œbâ€ is declared with the type <em>REAL</em> (float). In this article we wonâ€™t enforce type checking, but we will add type checking later in theÂ series.<br>
å˜é‡â€œ aâ€å£°æ˜ä¸º INTEGER ç±»å‹ï¼Œå˜é‡â€œ bâ€å£°æ˜ä¸º REAL (float)ç±»å‹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šå¼ºåˆ¶æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬ç³»åˆ—çš„åé¢éƒ¨åˆ†ä¸­æ·»åŠ ç±»å‹æ£€æŸ¥ã€‚</p>
<ol start="6">
<li>The <em><strong>term</strong></em> rule is updated to use the <em><strong>DIV</strong></em> keyword for integer division and a forward slash / for floatÂ division.<br>
_**term **_è§„åˆ™æ›´æ–°ä¸ºä½¿ç”¨ <em><strong>DIV</strong></em> å…³é”®å­—è¿›è¡Œæ•´æ•°é™¤æ³•ï¼Œä½¿ç”¨æ­£æ–œæ  / è¿›è¡Œæµ®ç‚¹é™¤æ³•ã€‚<br>
Before, dividing 20 by 7 using a forward slash would produce an INTEGERÂ 2:<br>
åœ¨æ­¤ä¹‹å‰ï¼Œ20ç”¨æ­£æ–œæ é™¤ä»¥7ä¼šå¾—åˆ°ä¸€ä¸ª INTEGER 2:<br>
Now, dividing 20 by 7 using a forward slash will produce a REAL (floating point number) 2.85714285714Â :<br>
ç°åœ¨ï¼Œç”¨æ­£æ–œæ é™¤ä»¥20å¾—åˆ°ä¸€ä¸ª REAL (æµ®ç‚¹æ•°)2.85714285714:<br>
From now on, to get an INTEGER instead of a REAL, you need to use the <em><strong>DIV</strong></em>Â keyword:<br>
ä»ç°åœ¨å¼€å§‹ï¼Œä¸ºäº†å¾—åˆ°ä¸€ä¸ª INTEGER è€Œä¸æ˜¯ REALï¼Œä½ éœ€è¦ä½¿ç”¨ DIV å…³é”®å­—:</li>
<li>The <em><strong>factor</strong></em> rule is updated to handle both integer and real (float) constants. I also removed the INTEGER sub-rule because the constants will be represented by <em><strong>INTEGER_CONST</strong></em> and <em><strong>REAL_CONST</strong></em> tokens and the <em><strong>INTEGER</strong></em> token will be used to represent the integer type. In the example below the lexer will generate an <em>INTEGER_CONST</em> token for 20 and 7 and a <em>REAL_CONST</em> token for 3.14Â :<br>
_**factor **_è§„åˆ™è¢«æ›´æ–°ä»¥å¤„ç†æ•´æ•°å’Œå®æ•°(æµ®ç‚¹æ•°)å¸¸é‡ã€‚æˆ‘è¿˜åˆ é™¤äº† INTEGER å­è§„åˆ™ï¼Œå› ä¸ºå¸¸é‡å°†ç”±  <em><strong>INTEGER_CONST</strong></em> å’Œ <em><strong>REAL_CONST</strong></em> tokenè¡¨ç¤ºï¼Œè€Œ INTEGER tokenå°†ç”¨äºè¡¨ç¤ºæ•´æ•°ç±»å‹ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œlexer å°†ä¸º20å’Œ7ç”Ÿæˆä¸€ä¸ª <em><strong>INTEGER_CONST</strong></em>  tokenï¼Œä¸º3.14ç”Ÿæˆä¸€ä¸ª <em><strong>REAL_CONST</strong></em> tokenï¼š</li>
</ol>
<p>Here is our complete grammar forÂ today:</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä»Šå¤©çš„å®Œæ•´è¯­æ³•:</p>
<pre><code>    program : PROGRAM variable SEMI block DOT

    block : declarations compound_statement

    declarations : VAR (variable_declaration SEMI)+
                 | empty

    variable_declaration : ID (COMMA ID)* COLON type_spec

    type_spec : INTEGER | REAL

    compound_statement : BEGIN statement_list END

    statement_list : statement
                   | statement SEMI statement_list

    statement : compound_statement
              | assignment_statement
              | empty

    assignment_statement : variable ASSIGN expr

    empty :

    expr : term ((PLUS | MINUS) term)*

    term : factor ((MUL | INTEGER_DIV | FLOAT_DIV) factor)*

    factor : PLUS factor
           | MINUS factor
           | INTEGER_CONST
           | REAL_CONST
           | LPAREN expr RPAREN
           | variable

    variable: ID
</code></pre>
<p>In the rest of the article weâ€™ll go through the same drill we went through lastÂ time:</p>
<p>åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é‡å¤ä¸Šæ¬¡çš„æ“ä½œ:</p>
<ol>
<li>Update theÂ lexer æ›´æ–° lexer</li>
<li>Update theÂ parser æ›´æ–°è§£æå™¨</li>
<li>Update theÂ interpreter æ›´æ–°è§£é‡Šå™¨</li>
</ol>
<p><strong>Updating theÂ Lexer</strong></p>
<p>Here is a summary of the lexerÂ changes:</p>
<p>ä¸‹é¢æ˜¯ lexer æ›´æ”¹çš„æ‘˜è¦:</p>
<ol>
<li>NewÂ tokens<br>
æ–°çš„tokens</li>
<li>New and updated reservedÂ keywords<br>
æ–°çš„å’Œæ›´æ–°çš„ä¿ç•™å…³é”®å­—</li>
<li>New _skip_comment _ method to handle PascalÂ comments<br>
æ–°çš„_skip_comment_æ–¹æ³•æ¥å¤„ç† Pascal æ³¨é‡Š</li>
<li>Rename the _integer _method and make some changes to the methodÂ itself<br>
é‡å‘½å _integer _æ–¹æ³•ï¼Œå¹¶å¯¹æ–¹æ³•æœ¬èº«è¿›è¡Œä¸€äº›æ›´æ”¹</li>
<li>Update the _get_next_token _ method to return newÂ tokens<br>
æ›´æ–°_get_next_token_æ–¹æ³•ä»¥è¿”å›æ–°çš„token</li>
</ol>
<p>Letâ€™s dig into the changes mentionedÂ above:</p>
<p>è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¸€ä¸‹ä¸Šé¢æåˆ°çš„å˜åŒ–:</p>
<ol>
<li>To handle a program header, variable declarations, integer and float constants as well as integer and float division, we need to add some new tokens - some of which are reserved keywords - and we also need to update the meaning of the INTEGER token to represent the integer type and not an integer constant. Here is a complete list of new and updatedÂ tokens:<br>
ä¸ºäº†å¤„ç†ç¨‹åºå¤´ã€å˜é‡å£°æ˜ã€æ•´æ•°å’Œæµ®ç‚¹æ•°å¸¸é‡ä»¥åŠæ•´æ•°å’Œæµ®ç‚¹æ•°é™¤æ³•ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›æ–°çš„token(å…¶ä¸­ä¸€äº›æ˜¯ä¿ç•™å…³é”®å­—) ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ›´æ–° INTEGER tokençš„å«ä¹‰ï¼Œä»¥è¡¨ç¤ºæ•´æ•°ç±»å‹ï¼Œè€Œä¸æ˜¯æ•´æ•°å¸¸é‡ã€‚ä¸‹é¢æ˜¯æ–°çš„å’Œæ›´æ–°çš„tokençš„å®Œæ•´åˆ—è¡¨:
<ul>
<li>PROGRAM (reserved keyword)</li>
<li>VAR (reserved keyword)</li>
<li>COLON (ğŸ˜ƒ</li>
<li>COMMA (,)</li>
<li>INTEGER (we change it to mean integer type and not integer constant like 3 or 5)</li>
<li>REAL (for Pascal REAL type)</li>
<li>INTEGER_CONST (for example, 3 or 5)</li>
<li>REAL_CONST (for example, 3.14 and so on)</li>
<li>INTEGER_DIV for integer division (the <em><strong>DIV</strong></em> reserved keyword)</li>
<li>FLOAT_DIV for float division ( forward slash / )</li>
</ul>
</li>
<li>Here is the complete mapping of reserved keywords toÂ tokens:<br>
ä¸‹é¢æ˜¯ä¿ç•™å…³é”®å­—åˆ°tokençš„å®Œæ•´æ˜ å°„:</li>
</ol>
<pre><code class="language-python">RESERVED_KEYWORDS = {
    'PROGRAM': Token('PROGRAM', 'PROGRAM'),
    'VAR': Token('VAR', 'VAR'),
    'DIV': Token('INTEGER_DIV', 'DIV'),
    'INTEGER': Token('INTEGER', 'INTEGER'),
    'REAL': Token('REAL', 'REAL'),
    'BEGIN': Token('BEGIN', 'BEGIN'),
    'END': Token('END', 'END'),
}
</code></pre>
<ol start="3">
<li>Weâ€™re adding the <em>skip_comment</em> method to handle Pascal comments. The method is pretty basic and all it does is discard all the characters until the closing curly brace isÂ found:<br>
æˆ‘ä»¬æ·»åŠ äº† <em>skip_comment</em> æ–¹æ³•æ¥å¤„ç† Pascal æ³¨é‡Šã€‚è¿™ä¸ªæ–¹æ³•éå¸¸ç®€å•ï¼Œå®ƒæ‰€åšçš„å°±æ˜¯ä¸¢å¼ƒæ‰€æœ‰çš„å­—ç¬¦ï¼Œç›´åˆ°æ‰¾åˆ°ç»“æŸèŠ±æ‹¬å·:</li>
</ol>
<pre><code class="language-python">def skip_comment(self):
    while self.current_char != '}':
        self.advance()
    self.advance()  # the closing curly brace
</code></pre>
<ol start="4">
<li>We are renaming the <em>integer</em> method the <em>number</em> method. It can handle both integer constants and float constants like 3 andÂ 3.14:<br>
æˆ‘ä»¬å°† _integer _æ–¹æ³•é‡å‘½åä¸º <em>number</em> æ–¹æ³•ã€‚å®ƒå¯ä»¥å¤„ç†æ•´å‹å¸¸é‡å’Œæµ®ç‚¹å‹å¸¸é‡ï¼Œæ¯”å¦‚3å’Œ3.14:</li>
</ol>
<pre><code class="language-python">def number(self):
    &quot;&quot;&quot;Return a (multidigit) integer or float consumed from the input.&quot;&quot;&quot;
    result = ''
    while self.current_char is not None and self.current_char.isdigit():
        result += self.current_char
        self.advance()

    if self.current_char == '.':
        result += self.current_char
        self.advance()

        while (
            self.current_char is not None and
            self.current_char.isdigit()
        ):
            result += self.current_char
            self.advance()

        token = Token('REAL_CONST', float(result))
    else:
        token = Token('INTEGER_CONST', int(result))

    return token
</code></pre>
<ol start="5">
<li>Weâ€™re also updating the <em>get_next_token</em> method to return newÂ tokens:<br>
æˆ‘ä»¬è¿˜æ›´æ–°äº†  <em>get_next_token</em> æ–¹æ³•æ¥è¿”å›æ–°çš„ä»¤ç‰Œ:</li>
</ol>
<pre><code class="language-python">def get_next_token(self):
    while self.current_char is not None:
        ...
        if self.current_char == '{':
            self.advance()
            self.skip_comment()
            continue
        ...
        if self.current_char.isdigit():
            return self.number()

        if self.current_char == ':':
            self.advance()
            return Token(COLON, ':')

        if self.current_char == ',':
            self.advance()
            return Token(COMMA, ',')
        ...
        if self.current_char == '/':
            self.advance()
            return Token(FLOAT_DIV, '/')
        ...
</code></pre>
<p><strong>Updating theÂ Parser</strong></p>
<p>æ›´æ–°è§£æå™¨</p>
<p>Now onto the parserÂ changes.</p>
<p>ç°åœ¨è½¬åˆ°è§£æå™¨æ›´æ”¹ä¸Šã€‚</p>
<p>Here is a summary of theÂ changes:</p>
<p>ä»¥ä¸‹æ˜¯è¿™äº›å˜åŒ–çš„æ‘˜è¦:<br>
â€‹</p>
<ol>
<li>New AST nodes: <em>Program</em>, <em>Block</em>, <em>VarDecl</em>, <em>Type</em><br>
æ–°çš„ASTèŠ‚ç‚¹ï¼š<em>Program</em>, <em>Block</em>, <em>VarDecl</em>, <em>Type</em></li>
<li>New methods corresponding to new grammar rules: <em>block</em>, <em>declarations</em>, <em>variable_declaration</em>, and <em>type_spec</em>.<br>
å¯¹åº”æ–°è§„åˆ™çš„æ–°æ–¹æ³•ï¼š<em>block</em>, <em>declarations</em>, <em>variable_declaration</em>, and _type_spec_â€‹</li>
<li>Updates to the existing parser methods: <em>program</em>, <em>term</em>, and <em>factor</em><br>
æ›´æ–°ç°æœ‰çš„æ–¹æ³•ï¼š<em>program</em>, <em>term</em>, and <em>factor</em></li>
</ol>
<p>Letâ€™s go over the changes one byÂ one:</p>
<p>è®©æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªæ¥çœ‹ä¸€ä¸‹è¿™äº›å˜åŒ–:</p>
<ol>
<li>Weâ€™ll start with new AST nodes first. There are four newÂ nodes:<br>
æˆ‘ä»¬é¦–å…ˆä»æ–°çš„ AST èŠ‚ç‚¹å¼€å§‹ï¼Œæœ‰å››ä¸ªæ–°èŠ‚ç‚¹:
<ul>
<li>The <em>Program</em> AST node represents a program and will be our rootÂ node<br>
Program AST èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç¨‹åºï¼Œå°†æ˜¯æˆ‘ä»¬çš„æ ¹èŠ‚ç‚¹</li>
</ul>
</li>
</ol>
<pre><code class="language-python">class Program(AST):
    def __init__(self, name, block):
        self.name = name
        self.block = block
</code></pre>
<ul>
<li>The <em>Block</em> AST node holds declarations and a compoundÂ statement:<br>
Block AST èŠ‚ç‚¹åŒ…å«å£°æ˜å’Œä¸€ä¸ªå¤åˆè¯­å¥:</li>
</ul>
<pre><code class="language-python">class Block(AST):
    def __init__(self, declarations, compound_statement):
        self.declarations = declarations
        self.compound_statement = compound_statement
</code></pre>
<ul>
<li>The <em>VarDecl</em> AST node represents a variable declaration. It holds a variable node and a typeÂ node:<br>
_VarDecl _AST èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªå˜é‡å£°æ˜ï¼Œå®ƒåŒ…å«ä¸€ä¸ªå˜é‡èŠ‚ç‚¹å’Œä¸€ä¸ªç±»å‹èŠ‚ç‚¹:</li>
</ul>
<pre><code class="language-python">class VarDecl(AST):
    def __init__(self, var_node, type_node):
        self.var_node = var_node
        self.type_node = type_node
</code></pre>
<ul>
<li>The <em>Type</em> AST node represents a variable type (INTEGER or REAL):<br>
Type AST èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªå˜é‡ç±»å‹(INTEGER æˆ– REAL) :</li>
</ul>
<pre><code class="language-python">class Type(AST):
    def __init__(self, token):
        self.token = token
        self.value = token.value
</code></pre>
<ol start="2">
<li>As you probably remember, each rule from the grammar has a corresponding method in our recursive-descent parser. Today weâ€™re adding four new methods: <em>block</em>, <em>declarations</em>, <em>variable_declaration</em>, and <em>type_spec</em>. These methods are responsible for parsing new language constructs and constructing new ASTÂ nodes:<br>
æ‚¨å¯èƒ½è¿˜è®°å¾—ï¼Œåœ¨æˆ‘ä»¬çš„é€’å½’ä¸‹é™åˆ†æå™¨ä¸­ï¼Œæ–‡æ³•ä¸­çš„æ¯ä¸ªè§„åˆ™éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ–¹æ³•ã€‚ä»Šå¤©æˆ‘ä»¬æ·»åŠ äº†å››ä¸ªæ–°æ–¹æ³•: blockã€ declarationã€ <em>variable_declaration</em> å’Œ <em>type_spec</em>ã€‚è¿™äº›æ–¹æ³•è´Ÿè´£è§£ææ–°çš„è¯­è¨€ç»“æ„å¹¶æ„é€ æ–°çš„ AST èŠ‚ç‚¹:</li>
</ol>
<pre><code class="language-python">def block(self):
    &quot;&quot;&quot;block : declarations compound_statement&quot;&quot;&quot;
    declaration_nodes = self.declarations()
    compound_statement_node = self.compound_statement()
    node = Block(declaration_nodes, compound_statement_node)
    return node

def declarations(self):
    &quot;&quot;&quot;declarations : VAR (variable_declaration SEMI)+
                    | empty
    &quot;&quot;&quot;
    declarations = []
    if self.current_token.type == VAR:
        self.eat(VAR)
        while self.current_token.type == ID:
            var_decl = self.variable_declaration()
            declarations.extend(var_decl)
            self.eat(SEMI)

    return declarations

def variable_declaration(self):
    &quot;&quot;&quot;variable_declaration : ID (COMMA ID)* COLON type_spec&quot;&quot;&quot;
    var_nodes = [Var(self.current_token)]  # first ID
    self.eat(ID)

    while self.current_token.type == COMMA:
        self.eat(COMMA)
        var_nodes.append(Var(self.current_token))
        self.eat(ID)

    self.eat(COLON)

    type_node = self.type_spec()
    var_declarations = [
        VarDecl(var_node, type_node)
        for var_node in var_nodes
    ]
    return var_declarations

def type_spec(self):
    &quot;&quot;&quot;type_spec : INTEGER
                 | REAL
    &quot;&quot;&quot;
    token = self.current_token
    if self.current_token.type == INTEGER:
        self.eat(INTEGER)
    else:
        self.eat(REAL)
    node = Type(token)
    return node
</code></pre>
<ol start="3">
<li>We also need to update the <em>program</em>, <em>term</em>, and, <em>factor</em> methods to accommodate our grammarÂ changes:<br>
æˆ‘ä»¬è¿˜éœ€è¦æ›´æ–°_program_ã€_term _å’Œ factor æ–¹æ³•ï¼Œä»¥é€‚åº”æˆ‘ä»¬çš„è¯­æ³•å˜åŒ–:</li>
</ol>
<pre><code class="language-python">def program(self):
    &quot;&quot;&quot;program : PROGRAM variable SEMI block DOT&quot;&quot;&quot;
    self.eat(PROGRAM)
    var_node = self.variable()
    prog_name = var_node.value
    self.eat(SEMI)
    block_node = self.block()
    program_node = Program(prog_name, block_node)
    self.eat(DOT)
    return program_node

def term(self):
    &quot;&quot;&quot;term : factor ((MUL | INTEGER_DIV | FLOAT_DIV) factor)*&quot;&quot;&quot;
    node = self.factor()

    while self.current_token.type in (MUL, INTEGER_DIV, FLOAT_DIV):
        token = self.current_token
        if token.type == MUL:
            self.eat(MUL)
        elif token.type == INTEGER_DIV:
            self.eat(INTEGER_DIV)
        elif token.type == FLOAT_DIV:
            self.eat(FLOAT_DIV)

        node = BinOp(left=node, op=token, right=self.factor())

    return node

def factor(self):
    &quot;&quot;&quot;factor : PLUS factor
              | MINUS factor
              | INTEGER_CONST
              | REAL_CONST
              | LPAREN expr RPAREN
              | variable
    &quot;&quot;&quot;
    token = self.current_token
    if token.type == PLUS:
        self.eat(PLUS)
        node = UnaryOp(token, self.factor())
        return node
    elif token.type == MINUS:
        self.eat(MINUS)
        node = UnaryOp(token, self.factor())
        return node
    elif token.type == INTEGER_CONST:
        self.eat(INTEGER_CONST)
        return Num(token)
    elif token.type == REAL_CONST:
        self.eat(REAL_CONST)
        return Num(token)
    elif token.type == LPAREN:
        self.eat(LPAREN)
        node = self.expr()
        self.eat(RPAREN)
        return node
    else:
        node = self.variable()
        return node
</code></pre>
<p>Now, letâ€™s see what the <em><strong>Abstract Syntax Tree</strong></em> looks like with the new nodes. Here is a small working PascalÂ program:</p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä½¿ç”¨è¿™äº›æ–°èŠ‚ç‚¹åçš„æŠ½è±¡è¯­æ³•æ ‘æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°å‹çš„ Pascal ç¨‹åº:</p>
<pre><code class="language-pascal">PROGRAM Part10AST;
VAR
   a, b : INTEGER;
   y    : REAL;

BEGIN {Part10AST}
   a := 2;
   b := 10 * a + 10 * a DIV 4;
   y := 20 / 7 + 3.14;
END.  {Part10AST}
</code></pre>
<p>Letâ€™s generate an AST and visualize it with the <a href="https://github.com/rspivak/lsbasi/blob/master/part10/python/genastdot.py">genastdot.py</a>:</p>
<p>è®©æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ª ASTï¼Œå¹¶ç”¨ genastdot.py å°†å…¶å¯è§†åŒ–:</p>
<p>$ python genastdot.py part10ast.pas &gt; ast.dot &amp;&amp; dot -Tpng -o ast.png ast.dot</p>
<figure data-type="image" tabindex="2"><img src="https://ruslanspivak.com/lsbasi-part10/lsbasi_part10_ast.png" alt="" loading="lazy"></figure>
<p>In the picture you can see the new nodes that we haveÂ added.</p>
<p>åœ¨å›¾ä¸­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ·»åŠ çš„æ–°èŠ‚ç‚¹ã€‚</p>
<p><strong>Updating theÂ Interpreter</strong></p>
<p>æ›´æ–°è§£é‡Šå™¨</p>
<p>Weâ€™re done with the lexer and parser changes. Whatâ€™s left is to add new visitor methods to our <em>Interpreter</em> class. There will be four new methods to visit our newÂ nodes:</p>
<p>æˆ‘ä»¬å·²ç»å®Œæˆäº† lexer å’Œè§£æå™¨çš„æ›´æ”¹ã€‚å‰©ä¸‹çš„å·¥ä½œæ˜¯å‘æˆ‘ä»¬çš„ Interpreter ç±»æ·»åŠ æ–°çš„ visitor æ–¹æ³•ã€‚å°†æœ‰å››ç§æ–°æ–¹æ³•è®¿é—®æˆ‘ä»¬çš„æ–°èŠ‚ç‚¹:</p>
<ul>
<li><em>visit_Program</em></li>
<li><em>visit_Block</em></li>
<li><em>visit_VarDecl</em></li>
<li><em>visit_Type</em></li>
</ul>
<p>They are pretty straightforward. You can also see that the <em>Interpreter</em> does nothing with <em>VarDecl</em> and <em>Type</em>Â nodes:</p>
<p>ä½ ä¹Ÿå¯ä»¥çœ‹åˆ° Interpreter å¯¹ VarDecl å’Œ Type èŠ‚ç‚¹ä»€ä¹ˆä¹Ÿä¸åš:</p>
<pre><code class="language-python">def visit_Program(self, node):
    self.visit(node.block)

def visit_Block(self, node):
    for declaration in node.declarations:
        self.visit(declaration)
    self.visit(node.compound_statement)

def visit_VarDecl(self, node):
    # Do nothing
    pass

def visit_Type(self, node):
    # Do nothing
    pass
</code></pre>
<p>We also need to update the <em>visit_BinOp</em> method to properly interpret integer and floatÂ divisions:</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦æ›´æ–° <em>visit_BinOp</em> æ–¹æ³•æ¥æ­£ç¡®è§£é‡Šæ•´æ•°å’Œæµ®ç‚¹æ•°éƒ¨åˆ†:</p>
<pre><code class="language-python">def visit_BinOp(self, node):
    if node.op.type == PLUS:
        return self.visit(node.left) + self.visit(node.right)
    elif node.op.type == MINUS:
        return self.visit(node.left) - self.visit(node.right)
    elif node.op.type == MUL:
        return self.visit(node.left) * self.visit(node.right)
    elif node.op.type == INTEGER_DIV:
        return self.visit(node.left) // self.visit(node.right)
    elif node.op.type == FLOAT_DIV:
        return float(self.visit(node.left)) / float(self.visit(node.right))
</code></pre>
<p>Letâ€™s sum up what we had to do to extend the Pascal interpreter in thisÂ article:</p>
<p>è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­ä¸ºæ‰©å±• Pascal è§£é‡Šå™¨æ‰€åšçš„å·¥ä½œ:</p>
<ul>
<li>Add new rules to the grammar and update some existingÂ rules
<ul>
<li>å‘è¯­æ³•ä¸­æ·»åŠ æ–°è§„åˆ™å¹¶æ›´æ–°ä¸€äº›ç°æœ‰è§„åˆ™</li>
</ul>
</li>
<li>Add new tokens and supporting methods to the lexer, update and modify some existingÂ methods
<ul>
<li>å‘ lexer æ·»åŠ æ–°çš„tokenå’Œæ”¯æŒæ–¹æ³•ï¼Œæ›´æ–°å’Œä¿®æ”¹ä¸€äº›ç°æœ‰çš„æ–¹æ³•</li>
</ul>
</li>
<li>Add new AST  nodes to the parser for new languageÂ constructs
<ul>
<li>æ·»åŠ æ–°çš„ASTèŠ‚ç‚¹åˆ°è§£æå™¨ä»¥è§£ææ–°è¯­è¨€ç»“æ„</li>
</ul>
</li>
<li>Add new methods corresponding to the new grammar rules to our recursive-descent parser and update some existingÂ methods
<ul>
<li>åœ¨æˆ‘ä»¬çš„é€’å½’ä¸‹é™åˆ†æå™¨ä¸­æ·»åŠ ä¸æ–°æ–‡æ³•è§„åˆ™ç›¸å¯¹åº”çš„æ–°æ–¹æ³•ï¼Œå¹¶æ›´æ–°ä¸€äº›ç°æœ‰çš„æ–¹æ³•</li>
</ul>
</li>
<li>Add new visitor methods to the interpreter and update one existing visitorÂ method
<ul>
<li>å‘è§£é‡Šå™¨æ·»åŠ æ–°çš„visitoræ–¹æ³•å¹¶æ›´æ–°ä¸€ä¸ªç°æœ‰çš„visitoræ–¹æ³•</li>
</ul>
</li>
</ul>
<p>As a result of our changes we also got rid of some of the hacks I introduced in <a href="https://ruslanspivak.com/lsbasi-part9/">Part 9</a>,Â namely:</p>
<p>ä½œä¸ºä¿®æ”¹çš„ç»“æœï¼Œæˆ‘ä»¬è¿˜åˆ é™¤äº†æˆ‘åœ¨ç¬¬9éƒ¨åˆ†ä»‹ç»çš„ä¸€äº›hacksï¼Œå³:</p>
<ul>
<li>Our interpreter can now handle the <em>**PROGRAM **</em>Â header
<ul>
<li>è§£é‡Šå™¨ç°åœ¨å¯ä»¥å¤„ç†_**PROGRAM **_Â header</li>
</ul>
</li>
<li>Variables can now be declared using the <em><strong>VAR</strong></em>Â keyword
<ul>
<li>å˜é‡ç°åœ¨å¯ä»¥ä½¿ç”¨VARå…³é”®å­—å£°æ˜äº†</li>
</ul>
</li>
<li>The <em><strong>DIV</strong></em> keyword is used for integer division and a forward slash / is used for floatÂ division
<ul>
<li>DIV å…³é”®å­—ç”¨äºæ•´æ•°é™¤æ³•ï¼Œæ­£æ–œæ /ç”¨äºæµ®ç‚¹é™¤æ³•</li>
</ul>
</li>
</ul>
<p>If you havenâ€™t done so yet, then, as an exercise, re-implement the interpreter in this article without looking at the source code and use <a href="https://github.com/rspivak/lsbasi/blob/master/part10/python/part10.pas">part10.pas</a> as your test inputÂ file.</p>
<p>å¦‚æœæ‚¨è¿˜æ²¡æœ‰è¿™æ ·åšï¼Œé‚£ä¹ˆï¼Œä½œä¸ºç»ƒä¹ ï¼Œåœ¨æœ¬æ–‡ä¸­é‡æ–°å®ç°è§£é‡Šå™¨ï¼Œä¸è¦æŸ¥çœ‹æºä»£ç ï¼Œå¹¶ä½¿ç”¨ part10.pas ä½œä¸ºæ‚¨çš„æµ‹è¯•è¾“å…¥æ–‡ä»¶ã€‚</p>
<p>Thatâ€™s all for today. In the next article, Iâ€™ll talk in greater detail about symbol table management. Stay tuned and see youÂ soon!</p>
<p>ä»Šå¤©å°±åˆ°è¿™é‡Œå§ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æ›´è¯¦ç»†åœ°è®¨è®ºç¬¦å·è¡¨ç®¡ç†ã€‚è¯·ç»§ç»­å…³æ³¨ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šå†è§ï¼</p>
<p><strong>All articles in this series:</strong></p>
<p>æœ¬ç³»åˆ—çš„æ‰€æœ‰æ–‡ç« :</p>
<ul>
<li><a href="https://ruslanspivak.com/lsbasi-part1/">Let's Build A Simple Interpreter. Part 1. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part2/">Let's Build A Simple Interpreter. Part 2. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part3/">Let's Build A Simple Interpreter. Part 3. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part4/">Let's Build A Simple Interpreter. Part 4. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part5/">Let's Build A Simple Interpreter. Part 5. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part6/">Let's Build A Simple Interpreter. Part 6. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part7/">Let's Build A Simple Interpreter. Part 7: Abstract Syntax Trees è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬7éƒ¨åˆ†: æŠ½è±¡è¯­æ³•æ ‘</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part8/">Let's Build A Simple Interpreter. Part 8. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part9/">Let's Build A Simple Interpreter. Part 9. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part10/">Let's Build A Simple Interpreter. Part 10. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part11/">Let's Build A Simple Interpreter. Part 11. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part12/">Let's Build A Simple Interpreter. Part 12. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part13/">Let's Build A Simple Interpreter. Part 13: Semantic Analysis è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬13éƒ¨åˆ†: è¯­ä¹‰åˆ†æ</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part14/">Let's Build A Simple Interpreter. Part 14: Nested Scopes and a Source-to-Source Compiler è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬14éƒ¨åˆ†: åµŒå¥—ä½œç”¨åŸŸå’Œæºåˆ°æºç¼–è¯‘å™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part15/">Let's Build A Simple Interpreter. Part 15. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬15éƒ¨åˆ†</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part16/">Let's Build A Simple Interpreter. Part 16: Recognizing Procedure Calls è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬16éƒ¨åˆ†: è¯†åˆ«è¿‡ç¨‹è°ƒç”¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part17/">Let's Build A Simple Interpreter. Part 17: Call Stack and Activation Records è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬17éƒ¨åˆ†: è°ƒç”¨å †æ ˆå’Œæ¿€æ´»è®°å½•</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part18/">Let's Build A Simple Interpreter. Part 18: Executing Procedure Calls è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬18éƒ¨åˆ†: æ‰§è¡Œè¿‡ç¨‹è°ƒç”¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part19/">Let's Build A Simple Interpreter. Part 19: Nested Procedure Calls è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬19éƒ¨åˆ†: åµŒå¥—è¿‡ç¨‹è°ƒç”¨</a></li>
</ul>

                        </div>
                        
                            <div class="post-toc">
                                
                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>ztree</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10/">https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR ç " target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10/&sharesource=qzone&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part 10.&pics=https://lzxzl.github.io/images/avatar.png?v=1747748455692&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="æ–°æµªå¾®åš" target="_blank" href="https://service.weibo.com/share/share.php?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10/&sharesource=weibo&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part 10. + " - " + &pic="https://lzxzl.github.io/images/avatar.png?v=1747748455692 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">#
                    ç¼–è¯‘åŸç†
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-11/">
                                                                                            [ç¿»è¯‘ä¸å­¦ä¹ ] Let&#39;s Build A Simple Interpreter. Part 11.
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-9/">
                                                                                                    [ç¿»è¯‘ä¸å­¦ä¹ ] Let&#39;s Build A Simple Interpreter. Part 9
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '2a44a295dd16ae7d05b8',
        clientSecret: '8030257bc11446a193cf383767567daca0e26312',
        repo: 'lzxzl.github.io',
        owner: 'lzxzl',
        admin: ['lzxzl'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        ztree
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        ztree &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://lzxzl.github.io/" target="_blank">
                                                ztree
                                            </a>
            </div>
            <div id="update" style="display:none;">
                off
            </div>
            
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
                <script>
                    
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    var newDate = new Date();
                    newDate.setTime(1747748455692);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>