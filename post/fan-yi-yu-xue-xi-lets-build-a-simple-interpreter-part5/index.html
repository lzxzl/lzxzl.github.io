<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ztree
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="ztree">
<meta name="description" content="ç«¹æ–èŠ’é‹è½»èƒœé©¬ï¼Œè°æ€•ï¼Ÿä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿã€‚">
<meta name="keywords" content="Binary">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://lzxzl.github.io/styles/main.css" />
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                        <!--CDNæ ·å¼-->
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://lzxzl.github.io">
                    ztree
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        é¦–é¡µ
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        å½’æ¡£
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        æ ‡ç­¾
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        å…³äº
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://lzxzl.github.io">
                            ztree
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            é¦–é¡µ
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            å½’æ¡£
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            æ ‡ç­¾
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            å…³äº
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part5.
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            ztree
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2021-11-11</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">24.4
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">4986</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">ç¼–è¯‘åŸç†</a>
                                
                            </span>
                                            
                                                é˜…è¯»é‡:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <p>How do you tackle something as complex as understanding how to create an interpreter or compiler? In the beginning it all looks pretty much like a tangled mess of yarn that you need to untangle to get that perfectÂ ball.</p>
<p>å¦‚ä½•å¤„ç†åƒç†è§£å¦‚ä½•åˆ›å»ºè§£é‡Šå™¨æˆ–ç¼–è¯‘å™¨è¿™æ ·å¤æ‚çš„äº‹æƒ…ï¼Ÿä¸€å¼€å§‹ï¼Œå®ƒçœ‹èµ·æ¥å°±åƒä¸€å›¢çº ç»“çš„çº±çº¿ï¼Œä½ éœ€è¦è§£å¼€å®ƒæ‰èƒ½å¾—åˆ°é‚£ä¸ªå®Œç¾çš„çƒã€‚</p>
<p>The way to get there is to just untangle it one thread, one knot at a time. Sometimes, though, you might feel like you donâ€™t understand something right away, but you have to keep going. It will eventually â€œclickâ€ if youâ€™re persistent enough, I promise you (Gee, if I put aside 25 cents every time I didnâ€™t understand something right away I would have become rich a long time agoÂ ğŸ˜ƒ.</p>
<p>åˆ°è¾¾é‚£é‡Œçš„æ–¹æ³•åªæ˜¯è§£å¼€å®ƒçš„ä¸€æ ¹çº¿ï¼Œä¸€æ¬¡ä¸€ä¸ªç»“ã€‚ä½†æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è‡ªå·±ä¸èƒ½é©¬ä¸Šç†è§£æŸäº›äº‹æƒ…ï¼Œä½†æ˜¯ä½ å¿…é¡»ç»§ç»­å‰è¿›ã€‚å¦‚æœä½ è¶³å¤ŸåšæŒï¼Œå®ƒæœ€ç»ˆä¼šè±ç„¶å¼€æœ—ï¼ˆclickæœ‰è±ç„¶å¼€æœ—ï¼Œçªç„¶æ˜ç™½çš„æ„æ€ï½ï¼‰ï¼Œæˆ‘å‘ä½ ä¿è¯(å“å‘€ï¼Œå¦‚æœæˆ‘æ¯æ¬¡ä¸æ˜ç™½ä¸€ä»¶äº‹æƒ…å°±å­˜25ç¾åˆ†ï¼Œæˆ‘æ—©å°±å‘è´¢äº†:)ã€‚</p>
<p>Probably one of the best pieces of advice I could give you on your way to understanding how to create an interpreter and compiler is to read the explanations in the articles, read the code, and then write code yourself, and even write the same code several times over a period of time to make the material and code feel natural to you, and only then move on to learn new topics. Do not rush, just slow down and take your time to understand the basic ideas deeply. This approach, while seemingly slow, will pay off down the road. TrustÂ me.</p>
<p>ä¹Ÿè®¸åœ¨ä½ ç†è§£å¦‚ä½•åˆ›å»ºè§£é‡Šå™¨å’Œç¼–è¯‘å™¨çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘èƒ½ç»™ä½ çš„æœ€å¥½çš„å»ºè®®ä¹‹ä¸€å°±æ˜¯é˜…è¯»æ–‡ç« ä¸­çš„è§£é‡Šï¼Œé˜…è¯»ä»£ç ï¼Œç„¶åè‡ªå·±ç¼–å†™ä»£ç ï¼Œç”šè‡³åœ¨ä¸€æ®µæ—¶é—´å†…å¤šæ¬¡ç¼–å†™ç›¸åŒçš„ä»£ç ï¼Œä½¿ææ–™å’Œä»£ç å¯¹ä½ æ¥è¯´æ„Ÿè§‰è‡ªç„¶ï¼Œç„¶åå†ç»§ç»­å­¦ä¹ æ–°çš„ä¸»é¢˜ã€‚ä¸è¦åŒ†å¿™ï¼Œåªæ˜¯æ”¾æ…¢é€Ÿåº¦ï¼ŒèŠ±æ—¶é—´æ·±å…¥ç†è§£åŸºæœ¬æ€æƒ³ã€‚è¿™ç§æ–¹æ³•è™½ç„¶çœ‹ä¼¼ç¼“æ…¢ï¼Œä½†æœ€ç»ˆä¼šå¾—åˆ°å›æŠ¥ã€‚ç›¸ä¿¡æˆ‘ã€‚</p>
<p>You will eventually get your perfect ball of yarn in the end. And, you know what? Even if it is not that perfect it is still better than the alternative, which is to do nothing and not learn the topic or quickly skim over it and forget it in a couple ofÂ days.</p>
<p>æœ€ç»ˆä½ ä¼šå¾—åˆ°ä¸€ä¸ªå®Œç¾çš„çº¿å›¢ã€‚ä½ çŸ¥é“å—ï¼Ÿå³ä½¿å®ƒä¸æ˜¯é‚£ä¹ˆå®Œç¾ï¼Œä¹Ÿæ¯”å¦ä¸€ç§é€‰æ‹©è¦å¥½ï¼Œé‚£å°±æ˜¯ä»€ä¹ˆéƒ½ä¸åšï¼Œä¸å­¦ä¹ ä¸»é¢˜ï¼Œæˆ–è€…å¿«é€Ÿæµè§ˆä¸€ä¸‹ï¼Œå‡ å¤©åå°±å¿˜è®°äº†ã€‚</p>
<p>Remember - just keep untangling: one thread, one knot at a time and practice what youâ€™ve learned by writing code, a lot ofÂ it:</p>
<p>è®°ä½â€”â€”åªè¦ä¿æŒç†é¡º: ä¸€æ¡çº¿ï¼Œä¸€æ¬¡ä¸€ä¸ªç»“ï¼Œé€šè¿‡ç¼–å†™ä»£ç æ¥ç»ƒä¹ ä½ æ‰€å­¦åˆ°çš„ä¸œè¥¿ï¼Œå¾ˆå¤š:</p>
<figure data-type="image" tabindex="1"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_ballofyarn.png" alt="" loading="lazy"></figure>
<p>Today youâ€™re going to use all the knowledge youâ€™ve gained from previous articles in the series and learn how to parse and interpret arithmetic expressions that have any number of addition, subtraction, multiplication, and division operators. You will write an interpreter that will be able to evaluate expressions like â€œ14 + 2 * 3 - 6 /Â 2â€.</p>
<p>ä»Šå¤©ï¼Œä½ å°†ä½¿ç”¨ä»æœ¬ç³»åˆ—å‰å‡ ç¯‡æ–‡ç« ä¸­è·å¾—çš„æ‰€æœ‰çŸ¥è¯†ï¼Œå¹¶å­¦ä¹ å¦‚ä½•è§£æå’Œè§£é‡Šä»»æ„æ•°é‡çš„åŠ ã€å‡ã€ä¹˜å’Œé™¤è¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ã€‚ä½ å°†ç¼–å†™ä¸€ä¸ªèƒ½å¤Ÿè®¡ç®—åƒâ€œ14 + 2 * 3-6/2â€è¿™æ ·çš„è¡¨è¾¾å¼çš„è§£é‡Šå™¨ã€‚</p>
<p>Before diving in and writing some code letâ€™s talk about the <strong>associativity</strong> and <strong>precedence</strong> ofÂ operators.</p>
<p>åœ¨æ·±å…¥ç¼–å†™ä¸€äº›ä»£ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆè®¨è®ºä¸€ä¸‹æ“ä½œç¬¦çš„ç»“åˆæ€§å’Œä¼˜å…ˆçº§ã€‚</p>
<p>By convention 7 + 3 + 1 is the same as (7 + 3) + 1 and 7 - 3 - 1 is equivalent to (7 - 3) - 1. No surprises here. We all learned that at some point and have been taking it for granted since then. If we treated 7 - 3 - 1 as 7 - (3 - 1) the result would be unexpected 5 instead of the expectedÂ 3.</p>
<p>æ ¹æ®çº¦å®šï¼Œ7 + 3 + 1ç­‰äº(7 + 3) + 1,7-3-1ç­‰äº(7-3)-1ã€‚è¿™é‡Œæ²¡æœ‰æƒŠå–œã€‚æˆ‘ä»¬éƒ½åœ¨æŸä¸ªæ—¶åˆ»å­¦åˆ°äº†è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸”ä»é‚£æ—¶èµ·å°±ä¸€ç›´è®¤ä¸ºè¿™æ˜¯ç†æ‰€å½“ç„¶çš„ã€‚å¦‚æœæˆ‘ä»¬æŠŠ7-3-1å½“ä½œ7-(3-1) ï¼Œç»“æœå°†æ˜¯æ„å¤–çš„5ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„3ã€‚</p>
<p>In ordinary arithmetic and most programming languages addition, subtraction, multiplication, and division are <em>left-associative</em>:</p>
<p>åœ¨æ™®é€šç®—æœ¯å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼ŒåŠ ã€å‡ã€ä¹˜ã€é™¤éƒ½æ˜¯å·¦ç»“åˆçš„:</p>
<p>7 + 3 + 1 is equivalent to (7 + 3) + 1<br>
7 - 3 - 1 is equivalent to (7 - 3) - 1<br>
8 * 4 * 2 is equivalent to (8 * 4) * 2<br>
8 / 4 / 2 is equivalent to (8 / 4) / 2</p>
<p>What does it mean for an operator to be <em>left-associative</em>?</p>
<p>ä¸€ä¸ªæ“ä½œç¬¦æ˜¯å·¦ç»“åˆçš„ï¼Œè¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<p>When an operand like 3 in the expression 7 + 3 + 1 has plus signs on both sides, we need a convention to decide which operator applies to 3. Is it the one to the left or the one to the right of the operand 3? The operator + <em>associates</em> to the left because an operand that has plus signs on both sides belongs to the operator to its left and so we say that the operator + is <em>left-associative</em>. Thatâ€™s why 7 + 3 + 1 is equivalent to (7 + 3) + 1 by the <em>associativity</em>Â convention.</p>
<p>å½“è¡¨è¾¾å¼7 + 3 + 1ä¸­ç±»ä¼¼äº3çš„æ“ä½œæ•°ä¸¤è¾¹éƒ½æœ‰åŠ å·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçº¦å®šæ¥å†³å®šå“ªä¸ªè¿ç®—ç¬¦åº”ç”¨äº3ã€‚æ˜¯æ“ä½œæ•°3å·¦è¾¹çš„é‚£ä¸ªè¿˜æ˜¯å³è¾¹çš„é‚£ä¸ªï¼Ÿè¿ç®—ç¬¦ + å…³è”åˆ°å·¦è¾¹ï¼Œå› ä¸ºä¸¤è¾¹éƒ½æœ‰åŠ å·çš„æ“ä½œæ•°å±äºå·¦è¾¹çš„è¿ç®—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯´è¿ç®—ç¬¦ + æ˜¯å·¦å…³è”çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ7 + 3 + 1ç­‰ä»·äº(7 + 3) + 1çš„ç»“åˆæ€§çº¦å®šã€‚</p>
<p>Okay, what about an expression like 7 + 5 * 2 where we have different kinds of operators on both sides of the operand 5? Is the expression equivalent to 7 + (5 * 2) or (7 + 5) * 2? How do we resolve thisÂ ambiguity?</p>
<p>å¥½çš„ï¼Œå¯¹äºåƒ7 + 5 * 2è¿™æ ·çš„è¡¨è¾¾å¼ï¼Œæ“ä½œæ•°5çš„ä¸¤è¾¹éƒ½æœ‰ä¸åŒç±»å‹çš„è¿ç®—ç¬¦æ€ä¹ˆåŠï¼Ÿè¡¨è¾¾å¼æ˜¯å¦ç­‰ä»·äº7 + (5 * 2)æˆ–(7 + 5) * 2ï¼Ÿæˆ‘ä»¬å¦‚ä½•è§£å†³è¿™ä¸ªæ¨¡æ£±ä¸¤å¯çš„é—®é¢˜ï¼Ÿ</p>
<p>In this case, the associativity convention is of no help to us because it applies only to operators of one kind, either additive (+, -) or multiplicative (*, /). We need another convention to resolve the ambiguity when we have different kinds of operators in the same expression. We need a convention that defines relative <em>precedence</em> ofÂ operators.</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç»“åˆæ€§çº¦å®šå¯¹æˆ‘ä»¬æ²¡æœ‰å¸®åŠ©ï¼Œå› ä¸ºå®ƒåªé€‚ç”¨äºä¸€ç§æ“ä½œç¬¦ï¼ŒåŠ æ³•(+ ï¼Œ-)æˆ–ä¹˜æ³•(* ,/)ã€‚å½“åŒä¸€è¡¨è¾¾å¼ä¸­æœ‰ä¸åŒç±»å‹çš„è¿ç®—ç¬¦æ—¶ï¼Œéœ€è¦å¦ä¸€ä¸ªçº¦å®šæ¥è§£å†³è¿™ç§æ­§ä¹‰ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªçº¦å®šæ¥å®šä¹‰è¿ç®—ç¬¦çš„ç›¸å¯¹ä¼˜å…ˆçº§ã€‚</p>
<p>And here it is: we say that if the operator * takes its operands before + does, then it has <em>higher precedence</em>. In the arithmetic that we know and use, multiplication and division have <em>higher precedence</em> than addition and subtraction. As a result the expression 7 + 5 * 2 is equivalent to 7 + (5 * 2) and the expression 7 - 8 / 4 is equivalent to 7 - (8 /Â 4).</p>
<p>è¿™å°±æ˜¯: æˆ‘ä»¬è¯´å¦‚æœè¿ç®—ç¬¦ * åœ¨ + ä¹‹å‰å–å¾—äº†å®ƒçš„æ“ä½œæ•°ï¼Œé‚£ä¹ˆå®ƒçš„ä¼˜å…ˆçº§å°±æ›´é«˜ã€‚åœ¨æˆ‘ä»¬æ‰€ç†Ÿæ‚‰å’Œä½¿ç”¨çš„ç®—æœ¯ä¸­ï¼Œä¹˜é™¤æ³•çš„ä¼˜å…ˆçº§é«˜äºåŠ å‡æ³•ã€‚ç»“æœè¡¨è¾¾å¼7 + 5 * 2ç­‰ä»·äº7 + (5 * 2) ï¼Œè¡¨è¾¾å¼7-8/4ç­‰ä»·äº7-(8/4)ã€‚</p>
<p>In a case where we have an expression with operators that have the same <em>precedence</em>, we just use the <em>associativity</em> convention and execute the operators from left toÂ right:</p>
<p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„æ“ä½œç¬¦çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ç»“åˆæ€§çº¦å®šå¹¶ä»å·¦åˆ°å³æ‰§è¡Œæ“ä½œç¬¦:</p>
<p>7 + 3 - 1 is equivalent to (7 + 3) - 1<br>
8 / 4 * 2 is equivalent to (8 / 4) * 2</p>
<p>I hope you didnâ€™t think I wanted to bore you to death by talking so much about the associativity and precedence of operators. The nice thing about those conventions is that we can construct a grammar for arithmetic expressions from a table that shows the associativity and precedence of arithmetic operators. Then, we can translate the grammar into code by following the guidelines I outlined in <a href="http://ruslanspivak.com/lsbasi-part4/">Part 4</a>, and our interpreter will be able to handle the precedence of operators in addition toÂ associativity.</p>
<p>æˆ‘å¸Œæœ›ä½ ä»¬ä¸ä¼šè®¤ä¸ºæˆ‘æƒ³é€šè¿‡è¿‡å¤šåœ°è°ˆè®ºæ“ä½œç¬¦çš„ç»“åˆå¾‹å’Œä¼˜å…ˆçº§æ¥è®©ä½ ä»¬æ„Ÿåˆ°åŒçƒ¦ã€‚è¿™äº›çº¦å®šçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªè¡¨ä¸­ä¸ºç®—æœ¯è¡¨è¾¾å¼æ„é€ ä¸€ç§grammarï¼Œå®ƒæ˜¾ç¤ºäº†ç®—æœ¯è¿ç®—ç¬¦çš„ç»“åˆæ€§å’Œä¼˜å…ˆçº§ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ç¬¬4éƒ¨åˆ†ä¸­æ¦‚è¿°çš„å‡†åˆ™å°†grammarè½¬æ¢ä¸ºä»£ç ï¼Œæˆ‘ä»¬çš„è§£é‡Šå™¨å°†èƒ½å¤Ÿå¤„ç†é™¤äº†ç»“åˆæ€§ä¹‹å¤–çš„æ“ä½œç¬¦çš„ä¼˜å…ˆçº§ã€‚</p>
<p>Okay, here is our precedenceÂ table:</p>
<p>å¥½çš„ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„ä¼˜å…ˆçº§è¡¨:</p>
<figure data-type="image" tabindex="2"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_precedence.png" alt="" loading="lazy"></figure>
<p>From the table, you can tell that operators + and - have the same precedence level and they are both left-associative. You can also see that operators * and / are also left-associative, have the same precedence among themselves but have higher-precedence than addition and subtractionÂ operators.</p>
<p>ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿ç®—ç¬¦ + å’Œ-å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ï¼Œå®ƒä»¬éƒ½æ˜¯å·¦å…³è”çš„ã€‚è¿˜å¯ä»¥çœ‹åˆ°è¿ç®—ç¬¦ * å’Œ/ä¹Ÿæ˜¯å·¦å…³è”çš„ï¼Œå®ƒä»¬ä¹‹é—´çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œä½†æ˜¯æ¯”åŠ å‡è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜ã€‚</p>
<p>Here are the rules for how to construct a grammar from the precedenceÂ table:</p>
<p>ä»¥ä¸‹æ˜¯å¦‚ä½•ä»ä¼˜å…ˆè¡¨æ„é€ grammarçš„è§„åˆ™:</p>
<ol>
<li>For each level of precedence define a non-terminal. The body of a production for the non-terminal should contain arithmetic operators from that level and non-terminals for the next higher level ofÂ precedence.
<ul>
<li>å¯¹äºæ¯ä¸ªä¼˜å…ˆçº§ï¼Œå®šä¹‰ä¸€ä¸ªéç»ˆç»“ç¬¦ã€‚éç»ˆç»“ç¬¦çš„äº§ç”Ÿå¼åº”è¯¥åŒ…å«è¯¥çº§åˆ«çš„ç®—æœ¯è¿ç®—ç¬¦å’Œä¸‹ä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„éç»ˆç»“ç¬¦</li>
</ul>
</li>
<li>Create an additional non-terminal <em>factor</em> for basic units of expression, in our case, integers. The general rule is that if you have N levels of precedence, you will need N + 1 non-terminals in total: one non-terminal for each level plus one non-terminal for basic units of expression.
<ul>
<li>ä¸ºåŸºæœ¬çš„è¡¨è¾¾å¼å•ä½ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯æ•´æ•°ï¼‰åˆ›å»ºä¸€ä¸ªé¢å¤–çš„éç»ˆç»“factorã€‚ä¸€èˆ¬çš„è§„åˆ™æ˜¯ï¼Œå¦‚æœä½ æœ‰Nä¸ªä¼˜å…ˆçº§ï¼Œä½ å°†æ€»å…±éœ€è¦N + 1ä¸ªéç»ˆç»“ç¬¦ï¼šæ¯ä¸ªå±‚æ¬¡ä¸€ä¸ªéç»ˆç»“ç¬¦åŠ ä¸Šä¸€ä¸ªåŸºæœ¬è¡¨è¾¾å¼å•å…ƒçš„éç»ˆç»“ç¬¦ã€‚</li>
</ul>
</li>
</ol>
<p>Onward!</p>
<p>å‰è¿›ï¼</p>
<p>Letâ€™s follow the rules and construct ourÂ grammar.</p>
<p>è®©æˆ‘ä»¬æŒ‰ç…§è§„åˆ™æ¥æ„å»ºæˆ‘ä»¬çš„grammarã€‚</p>
<p>According to Rule 1 we will define two non-terminals: a non-terminal called <em>expr</em> for level 2 and a non-terminal called <em>term</em> for level 1. And by following Rule 2 we will define a <em>factor</em> non-terminal for basic units of arithmetic expressions,Â integers.</p>
<p>æ ¹æ®è§„åˆ™1ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸¤ä¸ªéç»ˆç»“ç¬¦: ä¸€ä¸ªç”¨äºç¬¬2çº§çš„ç§°ä¸º expr çš„éç»ˆç»“ç¬¦ï¼Œä¸€ä¸ªç”¨äºç¬¬1çº§çš„ç§°ä¸ºtermçš„éç»ˆç»“ç¬¦ã€‚é€šè¿‡éµå¾ªè§„åˆ™2ï¼Œæˆ‘ä»¬å°†ä¸ºç®—æœ¯è¡¨è¾¾å¼çš„åŸºæœ¬å•ä½ï¼Œå³æ•´æ•°ï¼Œå®šä¹‰ä¸€ä¸ªfactoréç»ˆç»“ç¬¦ã€‚</p>
<p>The <em>start symbol</em> of our new grammar will be <em>expr</em> and the <em>expr</em> production will contain a body representing the use of operators from level 2, which in our case are operators + and - , and will contain <em>term</em> non-terminals for the next higher level of precedence, levelÂ 1:</p>
<p>æ–°grammarçš„èµ·å§‹ç¬¦å·æ˜¯ exprï¼Œexpr äº§ç”Ÿå¼å°†åŒ…å«ä¸€ä¸ªbodyï¼Œè¡¨ç¤ºæ¥è‡ªç¬¬2çº§çš„è¿ç®—ç¬¦çš„ä½¿ç”¨ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯è¿ç®—ç¬¦ + å’Œ-ï¼Œå¹¶ä¸”å°†åŒ…å«ä¸‹ä¸€ä¸ªæ›´é«˜çº§åˆ«ä¼˜å…ˆçº§1çš„éç»ˆç»“ç¬¦:</p>
<figure data-type="image" tabindex="3"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_cfg_expr.png" alt="" loading="lazy"></figure>
<p>The <em>term</em> production will have a body representing the use of operators from level 1, which are operators * and / , and it will contain the non-terminal <em>factor</em> for the basic units of expression,Â integers:</p>
<p>termäº§ç”Ÿå¼å°†æœ‰ä¸€ä¸ªbodyï¼Œä»£è¡¨ç¬¬1çº§æ“ä½œç¬¦çš„ä½¿ç”¨ï¼Œè¿™äº›æ“ä½œç¬¦æ˜¯æ“ä½œç¬¦ * å’Œ/ï¼Œå®ƒå°†åŒ…å«è¡¨è¾¾å¼åŸºæœ¬å•ä½çš„éç»ˆç»“factorï¼Œå³æ•´æ•°:</p>
<figure data-type="image" tabindex="4"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_cfg_term.png" alt="" loading="lazy"></figure>
<p>And the production for the non-terminal <em>factor</em> willÂ be:</p>
<p>éç»ˆç»“factorçš„äº§ç”Ÿå¼æ˜¯:</p>
<figure data-type="image" tabindex="5"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_cfg_factor.png" alt="" loading="lazy"></figure>
<p>Youâ€™ve already seen above productions as part of grammars and syntax diagrams from previous articles, but here we combine them into one grammar that takes care of the associativity and the precedence ofÂ operators:</p>
<p>ä½ å·²ç»åœ¨ä»¥å‰æ–‡ç« çš„grammarå’Œsyntaxå›¾è¡¨ä¸­çœ‹åˆ°è¿‡ä¸Šé¢çš„ç»“æœï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬æŠŠå®ƒä»¬ç»„åˆæˆä¸€ç§grammarï¼Œè¿™ç§grammarè€ƒè™‘äº†ç»“åˆæ€§å’Œæ“ä½œç¬¦çš„ä¼˜å…ˆçº§:</p>
<figure data-type="image" tabindex="6"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_grammar.png" alt="" loading="lazy"></figure>
<p>Here is a syntax diagram that corresponds to the grammarÂ above:</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¸ä¸Šé¢çš„grammarç›¸å¯¹åº”çš„syntaxå›¾:</p>
<figure data-type="image" tabindex="7"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_syntaxdiagram.png" alt="" loading="lazy"></figure>
<p>Each rectangular box in the diagram is a â€œmethod callâ€ to another diagram. If you take the expression 7 + 5 * 2 and start with the top diagram <em>expr</em> and walk your way down to the bottommost diagram <em>factor</em>, you should be able to see that <em>higher-precedence</em> operators * and / in the lower diagram execute before operators + and - in the higherÂ diagram.</p>
<p>å›¾ä¸­çš„æ¯ä¸ªçŸ©å½¢æ¡†éƒ½æ˜¯å¯¹å¦ä¸€ä¸ªå›¾çš„â€œæ–¹æ³•è°ƒç”¨â€ã€‚å¦‚æœä½¿ç”¨è¡¨è¾¾å¼7 + 5 * 2å¹¶ä»é¡¶éƒ¨å›¾ expr å¼€å§‹ï¼Œç„¶åä¸€ç›´å‘ä¸‹åˆ°æœ€åº•éƒ¨çš„å›¾factorï¼Œé‚£ä¹ˆåº”è¯¥èƒ½å¤Ÿçœ‹åˆ°åœ¨è¾ƒé«˜çš„å›¾ä¸­ï¼Œè¾ƒé«˜ä¼˜å…ˆçº§çš„è¿ç®—ç¬¦ * å’Œ/åœ¨è¾ƒä½çš„å›¾ä¸­ï¼Œåœ¨è¿ç®—ç¬¦ + å’Œ-ä¹‹å‰æ‰§è¡Œã€‚</p>
<p>To drive the precedence of operators point home, letâ€™s take a look at the decomposition of the same arithmetic expression 7 + 5 * 2 done in accordance with our grammar and syntax diagrams above. This is just another way to show that <em>higher-precedence</em> operators execute before operators with <em>lower precedence</em>:</p>
<p>ä¸ºäº†ä½¿è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æ›´æ˜ç¡®ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ ¹æ®ä¸Šé¢çš„grammarå’Œsyntaxå›¾å¯¹åŒä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼7 + 5 * 2è¿›è¡Œçš„åˆ†è§£ã€‚è¿™åªæ˜¯æ˜¾ç¤ºé«˜ä¼˜å…ˆçº§è¿ç®—ç¬¦å…ˆäºä½ä¼˜å…ˆçº§è¿ç®—ç¬¦æ‰§è¡Œçš„å¦ä¸€ç§æ–¹å¼:</p>
<figure data-type="image" tabindex="8"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_exprdecomp.png" alt="" loading="lazy"></figure>
<p>Okay, letâ€™s convert the grammar to code following guidelines from <a href="http://ruslanspivak.com/lsbasi-part4/">Part 4</a> and see how our new interpreter works, shallÂ we?</p>
<p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æŒ‰ç…§ç¬¬4éƒ¨åˆ†ä¸­çš„æŒ‡å¯¼æ–¹é’ˆå°†grammarè½¬æ¢ä¸ºä»£ç ï¼Œçœ‹çœ‹æˆ‘ä»¬çš„æ–°è§£é‡Šå™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¥½å—ï¼Ÿ</p>
<p>Here is the grammarÂ again:</p>
<p>è¿™é‡Œå†æ¬¡æåˆ°grammar:</p>
<figure data-type="image" tabindex="9"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_grammar.png" alt="" loading="lazy"></figure>
<p>And here is the complete code of a calculator that can handle valid arithmetic expressions containing integers and any number of addition, subtraction, multiplication, and divisionÂ operators.</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè®¡ç®—å™¨çš„å®Œæ•´ä»£ç ï¼Œå®ƒå¯ä»¥å¤„ç†åŒ…å«æ•´æ•°å’Œä»»æ„æ•°é‡çš„åŠ ã€å‡ã€ä¹˜ã€é™¤è¿ç®—ç¬¦çš„æœ‰æ•ˆç®—æœ¯è¡¨è¾¾å¼ã€‚</p>
<p>The following are the main changes compared with the code from <a href="http://ruslanspivak.com/lsbasi-part4/">Part 4</a>:</p>
<p>ä»¥ä¸‹æ˜¯ä¸ç¬¬4éƒ¨åˆ†ä»£ç ç›¸æ¯”çš„ä¸»è¦å˜åŒ–:</p>
<ul>
<li>The <em>Lexer</em> class can now tokenize +, -, *, and / (Nothing new here, we just combined code from previous articles into one class that supports all those tokens)
<ul>
<li>Lexerç±»ç°åœ¨å¯ä»¥æ ‡è®°+ã€-ã€*å’Œ/ï¼ˆè¿™é‡Œæ²¡æœ‰ä»€ä¹ˆæ–°å†…å®¹ï¼Œæˆ‘ä»¬åªæ˜¯å°†å‰å‡ ç¯‡æ–‡ç« ä¸­çš„ä»£ç ç»„åˆæˆä¸€ä¸ªæ”¯æŒæ‰€æœ‰è¿™äº›æ ‡è®°çš„ç±»ï¼‰</li>
</ul>
</li>
<li>Recall that each rule (production), <strong>R</strong>, defined in the grammar, becomes a method with the same name, and references to that rule become a method call: <strong>R()</strong>. As a result the <em>Interpreter</em> class now has three methods that correspond to non-terminals in the grammar: <em>expr</em>, <em>term</em>, and <em>factor</em>.
<ul>
<li>å›æƒ³ä¸€ä¸‹ï¼Œgrammarä¸­å®šä¹‰çš„æ¯ä¸ªè§„åˆ™ï¼ˆäº§ç”Ÿå¼ï¼‰Rå˜æˆäº†åŒåçš„æ–¹æ³•ï¼Œè€Œå¯¹è¯¥è§„åˆ™çš„å¼•ç”¨å˜æˆäº†æ–¹æ³•è°ƒç”¨R()ã€‚å› æ­¤ï¼ŒInterpreterç±»ç°åœ¨æœ‰ä¸‰ä¸ªæ–¹æ³•å¯¹åº”è¯­æ³•ä¸­çš„éç»ˆç»“ç¬¦ï¼šexprã€termå’Œfactorã€‚</li>
</ul>
</li>
</ul>
<p>SourceÂ code:</p>
<p>æºä»£ç :</p>
<pre><code class="language-python"># Token types
#
# EOF (end-of-file) token is used to indicate that
# there is no more input left for lexical analysis
INTEGER, PLUS, MINUS, MUL, DIV, EOF = (
    'INTEGER', 'PLUS', 'MINUS', 'MUL', 'DIV', 'EOF'
)


class Token(object):
    def __init__(self, type, value):
        # token type: INTEGER, PLUS, MINUS, MUL, DIV, or EOF
        self.type = type
        # token value: non-negative integer value, '+', '-', '*', '/', or None
        self.value = value

    def __str__(self):
        &quot;&quot;&quot;String representation of the class instance.

        Examples:
            Token(INTEGER, 3)
            Token(PLUS, '+')
            Token(MUL, '*')
        &quot;&quot;&quot;
        return 'Token({type}, {value})'.format(
            type=self.type,
            value=repr(self.value)
        )

    def __repr__(self):
        return self.__str__()


class Lexer(object):
    def __init__(self, text):
        # client string input, e.g. &quot;3 * 5&quot;, &quot;12 / 3 * 4&quot;, etc
        self.text = text
        # self.pos is an index into self.text
        self.pos = 0
        self.current_char = self.text[self.pos]

    def error(self):
        raise Exception('Invalid character')

    def advance(self):
        &quot;&quot;&quot;Advance the `pos` pointer and set the `current_char` variable.&quot;&quot;&quot;
        self.pos += 1
        if self.pos &gt; len(self.text) - 1:
            self.current_char = None  # Indicates end of input
        else:
            self.current_char = self.text[self.pos]

    def skip_whitespace(self):
        while self.current_char is not None and self.current_char.isspace():
            self.advance()

    def integer(self):
        &quot;&quot;&quot;Return a (multidigit) integer consumed from the input.&quot;&quot;&quot;
        result = ''
        while self.current_char is not None and self.current_char.isdigit():
            result += self.current_char
            self.advance()
        return int(result)

    def get_next_token(self):
        &quot;&quot;&quot;Lexical analyzer (also known as scanner or tokenizer)

        This method is responsible for breaking a sentence
        apart into tokens. One token at a time.
        &quot;&quot;&quot;
        while self.current_char is not None:

            if self.current_char.isspace():
                self.skip_whitespace()
                continue

            if self.current_char.isdigit():
                return Token(INTEGER, self.integer())

            if self.current_char == '+':
                self.advance()
                return Token(PLUS, '+')

            if self.current_char == '-':
                self.advance()
                return Token(MINUS, '-')

            if self.current_char == '*':
                self.advance()
                return Token(MUL, '*')

            if self.current_char == '/':
                self.advance()
                return Token(DIV, '/')

            self.error()

        return Token(EOF, None)


class Interpreter(object):
    def __init__(self, lexer):
        self.lexer = lexer
        # set current token to the first token taken from the input
        self.current_token = self.lexer.get_next_token()

    def error(self):
        raise Exception('Invalid syntax')

    def eat(self, token_type):
        # compare the current token type with the passed token
        # type and if they match then &quot;eat&quot; the current token
        # and assign the next token to the self.current_token,
        # otherwise raise an exception.
        if self.current_token.type == token_type:
            self.current_token = self.lexer.get_next_token()
        else:
            self.error()

    def factor(self):
        &quot;&quot;&quot;factor : INTEGER&quot;&quot;&quot;
        token = self.current_token
        self.eat(INTEGER)
        return token.value

    def term(self):
        &quot;&quot;&quot;term : factor ((MUL | DIV) factor)*&quot;&quot;&quot;
        result = self.factor()

        while self.current_token.type in (MUL, DIV):
            token = self.current_token
            if token.type == MUL:
                self.eat(MUL)
                result = result * self.factor()
            elif token.type == DIV:
                self.eat(DIV)
                result = result // self.factor()

        return result

    def expr(self):
        &quot;&quot;&quot;Arithmetic expression parser / interpreter.

        calc&gt;  14 + 2 * 3 - 6 / 2
        17

        expr   : term ((PLUS | MINUS) term)*
        term   : factor ((MUL | DIV) factor)*
        factor : INTEGER
        &quot;&quot;&quot;
        result = self.term()

        while self.current_token.type in (PLUS, MINUS):
            token = self.current_token
            if token.type == PLUS:
                self.eat(PLUS)
                result = result + self.term()
            elif token.type == MINUS:
                self.eat(MINUS)
                result = result - self.term()

        return result


def main():
    while True:
        try:
            text = input('calc&gt; ')
        except EOFError:
            break
        if not text:
            continue
        lexer = Lexer(text)
        interpreter = Interpreter(lexer)
        result = interpreter.expr()
        print(result)


if __name__ == '__main__':
    main()

</code></pre>
<p>Save the above code into the <em>calc5.py</em> file or download it directly from <a href="https://github.com/rspivak/lsbasi/blob/master/part5/calc5.py">GitHub</a>. As usual, try it out and see for yourself that the interpreter properly evaluates arithmetic expressions that have operators with differentÂ precedence.</p>
<p>å°†ä¸Šé¢çš„ä»£ç ä¿å­˜åˆ° calc5.py æ–‡ä»¶ä¸­ï¼Œæˆ–è€…ç›´æ¥ä» GitHub ä¸‹è½½ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œè¯•ä¸€è¯•ï¼Œäº²è‡ªçœ‹çœ‹è§£é‡Šå™¨æ˜¯å¦æ­£ç¡®åœ°è®¡ç®—ä¼˜å…ˆçº§ä¸åŒçš„è¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ã€‚</p>
<p>Here is a sample session on myÂ laptop:</p>
<p>ä¸‹é¢æ˜¯æˆ‘ç¬”è®°æœ¬ç”µè„‘ä¸Šçš„ä¸€ä¸ªä¾‹å­:</p>
<pre><code class="language-python">$ python calc5.py
calc&gt; 3
3
calc&gt; 2 + 7 * 4
30
calc&gt; 7 - 8 / 4
5
calc&gt; 14 + 2 * 3 - 6 / 2
17
</code></pre>
<p>Here are new exercises forÂ today:</p>
<p>ä»¥ä¸‹æ˜¯ä»Šå¤©çš„æ–°ç»ƒä¹ :</p>
<figure data-type="image" tabindex="10"><img src="https://ruslanspivak.com/lsbasi-part5/lsbasi_part5_exercises.png" alt="" loading="lazy"></figure>
<ul>
<li>Write an interpreter as described in this article off the top of your head, without peeking into the code from the article. Write some tests for your interpreter, and make sure theyÂ pass.
<ul>
<li>æ ¹æ®æœ¬æ–‡çš„æè¿°å†™ä¸€ä¸ªè§£é‡Šå™¨ï¼Œä¸è¦å·çœ‹æ–‡ç« ä¸­çš„ä»£ç ã€‚ä¸ºä½ çš„è§£é‡Šå™¨ç¼–å†™ä¸€äº›æµ‹è¯•ï¼Œå¹¶ç¡®ä¿å®ƒä»¬é€šè¿‡ã€‚</li>
</ul>
</li>
<li>Extend the interpreter to handle arithmetic expressions containing parentheses so that your interpreter could evaluate deeply nested arithmetic expressions like: 7 + 3 * (10 / (12 / (3 + 1) -Â 1))
<ul>
<li>æ‰©å±•è§£é‡Šå™¨ä»¥å¤„ç†åŒ…å«æ‹¬å·çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œè¿™æ ·ä½ çš„è§£é‡Šå™¨å°±å¯ä»¥è®¡ç®—æ·±åµŒå¥—çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œæ¯”å¦‚: 7 + 3 * (10/(12/(3 + 1)-1))</li>
</ul>
</li>
</ul>
<p><strong>Check yourÂ understanding.</strong></p>
<p>æ£€æŸ¥ä½ çš„ç†è§£ã€‚</p>
<ol>
<li>What does it mean for an operator to be _left-associative ? _</li>
</ol>
<blockquote>
<p>å½“ä¸¤è¾¹éƒ½æœ‰åŒä¸€ä¸ªæ“ä½œç¬¦çš„æ“ä½œæ•°å±äºå·¦è¾¹çš„æ“ä½œç¬¦æ—¶ï¼Œè¯´è¯¥æ“ä½œç¬¦æ˜¯å·¦å…³è”çš„</p>
</blockquote>
<ol start="2">
<li>Are operators + and - _left-associative _ or _right-associative _? What about * and /Â ?</li>
</ol>
<blockquote>
<p>+å’Œ-éƒ½æ˜¯å·¦å…³è”ï¼Œ*å’Œ/ä¹Ÿæ˜¯å·¦å…³è”</p>
</blockquote>
<ol start="3">
<li>Does operator + have  _higher precedence _than operator *Â ?</li>
</ol>
<blockquote>
<p>*æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§</p>
</blockquote>
<p>Hey, you read all the way to the end! Thatâ€™s really great. Iâ€™ll be back next time with a new article - stay tuned, be brilliant, and, as usual, donâ€™t forget to do theÂ exercises.</p>
<p>å˜¿ï¼Œä½ ä»å¤´è¯»åˆ°å°¾ï¼çœŸæ˜¯å¤ªå¥½äº†ã€‚ä¸‹æ¬¡æˆ‘ä¼šå¸¦ç€ä¸€ç¯‡æ–°æ–‡ç« å›æ¥â€”â€”ç»§ç»­å…³æ³¨ï¼Œä¿æŒç²¾å½©ï¼Œåƒå¾€å¸¸ä¸€æ ·ï¼Œä¸è¦å¿˜è®°åšç»ƒä¹ ã€‚</p>
<p>Here is a list of books I recommend that will help you in your study of interpreters andÂ compilers:</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘æ¨èçš„ä¸€äº›ä¹¦ç±ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©ä½ å­¦ä¹ è§£é‡Šå™¨å’Œç¼–è¯‘å™¨:</p>
<ol>
<li><a href="http://www.amazon.com/gp/product/193435645X/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=193435645X&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=MP4DCXDV6DJMEJBL">Language Implementation Patterns: Create Your Own Domain-Specific and General Programming Languages (Pragmatic Programmers)</a><br>
è¯­è¨€å®ç°æ¨¡å¼: åˆ›å»ºæ‚¨è‡ªå·±çš„ç‰¹å®šé¢†åŸŸå’Œé€šç”¨ç¼–ç¨‹è¯­è¨€(å®ç”¨ç¨‹åºå‘˜)</li>
<li><a href="http://www.amazon.com/gp/product/0470177071/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0470177071&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=UCLGQTPIYSWYKRRM">Writing Compilers and Interpreters: A Software Engineering Approach</a><br>
ç¼–å†™ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨: ä¸€ç§è½¯ä»¶å·¥ç¨‹æ–¹æ³•</li>
<li><a href="http://www.amazon.com/gp/product/052182060X/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=052182060X&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=ZSKKZMV7YWR22NMW">Modern Compiler Implementation in Java</a><br>
ç°ä»£ç¼–è¯‘å™¨åœ¨ Java ä¸­çš„å®ç°</li>
<li><a href="http://www.amazon.com/gp/product/1461446988/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1461446988&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=PAXWJP5WCPZ7RKRD">Modern Compiler Design</a><br>
ç°ä»£ç¼–è¯‘å™¨è®¾è®¡</li>
<li><a href="http://www.amazon.com/gp/product/0321486811/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0321486811&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=GOEGDQG4HIHU56FQ">Compilers: Principles, Techniques, and Tools (2nd Edition)</a><br>
ç¼–è¯‘å™¨: åŸç†ã€æŠ€æœ¯å’Œå·¥å…·(ç¬¬äºŒç‰ˆ)</li>
</ol>
<p>If you want to get my newest articles in your inbox, then enter your email address below and click &quot;Get Updates!&quot;</p>
<p><strong>All articles in this series:</strong></p>
<ul>
<li><a href="https://ruslanspivak.com/lsbasi-part1/">Let's Build A Simple Interpreter. Part 1.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part2/">Let's Build A Simple Interpreter. Part 2.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part3/">Let's Build A Simple Interpreter. Part 3.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part4/">Let's Build A Simple Interpreter. Part 4.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part5/">Let's Build A Simple Interpreter. Part 5.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part6/">Let's Build A Simple Interpreter. Part 6.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part7/">Let's Build A Simple Interpreter. Part 7: Abstract Syntax Trees</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part8/">Let's Build A Simple Interpreter. Part 8.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part9/">Let's Build A Simple Interpreter. Part 9.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part10/">Let's Build A Simple Interpreter. Part 10.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part11/">Let's Build A Simple Interpreter. Part 11.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part12/">Let's Build A Simple Interpreter. Part 12.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part13/">Let's Build A Simple Interpreter. Part 13: Semantic Analysis</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part14/">Let's Build A Simple Interpreter. Part 14: Nested Scopes and a Source-to-Source Compiler</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part15/">Let's Build A Simple Interpreter. Part 15.</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part16/">Let's Build A Simple Interpreter. Part 16: Recognizing Procedure Calls</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part17/">Let's Build A Simple Interpreter. Part 17: Call Stack and Activation Records</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part18/">Let's Build A Simple Interpreter. Part 18: Executing Procedure Calls</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part19/">Let's Build A Simple Interpreter. Part 19: Nested Procedure Calls</a></li>
</ul>

                        </div>
                        
                            <div class="post-toc">
                                
                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>ztree</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/">https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR ç " target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/&sharesource=qzone&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part5.&pics=https://lzxzl.github.io/images/avatar.png?v=1747748455692&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="æ–°æµªå¾®åš" target="_blank" href="https://service.weibo.com/share/share.php?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/&sharesource=weibo&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part5. + " - " + &pic="https://lzxzl.github.io/images/avatar.png?v=1747748455692 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">#
                    ç¼–è¯‘åŸç†
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part6/">
                                                                                            [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part6.
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/">
                                                                                                    [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part4.
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '2a44a295dd16ae7d05b8',
        clientSecret: '8030257bc11446a193cf383767567daca0e26312',
        repo: 'lzxzl.github.io',
        owner: 'lzxzl',
        admin: ['lzxzl'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        ztree
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        ztree &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://lzxzl.github.io/" target="_blank">
                                                ztree
                                            </a>
            </div>
            <div id="update" style="display:none;">
                off
            </div>
            
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
                <script>
                    
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    var newDate = new Date();
                    newDate.setTime(1747748455692);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>