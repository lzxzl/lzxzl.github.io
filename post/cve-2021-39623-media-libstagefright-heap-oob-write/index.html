<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ztree
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="ztree">
<meta name="description" content="竹杖芒鞋轻胜马，谁怕？一蓑烟雨任平生。">
<meta name="keywords" content="Binary">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://lzxzl.github.io/styles/main.css" />
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                        <!--CDN样式-->
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://lzxzl.github.io">
                    ztree
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        首页
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        归档
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        标签
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        关于
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://lzxzl.github.io">
                            ztree
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            首页
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            归档
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            标签
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            关于
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                CVE-2021-39623 - media - libstagefright - heap OOB Write
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            ztree
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2023-09-06</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">8.7
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">1836</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://lzxzl.github.io/tag/Android-CVE/">Android-CVE</a>
                                
                            </span>
                                            
                                                阅读量:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <blockquote>
<p>2023.09.05</p>
</blockquote>
<table>
<thead>
<tr>
<th>CVE-2021-39623</th>
<th><a href="https://android.googlesource.com/platform/frameworks/av/+/5753afcd4c87f5566f4014cce1cbc8d767572331">A-194105348</a></th>
<th>EoP</th>
<th>高</th>
<th>9、10、11、12</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="patch"><a href="https://android.googlesource.com/platform/frameworks/av/+/5753afcd4c87f5566f4014cce1cbc8d767572331%5E%21/#F0">patch</a></h2>
<blockquote>
<p>SimpleDecodingSource:Prevent OOB write in heap mem<br>
doRead() doesn't handle situations when received byte do not fit into input buffer in case of vorbis audio compression. It results in OOB write in heap memory right after the allocated input buffer. Added code to copy kKeyValidSamples only if there was enough space. Otherwise, print a warning log.<br>
若cpLen = in_buffer-&gt;capacity()，那么在后面的 vorbis 音频压缩的场景下，in_buffer没有空间再用于拷贝kKeyValidSamples（numPageSamples）的值了，于是，发生越界写4个字节。<br>
修复方式：添加了仅在有足够空间时复制 kKeyValidSamples 的代码。 否则，打印警告日志。<br>
Bug: 194105348<br>
Test: post-submit media cts tests</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://lzxzl.github.io/post-images/1694008987513.png" alt="" loading="lazy"></figure>
<h2 id="分析">分析</h2>
<pre><code class="language-c">// frameworks/av/media/libstagefright/SimpleDecodingSource.cpp
// 这段代码是一个音视频解码器的读取函数，
// 主要功能是从输入源读取数据并进行解码。
status_t SimpleDecodingSource::doRead(
        Mutexed&lt;ProtectedState&gt;::Locked &amp;me, MediaBufferBase **buffer, const ReadOptions *options) {
    // |me| is always locked on entry, but is allowed to be unlocked on exit
    // 【1】首先检查当前状态是否是STARTED状态，如果不是则返回错误。
    CHECK_EQ(me-&gt;mState, STARTED);
    size_t out_ix, in_ix, out_offset, out_size;
    int64_t out_pts;
    uint32_t out_flags;
    status_t res;
    // flush codec on seek
    // 【2】如果传入的options参数不为空，且包含seek操作，那么在进行seek操作前需要先flush解码器。
    MediaSource::ReadOptions::SeekMode mode;
    if (options != NULL &amp;&amp; options-&gt;getSeekTo(&amp;out_pts, &amp;mode)) {
        me-&gt;mQueuedInputEOS = false;
        me-&gt;mGotOutputEOS = false;
        mCodec-&gt;flush();
    }
    // 【3】如果已经获取到了输出的EOS（End of Stream）标志，说明已经读取到了输入源的末尾，直接返回ERROR_END_OF_STREAM。
    if (me-&gt;mGotOutputEOS) {
        return ERROR_END_OF_STREAM;
    }
    // 【4】进入一个循环，最多重试kTimeoutMaxRetries次。
    for (int retries = 0; retries &lt; kTimeoutMaxRetries; ++retries) {
        // If we fill all available input buffers, we should expect that
        // the codec produces at least one output buffer. Also, the codec
        // should produce an output buffer in at most 1 seconds. Retry a
        // few times nonetheless.
        // 【4.1】首先判断是否还有可用的输入缓冲区。如果没有则退出循环。
        while (!me-&gt;mQueuedInputEOS) {
            // allow some time to get input buffer after flush
            // 【4.2】获取一个可用的输入缓冲区in_buffer，并将输入数据读取到该缓冲区in_buffer中。
            res = mCodec-&gt;dequeueInputBuffer(&amp;in_ix, kTimeoutWaitForInputUs);
            if (res == -EAGAIN) {
                // no available input buffers
                break;
            }
            sp&lt;MediaCodecBuffer&gt; in_buffer;
            if (res == OK) {
                // 调用 mCodec 对象的 getInputBuffer 方法来获取指定索引的输入缓冲区，并将其地址存储在 in_buffer 变量中
                res = mCodec-&gt;getInputBuffer(in_ix, &amp;in_buffer);
            }
            // 【4.3】如果读取失败，将状态设置为ERROR并返回UNKNOWN_ERROR。
            if (res != OK || in_buffer == NULL) {
                ALOGW(&quot;[%s] could not get input buffer #%zu&quot;,
                        mComponentName.c_str(), in_ix);
                me-&gt;mState = ERROR;
                return UNKNOWN_ERROR;
            }
            // 【4.4】如果读取成功，将读取到的数据拷贝到解码器的输入缓冲区in_buf中，
            // 并将输入缓冲区提交给解码器进行解码。
            MediaBufferBase *in_buf;
            while (true) {
                in_buf = NULL;
                me.unlock();
                res = mSource-&gt;read(&amp;in_buf, options);
                me.lock();
                if (res != OK || me-&gt;mState != STARTED) {
                    if (in_buf != NULL) {
                        in_buf-&gt;release();
                        in_buf = NULL;
                    }
                    
                    // queue EOS
                    me-&gt;mQueuedInputEOS = true;
                    
                    if (mCodec-&gt;queueInputBuffer(
                                 in_ix, 0 /* offset */, 0 /* size */,
                                 0 /* pts */, MediaCodec::BUFFER_FLAG_EOS) != OK) {
                        ALOGI(&quot;[%s] failed to queue input EOS&quot;, mComponentName.c_str());
                        me-&gt;mState = ERROR;
                        return UNKNOWN_ERROR;
                    }
                    // don't stop on EOS, but report error or EOS on stop
                    if (res != ERROR_END_OF_STREAM) {
                        me-&gt;mState = ERROR;
                        return res;
                    }
                    if (me-&gt;mState != STARTED) {
                        return ERROR_END_OF_STREAM;
                    }
                    break;
                }
                if (in_buf == NULL) { // should not happen
                    continue;
                } else if (in_buf-&gt;range_length() != 0) {
                    break;
                }
                in_buf-&gt;release();
            }

            // 判断 in_buf 是否为 NULL。如果不为 NULL，继续执行下面的逻辑。
            if (in_buf != NULL) {
                // 使用 meta_data() 方法从in_buf的元数据中查找名为 kKeyTime 的整数值，并将其存储在 timestampUs 变量中
                int64_t timestampUs = 0;
                CHECK(in_buf-&gt;meta_data().findInt64(kKeyTime, &amp;timestampUs));
                // 判断in_buf的有效数据长度（range_length()）加上特定条件（如果是 Vorbis 格式，再加上 4 字节）是否超过了in_buffer的容量（capacity()）。
                // 如果超过了容量，代码会打印一个警告信息。
                if (in_buf-&gt;range_length() + (mIsVorbis ? 4 : 0) &gt; in_buffer-&gt;capacity()) {
                    ALOGW(&quot;'%s' received %zu input bytes for buffer of size %zu&quot;,
                            mComponentName.c_str(),
                            in_buf-&gt;range_length() + (mIsVorbis ? 4 : 0), in_buffer-&gt;capacity());
                }
                // 计算需要拷贝的数据长度 cpLen，取in_buf的有效数据长度和in_buffer的容量 这两者中的较小者
                size_t cpLen = min(in_buf-&gt;range_length(), in_buffer-&gt;capacity()); // 【漏洞分析1】 cpLen是这两者中的最小者，如果cpLen = in_buffer-&gt;capacity()
                // 将 in_buf 的数据拷贝到in_buffer 的基地址处，拷贝的数据长度为 cpLen 字节
                memcpy(in_buffer-&gt;base(), (uint8_t *)in_buf-&gt;data() + in_buf-&gt;range_offset(),
                        cpLen );
                // 如果输入缓冲区是 Vorbis 格式，代码会继续执行下面的逻辑。
                if (mIsVorbis) {
                    int32_t numPageSamples;
                    // 使用 in_buf 对象的 meta_data() 方法来获取in_buf的元数据，并从中查找名为 kKeyValidSamples 的整数值，并将其存储在 numPageSamples 变量中
                    if (!in_buf-&gt;meta_data().findInt32(kKeyValidSamples, &amp;numPageSamples)) {
                        // 如果找不到该键值，则将 numPageSamples 设置为 -1。
                        numPageSamples = -1;
                    }
                    // dest：in_buffer-&gt;base() + cpLen 表达式表示输入缓冲区的基地址加上 cpLen，即获取到从 cpLen 位置开始的一段内存地址
                    // source：numPageSamples 变量的地址
                    // 复制的字节数为 sizeof(numPageSamples)
                    //【漏洞分析2】如果cpLen = in_buffer-&gt;capacity()，那么此时in_buffer-&gt;base() + cpLen已经指向in_buffer的末尾了
                    // 那么也就是没有空间再用于拷贝kKeyValidSamples（numPageSamples）的值了。
                    // 此时就会发生OOB Write
                    memcpy(in_buffer-&gt;base() + cpLen, &amp;numPageSamples, sizeof(numPageSamples)); // 【漏洞点】OOB Write
                }
                // 调用 mCodec 对象的 queueInputBuffer 方法将输入缓冲区 in_buf 排队到编解码器中。
                // 传递给该方法的参数包括输入缓冲区的索引 in_ix、偏移量 offset、长度（输入缓冲区的有效数据长度加上特定条件）和时间戳 timestampUs。
                res = mCodec-&gt;queueInputBuffer(
                        in_ix, 0 /* offset */, in_buf-&gt;range_length() + (mIsVorbis ? 4 : 0),
                        timestampUs, 0 /* flags */);
                // 检查 queueInputBuffer 方法的返回值 res 是否为 OK。
                // 如果不为 OK，代码会打印一个信息，并将当前状态设为 ERROR。
                if (res != OK) {
                    ALOGI(&quot;[%s] failed to queue input buffer #%zu&quot;, mComponentName.c_str(), in_ix);
                    me-&gt;mState = ERROR;
                }
                // 调用输入缓冲区的 release 方法释放该缓冲区。
                in_buf-&gt;release();
            }
        }
        // 【4.5】解码器进行解码后，将解码后的数据放入输出缓冲区中。
        me.unlock();
        res = mCodec-&gt;dequeueOutputBuffer(
                &amp;out_ix, &amp;out_offset, &amp;out_size, &amp;out_pts,
                &amp;out_flags, kTimeoutWaitForOutputUs /* timeoutUs */);
        me.lock();
        // abort read on stop
        if (me-&gt;mState != STARTED) {
            if (res == OK) {
                mCodec-&gt;releaseOutputBuffer(out_ix);
            }
            return ERROR_END_OF_STREAM;
        }
        if (res == -EAGAIN) {
            ALOGD(&quot;[%s] did not produce an output buffer. retry count: %d&quot;,
                  mComponentName.c_str(), retries);
            continue;
        } else if (res == INFO_FORMAT_CHANGED) {
            if (mCodec-&gt;getOutputFormat(&amp;me-&gt;mFormat) != OK) {
                me-&gt;mState = ERROR;
                res = UNKNOWN_ERROR;
            }
            return res;
        } else if (res == INFO_OUTPUT_BUFFERS_CHANGED) {
            ALOGV(&quot;output buffers changed&quot;);
            continue;
        } else if (res != OK) {
            me-&gt;mState = ERROR;
            return res;
        }
        sp&lt;MediaCodecBuffer&gt; out_buffer;
        res = mCodec-&gt;getOutputBuffer(out_ix, &amp;out_buffer);
        if (res != OK) {
            ALOGW(&quot;[%s] could not get output buffer #%zu&quot;,
                    mComponentName.c_str(), out_ix);
            me-&gt;mState = ERROR;
            return UNKNOWN_ERROR;
        }
        // 【4.6】如果解码器输出的数据中包含EOS标志,
        if (out_flags &amp; MediaCodec::BUFFER_FLAG_EOS) {
            me-&gt;mGotOutputEOS = true;// 将状态设置为已获取到输出的EOS，
            // return EOS immediately if last buffer is empty
            if (out_size == 0) {
                mCodec-&gt;releaseOutputBuffer(out_ix);
                return ERROR_END_OF_STREAM; // 并立即返回ERROR_END_OF_STREAM（如果最后一个输出缓冲区为空）。
            }
        }
        // 【4.7】如果使用的是Surface进行渲染，并且输出缓冲区中有数据
        if (mUsingSurface &amp;&amp; out_size &gt; 0) {
            *buffer = new MediaBuffer(0);// 将输出缓冲区的大小设置为0，
            mCodec-&gt;renderOutputBufferAndRelease(out_ix);// 并调用解码器的renderOutputBufferAndRelease函数释放输出缓冲区。
        } else { // 【4.8】如果不使用Surface进行渲染，
            // 将输出缓冲区的数据拷贝到新创建的MediaBuffer中
            *buffer = new MediaBuffer(out_size);
            CHECK_LE(out_buffer-&gt;size(), (*buffer)-&gt;size());
            memcpy((*buffer)-&gt;data(), out_buffer-&gt;data(), out_buffer-&gt;size());
            // 并设置相关的元数据信息
            (*buffer)-&gt;meta_data().setInt64(kKeyTime, out_pts);
            // 然后释放输出缓冲区。
            mCodec-&gt;releaseOutputBuffer(out_ix);
        }
        return OK; // 【4.9】返回OK表示成功读取并解码一帧数据。
    }
    return TIMED_OUT; // 【4.10】如果重试次数超过了kTimeoutMaxRetries，则返回TIMED_OUT表示超时。
}
</code></pre>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#patch">patch</a></li>
<li><a href="#%E5%88%86%E6%9E%90">分析</a></li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>ztree</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://lzxzl.github.io/post/cve-2021-39623-media-libstagefright-heap-oob-write/">https://lzxzl.github.io/post/cve-2021-39623-media-libstagefright-heap-oob-write/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR 码" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://lzxzl.github.io/post/cve-2021-39623-media-libstagefright-heap-oob-write/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://lzxzl.github.io/post/cve-2021-39623-media-libstagefright-heap-oob-write/&sharesource=qzone&title=CVE-2021-39623 - media - libstagefright - heap OOB Write&pics=https://lzxzl.github.io/images/avatar.png?v=1747748455692&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="新浪微博" target="_blank" href="https://service.weibo.com/share/share.php?url=https://lzxzl.github.io/post/cve-2021-39623-media-libstagefright-heap-oob-write/&sharesource=weibo&title=CVE-2021-39623 - media - libstagefright - heap OOB Write + " - " + &pic="https://lzxzl.github.io/images/avatar.png?v=1747748455692 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://lzxzl.github.io/tag/Android-CVE/">#
                    Android-CVE
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://lzxzl.github.io/post/cve-2021-39659-telecom-java-zheng-shu-yi-chu/">
                                                                                            CVE-2021-39659 - telecom - Java整数溢出
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://lzxzl.github.io/post/new_cve-2021-39632-recovery-yue-jie-xie/">
                                                                                                    CVE-2021-39632 - Recovery - 越界写
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '2a44a295dd16ae7d05b8',
        clientSecret: '8030257bc11446a193cf383767567daca0e26312',
        repo: 'lzxzl.github.io',
        owner: 'lzxzl',
        admin: ['lzxzl'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        ztree
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        ztree &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://lzxzl.github.io/" target="_blank">
                                                ztree
                                            </a>
            </div>
            <div id="update" style="display:none;">
                off
            </div>
            
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
                <script>
                    
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    var newDate = new Date();
                    newDate.setTime(1747748455692);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>