<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    ztree
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://fastly.jsdelivr.net">
<meta name="author" content="ztree">
<meta name="description" content="ç«¹æ–èŠ’é‹è½»èƒœé©¬ï¼Œè°æ€•ï¼Ÿä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿã€‚">
<meta name="keywords" content="Binary">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://lzxzl.github.io/styles/main.css" />
<link href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://fastly.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://fastly.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                        <!--CDNæ ·å¼-->
                        <script src="https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://lzxzl.github.io">
                    ztree
                </a>
            </div>
            <div id="tp-weather-widget"></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        é¦–é¡µ
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        å½’æ¡£
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        æ ‡ç­¾
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        å…³äº
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://lzxzl.github.io">
                            ztree
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1747748455692" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            é¦–é¡µ
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            å½’æ¡£
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            æ ‡ç­¾
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            å…³äº
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>



    <script>
        (function(a, h, g, f, e, d, c, b) {
            b = function() {
                d = h.createElement(g);
                c = h.getElementsByTagName(g)[0];
                d.src = e;
                d.charset = "utf-8";
                d.async = 1;
                c.parentNode.insertBefore(d, c)
            };
            a["SeniverseWeatherWidgetObject"] = f;
            a[f] || (a[f] = function() {
                (a[f].q = a[f].q || []).push(arguments)
            });
            a[f].l = +new Date();
            if (a.attachEvent) {
                a.attachEvent("onload", b)
            } else {
                a.addEventListener("load", b, false)
            }
        }(window, document, "script", "SeniverseWeatherWidget", "//cdn.sencdn.com/widget2/static/js/bundle.js?t=" + parseInt((new Date().getTime() / 100000000).toString(), 10)));
        window.SeniverseWeatherWidget('show', {
            flavor: "slim",
            location: "WWEFQFPJZ7T8",
            geolocation: true,
            language: "auto",
            unit: "c",
            theme: "auto",
            token: "61bcc333-3305-4728-9465-6785274bb0a3",
            hover: "enabled",
            container: "tp-weather-widget"
        })
    </script>
    
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part4.
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            ztree
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2021-11-11</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">33.8
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">7083</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">ç¼–è¯‘åŸç†</a>
                                
                            </span>
                                            
                                                é˜…è¯»é‡:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <p>Have you been passively learning the material in these articles or have you been actively practicing it? I hope youâ€™ve been actively practicing it. I really doÂ ğŸ˜ƒ</p>
<p>ä½ æ˜¯è¢«åŠ¨åœ°å­¦ä¹ è¿™äº›æ–‡ç« ä¸­çš„å†…å®¹ï¼Œè¿˜æ˜¯ä¸»åŠ¨åœ°ç»ƒä¹ ï¼Ÿæˆ‘å¸Œæœ›ä½ å·²ç»ç§¯æç»ƒä¹ è¿‡äº†ã€‚æˆ‘çœŸçš„æ˜¯è¿™ä¹ˆæƒ³çš„:)</p>
<p>Remember what ConfuciusÂ said?</p>
<p>è¿˜è®°å¾—å­”å­è¯´è¿‡ä»€ä¹ˆå—ï¼Ÿ</p>
<blockquote>
<p><em>â€œI hear and IÂ forget.â€</em></p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://ruslanspivak.com/lsbasi-part4/LSBAWS_confucius_hear.png" alt="" loading="lazy"></figure>
<blockquote>
<p><em>â€œI see and IÂ remember.â€</em></p>
</blockquote>
<figure data-type="image" tabindex="2"><img src="https://ruslanspivak.com/lsbasi-part4/LSBAWS_confucius_see.png" alt="" loading="lazy"></figure>
<blockquote>
<p><em>â€œI do and IÂ understand.â€</em></p>
</blockquote>
<figure data-type="image" tabindex="3"><img src="https://ruslanspivak.com/lsbasi-part4/LSBAWS_confucius_do.png" alt="" loading="lazy"></figure>
<blockquote>
<p>å…¶å®æ˜¯è€å­è¯´çš„ï¼šâ€œä¸é—»ä¸è‹¥é—»ä¹‹ï¼Œé—»ä¹‹ä¸è‹¥è§ä¹‹ï¼Œè§ä¹‹ä¸è‹¥çŸ¥ä¹‹ï¼ŒçŸ¥ä¹‹ä¸è‹¥è¡Œä¹‹ã€‚â€</p>
</blockquote>
<p>In the previous article you learned how to parse (recognize) and interpret arithmetic expressions with any number of plus or minus operators in them, for example â€œ7 - 3 + 2 - 1â€. You also learned about syntax diagrams and how they can be used to specify the syntax of a programmingÂ language.</p>
<p>åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•è§£æï¼ˆè¯†åˆ«ï¼‰å’Œè§£é‡Šå¸¦æœ‰ä»»æ„æ•°é‡çš„åŠ å‡è¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œä¾‹å¦‚â€œ7-3 + 2-1â€ã€‚ä½ è¿˜äº†è§£äº†è¯­æ³•ï¼ˆsyntaxï¼‰å›¾ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬æŒ‡å®šç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ã€‚</p>
<p>Today youâ€™re going to learn how to parse and interpret arithmetic expressions with any number of multiplication and division operators in them, for example â€œ7 * 4 / 2 * 3â€. The division in this article will be an integer division, so if the expression is â€œ9 / 4â€, then the answer will be an integer:Â 2.</p>
<p>ä»Šå¤©ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•è§£æå’Œè§£é‡Šå¸¦æœ‰ä»»æ„æ•°é‡ä¹˜æ³•å’Œé™¤æ³•è¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œä¾‹å¦‚â€œ7 * 4/2 * 3â€ã€‚æœ¬æ–‡ä¸­çš„é™¤æ³•æ˜¯æ•´æ•°é™¤æ³•ï¼Œå› æ­¤å¦‚æœè¡¨è¾¾å¼æ˜¯â€œ9/4â€ï¼Œé‚£ä¹ˆç­”æ¡ˆå°†æ˜¯æ•´æ•°: 2ã€‚</p>
<p>I will also talk quite a bit today about another widely used notation for specifying the syntax of a programming language. Itâ€™s called <em><strong>context-free grammars</strong></em> (<em><strong>grammars</strong></em>, for short) or <em><strong>BNF</strong></em> (Backus-Naur Form). For the purpose of this article I will not use pure <a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form">BNF</a> notation but more like a modified <a href="https://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form">EBNF</a>Â notation.</p>
<p>ä»Šå¤©æˆ‘è¿˜å°†ç›¸å½“è¯¦ç»†åœ°è®¨è®ºå¦ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç”¨äºæŒ‡å®šç¼–ç¨‹è¯­è¨€è¯­æ³•çš„ç¬¦å·ã€‚å®ƒè¢«ç§°ä¸º<strong>ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•</strong>(ç®€ç§°grammar)æˆ– BNF (Backus-Naur Form)ã€‚åŸºäºæœ¬æ–‡çš„ç›®çš„ï¼Œæˆ‘å°†ä¸ä½¿ç”¨çº¯ BNF ç¬¦å·ï¼Œè€Œæ›´åƒæ˜¯ä¸€ç§ä¿®æ”¹åçš„ EBNF ç¬¦å·ã€‚</p>
<p>Here are a couple of reasons to useÂ grammars:</p>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨grammarçš„å‡ ä¸ªåŸå› :</p>
<ol>
<li>A grammar specifies the syntax of a programming language in a concise manner. Unlike syntax diagrams, grammars are very compact. You will see me using grammars more and more in futureÂ articles.
<ul>
<li>grammarä»¥ç®€æ´çš„æ–¹å¼æŒ‡å®šäº†ç¼–ç¨‹è¯­è¨€çš„syntaxã€‚ä¸è¯­æ³•ï¼ˆsyntaxï¼‰å›¾ä¸åŒï¼Œgrammaréå¸¸ç´§å‡‘ã€‚åœ¨ä»¥åçš„æ–‡ç« ä¸­ï¼Œä½ ä¼šçœ‹åˆ°æˆ‘è¶Šæ¥è¶Šå¤šåœ°ä½¿ç”¨grammarã€‚</li>
</ul>
</li>
<li>A grammar can serve as greatÂ documentation.
<ul>
<li>grammarå¯ä»¥ä½œä¸ºå¾ˆå¥½çš„æ–‡æ¡£</li>
</ul>
</li>
<li>A grammar is a good starting point even if you manually write your parser from scratch. Quite often you can just convert the grammar to code by following a set of simpleÂ rules.
<ul>
<li>å³ä½¿ä½ ä»å¤´å¼€å§‹æ‰‹åŠ¨ç¼–å†™è§£æå™¨ï¼Œgrammarä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ åªéœ€éµå¾ªä¸€ç»„ç®€å•çš„è§„åˆ™å°±å¯ä»¥å°†grammarè½¬æ¢ä¸ºä»£ç ã€‚</li>
</ul>
</li>
<li>There is a set of tools, called <em>parser generators</em>, which accept a grammar as an input and automatically generate a parser for you based on that grammar. I will talk about those tools later on in the series.
<ul>
<li>æœ‰ä¸€ç»„åä¸ºâ€Parserç”Ÿæˆå™¨â€çš„å·¥å…·ï¼Œæ¥å—grammarä½œä¸ºè¾“å…¥ï¼Œå¹¶æ ¹æ®è¯¥grammarè‡ªåŠ¨ä¸ºæ‚¨ç”Ÿæˆè§£æå™¨ã€‚ç¨åä¼šè°ˆè®ºé‚£äº›å·¥å…·ã€‚</li>
</ul>
</li>
</ol>
<p>Now, letâ€™s talk about the mechanical aspects of grammars, shallÂ we?</p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆgrammarï¼Œå¥½å—ï¼Ÿ</p>
<p>Here is a grammar that describes arithmetic expressions like â€œ7 * 4 / 2 * 3â€ (itâ€™s just one of the many expressions that can be generated by theÂ grammar):</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæè¿°ç®—æœ¯è¡¨è¾¾å¼çš„grammarï¼Œæ¯”å¦‚â€œ7 * 4/2 * 3â€(è¿™åªæ˜¯ç”±grammarç”Ÿæˆçš„ä¼—å¤šè¡¨è¾¾å¼ä¹‹ä¸€) :</p>
<figure data-type="image" tabindex="4"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf1.png" alt="" loading="lazy"></figure>
<p>A grammar consists of a sequence of <em>rules</em>, also known as <em>productions</em>. There are two rules in ourÂ grammar:</p>
<p>grammarç”±ä¸€ç³»åˆ—çš„è§„åˆ™ï¼ˆä¹Ÿç§°ä¸º_productionsï¼ˆäº§ç”Ÿå¼ï¼‰_ï¼‰ç»„æˆã€‚æˆ‘ä»¬çš„grammaræœ‰ä¸¤ä¸ªè§„åˆ™:</p>
<figure data-type="image" tabindex="5"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf2.png" alt="" loading="lazy"></figure>
<p>A rule consists of a <em>non-terminal</em>, called the <em><strong>head</strong></em> or <em><strong>left-hand side</strong></em> of the production, a colon, and a sequence of terminals and/or non-terminals, called the <em><strong>body</strong></em> or <em><strong>right-hand side</strong></em> of theÂ production:</p>
<p>ä¸€ä¸ªè§„åˆ™ç”±ä¸€ä¸ªéç»ˆç»“ç¬¦(ç§°ä¸ºproductionçš„headæˆ–left-hand side)ã€å†’å·å’Œä¸€ç³»åˆ—ç»ˆç»“ç¬¦/éç»ˆç»“ç¬¦(ç§°ä¸ºproductionçš„bodyæˆ–right-hand side)ç»„æˆ:</p>
<figure data-type="image" tabindex="6"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf3.png" alt="" loading="lazy"></figure>
<p>In the grammar I showed above, tokens like MUL, DIV, and INTEGER are called <em><strong>terminals</strong></em> and variables like <em>expr</em> and <em>factor</em> are called <em><strong>non-terminals</strong></em>. Non-terminals usually consist of a sequence of terminals and/orÂ non-terminals:</p>
<p>åœ¨ä¸Šé¢å±•ç¤ºçš„grammarä¸­ï¼Œåƒ MULã€ DIV å’Œ INTEGER è¿™æ ·çš„tokenç§°ä¸ºç»ˆç»“ç¬¦ï¼Œåƒ expr å’Œ factor è¿™æ ·çš„å˜é‡ç§°ä¸ºéç»ˆç»“ç¬¦ã€‚éç»ˆç»“ç¬¦é€šå¸¸ç”±ä¸€ç³»åˆ—ç»ˆç»“ç¬¦å’Œæˆ–éç»ˆç»“ç¬¦ç»„æˆ:</p>
<figure data-type="image" tabindex="7"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf4.png" alt="" loading="lazy"></figure>
<p>The non-terminal symbol on the left side of the first rule is called the <em><strong>start symbol</strong></em>. In the case of our grammar, the start symbol is <em>expr</em>:</p>
<p>ç¬¬ä¸€æ¡è§„åˆ™å·¦ä¾§çš„éç»ˆç»“ç¬¦ç§°ä¸º<strong>å¼€å§‹ç¬¦å·</strong>ã€‚åœ¨æˆ‘ä»¬çš„grammarä¸­ï¼Œå¼€å§‹ç¬¦å·æ˜¯ expr:</p>
<figure data-type="image" tabindex="8"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf5.png" alt="" loading="lazy"></figure>
<p>You can read the rule <em>expr</em> as â€œAn <em>expr</em> can be a <em>factor</em> optionally followed by a <em>multiplication</em> or <em>division</em> operator followed by another <em>factor</em>, which in turn is optionally followed by a <em>multiplication</em> or <em>division</em> operator followed by another <em>factor</em> and so on and soÂ forth.â€</p>
<p>ä½ å¯ä»¥å°†è§„åˆ™ expr è§£è¯»ä¸ºâ€œ ä¸€ä¸ª expr å¯ä»¥æ˜¯ä¸€ä¸ªfactorï¼Œåé¢è·Ÿä¸€ä¸ªä¹˜æ³•æˆ–é™¤æ³•è¿ç®—ç¬¦ï¼Œç„¶åè·Ÿå¦ä¸€ä¸ªfactorï¼Œå†åé¢è·Ÿä¸€ä¸ªä¹˜æ³•æˆ–é™¤æ³•è¿ç®—ç¬¦ï¼Œå†åé¢è·Ÿå¦ä¸€ä¸ªfactorï¼Œç­‰ç­‰ã€‚â€</p>
<p>What is a <em>factor</em>? For the purpose of this article a <em>factor</em> is just anÂ integer.</p>
<p>ä»€ä¹ˆæ˜¯factor? åœ¨æœ¬æ–‡ä¸­ï¼Œfactoråªæ˜¯ä¸€ä¸ªæ•´æ•°ã€‚</p>
<p>Letâ€™s quickly go over the symbols used in the grammar and theirÂ meaning.</p>
<p>è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹grammarä¸­ä½¿ç”¨çš„ç¬¦å·åŠå…¶å«ä¹‰ã€‚</p>
<ul>
<li><strong>|</strong> - Alternatives. A bar means â€œorâ€. So (MUL | DIV) means either MUL or DIV.
<ul>
<li>äºŒé€‰ä¸€ã€‚æˆ–è€…çš„æ„æ€ï¼Œæ‰€ä»¥ï¼ˆMULï½œDIVï¼‰æ„å‘³ç€è¦ä¹ˆæ˜¯MULï¼Œè¦ä¹ˆæ˜¯DIV</li>
</ul>
</li>
<li><strong>( â€¦ )</strong> - An open and closing parentheses mean grouping of terminals and/or non-terminals as in (MUL | DIV).
<ul>
<li>å¼€æ‹¬å·å’Œé—­æ‹¬å·è¡¨ç¤ºç»ˆç»“ç¬¦ å’Œæˆ– éç»ˆç»“ç¬¦ çš„åˆ†ç»„ï¼Œå¦‚(MUL | DIV)ã€‚</li>
</ul>
</li>
<li><strong>( â€¦ )</strong>* - Match contents within the group zero or more times.
<ul>
<li>åŒ¹é…ç»„å†…çš„å†…å®¹0æ¬¡æˆ–å¤šæ¬¡</li>
</ul>
</li>
</ul>
<p>If you worked with regular expressions in the past, then the symbols <strong>|</strong>, <strong>()</strong>, and <strong>(â€¦)</strong>* should be pretty familiar toÂ you.</p>
<p>å¦‚æœä½ è¿‡å»ä½¿ç”¨è¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆç¬¦å· | ã€()å’Œ(...) * å¯¹ä½ æ¥è¯´åº”è¯¥éå¸¸ç†Ÿæ‚‰ã€‚</p>
<p>A grammar defines a <em>language</em> by explaining what sentences it can form. This is how you can <em>derive</em> an arithmetic expression using the grammar: first you begin with the start symbol <em>expr</em> and then repeatedly replace a non-terminal by the body of a rule for that non-terminal until you have generated a sentence consisting solely of terminals. Those sentences form a <em>language</em> defined by theÂ grammar.</p>
<p>grammaré€šè¿‡è§£é‡Šè¯¥è¯­è¨€å¯ä»¥æ„æˆä»€ä¹ˆæ ·çš„å¥å­æ¥å®šä¹‰ä¸€ç§è¯­è¨€ã€‚è¿™å°±æ˜¯ä½¿ç”¨grammaræ´¾ç”Ÿç®—æœ¯è¡¨è¾¾å¼çš„æ–¹æ³•: é¦–å…ˆä»å¼€å§‹ç¬¦å· expr å¼€å§‹ï¼Œç„¶åç”¨è¯¥éç»ˆç»“ç¬¦çš„è§„åˆ™bodyé‡å¤æ›¿æ¢éç»ˆç»“ç¬¦ï¼Œç›´åˆ°ç”Ÿæˆå®Œå…¨ç”±ç»ˆç»“ç¬¦ç»„æˆçš„å¥å­ã€‚è¿™äº›å¥å­æ„æˆäº†ç”±grammarå®šä¹‰çš„è¯­è¨€ã€‚</p>
<p>If the grammar cannot derive a certain arithmetic expression, then it doesnâ€™t support that expression and the parser will generate a syntax error when it tries to recognize theÂ expression.</p>
<p>å¦‚æœgrammaræ— æ³•æ´¾ç”Ÿå‡ºæŸä¸ªç®—æœ¯è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ”¯æŒè¯¥è¡¨è¾¾å¼ï¼Œè§£æå™¨åœ¨å°è¯•è¯†åˆ«è¯¥è¡¨è¾¾å¼æ—¶å°†äº§ç”Ÿè¯­æ³•é”™è¯¯ã€‚</p>
<p>I think a couple of examples are in order. This is how the grammar derives the expression <em>3</em>:</p>
<p>æˆ‘è®¤ä¸ºä¸¾å‡ ä¸ªä¾‹å­æ˜¯åˆç†çš„ã€‚<br>
è¿™æ˜¯grammarå¦‚ä½•æ´¾ç”Ÿè¡¨è¾¾å¼3:</p>
<figure data-type="image" tabindex="9"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_derive1.png" alt="" loading="lazy"></figure>
<p>This is how the grammar derives the expression <em>3 * 7</em>:</p>
<p>è¿™æ˜¯è¯­æ³•å¦‚ä½•æ´¾ç”Ÿè¡¨è¾¾å¼3 * 7:</p>
<figure data-type="image" tabindex="10"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_derive2.png" alt="" loading="lazy"></figure>
<p>And this is how the grammar derives the expression <em>3 * 7 / 2</em>:</p>
<p>è¿™æ˜¯è¯­æ³•å¦‚ä½•æ´¾ç”Ÿè¡¨è¾¾å¼3 * 7/2:</p>
<figure data-type="image" tabindex="11"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_derive3.png" alt="" loading="lazy"></figure>
<p>Whoa, quite a bit of theory rightÂ there!</p>
<p>å“‡ï¼ŒçœŸæ˜¯ä¸€å¤§å †ç†è®ºï¼</p>
<p>I think when I first read about grammars, the related terminology, and all that jazz, I felt something likeÂ this:</p>
<p>æˆ‘æƒ³å½“æˆ‘ç¬¬ä¸€æ¬¡è¯»åˆ°grammarï¼Œç›¸å…³çš„æœ¯è¯­ï¼Œä»¥åŠæ‰€æœ‰çš„jazzçš„æ—¶å€™ï¼Œæˆ‘çš„æ„Ÿè§‰æ˜¯è¿™æ ·çš„:</p>
<figure data-type="image" tabindex="12"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf_hmm.png" alt="" loading="lazy"></figure>
<p>I can assure you that I definitely was not likeÂ this:</p>
<p>æˆ‘å¯ä»¥å‘ä½ ä¿è¯ï¼Œæˆ‘ç»å¯¹ä¸æ˜¯è¿™æ ·çš„:</p>
<figure data-type="image" tabindex="13"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf_yes.png" alt="" loading="lazy"></figure>
<p>It took me some time to get comfortable with the notation, how it works, and its relationship with parsers and lexers, but I have to tell you that it pays to learn it in the long run because itâ€™s so widely used in practice and compiler literature that youâ€™re bound to run into it at some point. So, why not sooner rather than later?Â ğŸ˜ƒ</p>
<p>æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´æ¥ç†Ÿæ‚‰è¿™ä¸ªç¬¦å·ï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå®ƒä¸è¯­æ³•åˆ†æå™¨å’Œè¯æ³•åˆ†æå™¨çš„å…³ç³»ï¼Œä½†æˆ‘å¿…é¡»å‘Šè¯‰ä½ ï¼Œä»é•¿è¿œæ¥çœ‹ï¼Œå­¦ä¹ å®ƒæ˜¯å€¼å¾—çš„ï¼Œå› ä¸ºå®ƒåœ¨å®è·µå’Œç¼–è¯‘æ–‡çŒ®ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½ åœ¨æŸä¸ªæ—¶å€™ä¸€å®šä¼šé‡åˆ°å®ƒã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸æ—©ä¸€ç‚¹è€Œä¸æ˜¯æ™šä¸€ç‚¹å‘¢ï¼ŸğŸ˜ƒ</p>
<p>Now, letâ€™s map that grammar to code,Â okay?</p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æŠŠgrammaræ˜ å°„åˆ°ä»£ç ä¸­ï¼Œå¥½å—ï¼Ÿ</p>
<p>Here are the guidelines that we will use to convert the grammar to source code. By following them, you can literally translate the grammar to a workingÂ parser:</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬å°†ç”¨æ¥å°†gramarè½¬æ¢ä¸ºæºä»£ç çš„æŒ‡å¯¼åŸåˆ™ã€‚é€šè¿‡è·Ÿéšå®ƒä»¬ï¼Œä½ å¯ä»¥é€å­—åœ°å°†grammarç¿»è¯‘æˆä¸€ä¸ªå¯ä»¥å·¥ä½œçš„è§£æå™¨:</p>
<ol>
<li>Each rule, <strong>R</strong>, defined in the grammar, becomes a method with the same name, and references to that rule become a method call: <em><strong>R()</strong></em>. The body of the method follows the flow of the body of the rule using the very same guidelines.
<ul>
<li>åœ¨grammarä¸­å®šä¹‰çš„æ¯ä¸ª<strong>è§„åˆ™R</strong>éƒ½æˆä¸ºä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„<strong>æ–¹æ³•</strong>ï¼Œä»¥åŠ<strong>å¯¹è¯¥è§„åˆ™çš„å¼•ç”¨</strong>æˆä¸º<strong>æ–¹æ³•è°ƒç”¨</strong>ï¼šRï¼ˆï¼‰ã€‚è¯¥æ–¹æ³•çš„æ–¹æ³•ä½“ï¼ˆå³å‡½æ•°å†…å®¹ï¼‰ä½¿ç”¨ç›¸åŒçš„æŒ‡å¯¼åŸåˆ™å»å˜æ¢è§„åˆ™ï¼ˆäº§ç”Ÿå¼ï¼‰çš„bodyã€‚</li>
</ul>
</li>
<li>Alternatives <strong>(a1 | a2 | aN)</strong> become an <em><strong>if-elif-else</strong></em> statement
<ul>
<li>æˆ–ï¼ˆAlternativesï¼‰ å˜æˆä¸€ä¸ª if-elif-elseè¯­å¥</li>
</ul>
</li>
<li>An optional grouping <strong>(â€¦)</strong>* becomes a <em><strong>while</strong></em> statement that can loop over zero or more times
<ul>
<li>ä¸€ä¸ªå¯é€‰ç»„**(...)***å˜æˆä¸€ä¸ªå¯å¾ªç¯0æ¬¡æˆ–å¤šæ¬¡çš„whileè¯­å¥</li>
</ul>
</li>
<li>Each token reference <strong>T</strong> becomes a call to the method <em><strong>eat</strong></em>: <em><strong>eat(T)</strong></em>. The way the <em>eat</em> method works is that it consumes the token <em>T</em> if it matches the current <em>lookahead</em> token, then it gets a new token from the lexer and assigns that token to the <em>current_token</em> internal variable.
<ul>
<li>æ¯ä¸ªtokenå¼•ç”¨Téƒ½æˆä¸ºå¯¹æ–¹æ³•eat: eat(T)çš„è°ƒç”¨ã€‚eatæ–¹æ³•çš„å·¥ä½œæ–¹å¼æ˜¯ï¼šå¦‚æœtoken Tçš„ç±»å‹ä¸å½“å‰å†…éƒ¨å˜é‡current_tokençš„ç±»å‹ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå®ƒå°†åƒæ‰token Tï¼Œç„¶åä»lexerè·å¾—ä¸€ä¸ªæ–°tokenï¼Œå¹¶å°†è¯¥tokenåˆ†é…ç»™current_tokenã€‚</li>
</ul>
</li>
</ol>
<p>Visually the guidelines look likeÂ this:</p>
<p>è§†è§‰ä¸Šçš„æŒ‡å¯¼åŸåˆ™æ˜¯è¿™æ ·çš„:</p>
<figure data-type="image" tabindex="14"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_rules.png" alt="" loading="lazy"></figure>
<p>Letâ€™s get moving and convert our grammar to code following the aboveÂ guidelines.</p>
<p>è®©æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„æŒ‡å¯¼æ–¹é’ˆï¼Œå°†grammarè½¬æ¢ä¸ºä»£ç ã€‚</p>
<p>There are two rules in our grammar: one <em>expr</em> rule and one <em>factor</em> rule. Letâ€™s start with the <em>factor</em> rule (production). According to the guidelines, you need to create a method called <em>factor</em> (guideline 1) that has a single call to the <em>eat</em> method to consume the INTEGER token (guidelineÂ 4):</p>
<p>æˆ‘ä»¬çš„grammarä¸­æœ‰ä¸¤ä¸ªè§„: ä¸€ä¸ª expr è§„åˆ™å’Œä¸€ä¸ªfactorè§„åˆ™ã€‚è®©æˆ‘ä»¬ä»factorè§„åˆ™ï¼ˆäº§ç”Ÿå¼productionï¼‰å¼€å§‹ã€‚æ ¹æ®æŒ‡å¯¼åŸåˆ™ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º factor ï¼ˆæŒ‡å¯¼åŸåˆ™1ï¼‰çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åªè°ƒç”¨ eat æ–¹æ³•æ¥ä½¿ç”¨ INTEGER æ ‡è®°ï¼ˆæŒ‡å¯¼åŸåˆ™4ï¼‰ :</p>
<pre><code class="language-python">def factor(self):
    self.eat(INTEGER)
</code></pre>
<p>That was easy, wasnâ€™tÂ it?</p>
<p>è¿™å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿ</p>
<p>Onward!</p>
<p>å‰è¿›ï¼</p>
<p>The rule <em>expr</em> becomes the <em>expr</em> method (again according to the guideline 1). The body of the rule starts with a reference to <em>factor</em> that becomes a <em>factor()</em> method call. The optional grouping <em>(â€¦)*</em> becomes a <em>while</em> loop and <em>(MUL | DIV)</em> alternatives become an <em>if-elif-else</em> statement. By combining those pieces together we get the following <em>expr</em>Â method:</p>
<p>è§„åˆ™ expr æˆä¸º expr æ–¹æ³•(æ ¹æ®æŒ‡å¯¼åŸåˆ™1)ã€‚è§„åˆ™ä½“ä»¥å¯¹ factor çš„å¼•ç”¨å¼€å§‹ï¼Œé‚£ä¹ˆexpræ–¹æ³•ä»¥è°ƒç”¨factor()å¼€å§‹ã€‚å¯é€‰çš„åˆ†ç»„(...) * å˜æˆ while å¾ªç¯ï¼Œ(MUL | DIV)æ›¿ä»£é¡¹å˜æˆ if-elif-else è¯­å¥ã€‚é€šè¿‡å°†è¿™äº›ç‰‡æ®µç»„åˆåœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸‹é¢çš„ expr æ–¹æ³•:</p>
<pre><code class="language-python">def expr(self):
    self.factor()

    while self.current_token.type in (MUL, DIV):
        token = self.current_token
        if token.type == MUL:
            self.eat(MUL)
            self.factor()
        elif token.type == DIV:
            self.eat(DIV)
            self.factor()
</code></pre>
<p>Please spend some time and study how I mapped the grammar to the source code. Make sure you understand that part because itâ€™ll come in handy laterÂ on.</p>
<p>è¯·èŠ±äº›æ—¶é—´ç ”ç©¶ä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•å°†grammaræ˜ å°„åˆ°æºä»£ç çš„ã€‚ç¡®ä¿ä½ ç†è§£äº†è¿™ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒè¿Ÿæ—©ä¼šæ´¾ä¸Šç”¨åœºã€‚</p>
<p>For your convenience I put the above code into the <em>parser.py</em> file that contains a lexer and a parser without an interpreter. You can download the file directly from <a href="https://github.com/rspivak/lsbasi/blob/master/part4/parser.py">GitHub</a> and play with it. It has an interactive prompt where you can enter expressions and see if they are valid: that is, if the parser built according to the grammar can recognize theÂ expressions.</p>
<p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘å°†ä¸Šé¢çš„ä»£ç æ”¾åˆ° parser.py æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶åŒ…å«ä¸€ä¸ª lexer å’Œä¸€ä¸ªä¸å¸¦è§£é‡Šå™¨çš„è§£æå™¨ã€‚ä½ å¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½è¿™ä¸ªæ–‡ä»¶å¹¶ä½¿ç”¨å®ƒã€‚å®ƒæœ‰ä¸€ä¸ªäº¤äº’å¼æç¤ºç¬¦ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥è¡¨è¾¾å¼å¹¶æŸ¥çœ‹å®ƒä»¬æ˜¯å¦æœ‰æ•ˆï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ ¹æ®grammaræ„å»ºçš„è§£æå™¨èƒ½å¤Ÿè¯†åˆ«è¡¨è¾¾å¼ã€‚</p>
<p>Here is a sample session that I ran on myÂ computer:</p>
<p>ä¸‹é¢æ˜¯æˆ‘åœ¨ç”µè„‘ä¸Šè¿è¡Œçš„ä¸€ä¸ªä¾‹å­:</p>
<pre><code class="language-python">$ python parser.py
calc&gt; 3
calc&gt; 3 * 7
calc&gt; 3 * 7 / 2
calc&gt; 3 *
Traceback (most recent call last):
  File &quot;parser.py&quot;, line 155, in &lt;module&gt;
    main()
  File &quot;parser.py&quot;, line 151, in main
    parser.parse()
  File &quot;parser.py&quot;, line 136, in parse
    self.expr()
  File &quot;parser.py&quot;, line 130, in expr
    self.factor()
  File &quot;parser.py&quot;, line 114, in factor
    self.eat(INTEGER)
  File &quot;parser.py&quot;, line 107, in eat
    self.error()
  File &quot;parser.py&quot;, line 97, in error
    raise Exception('Invalid syntax')
Exception: Invalid syntax
</code></pre>
<p>Try itÂ out!</p>
<p>è¯•è¯•å§ï¼</p>
<p>I couldnâ€™t help but mention syntax diagrams again. This is how a syntax diagram for the same <em>expr</em> rule willÂ look:</p>
<p>æˆ‘å¿ä¸ä½åˆæåˆ°äº†è¯­æ³•ï¼ˆsyntaxï¼‰å›¾ã€‚ä¸‹é¢æ˜¯åŒä¸€ä¸ª expr è§„åˆ™çš„è¯­æ³•å›¾:</p>
<figure data-type="image" tabindex="15"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_sd.png" alt="" loading="lazy"></figure>
<p>Itâ€™s about time we dug into the source code of our new arithmetic expression interpreter. Below is the code of a calculator that can handle valid arithmetic expressions containing integers and any number of multiplication and division (integer division) operators. You can also see that I refactored the lexical analyzer into a separate class <em>Lexer</em> and updated the <em>Interpreter</em> class to take the <em>Lexer</em> instance as aÂ parameter:</p>
<p>æ˜¯æ—¶å€™æ·±å…¥ç ”ç©¶æˆ‘ä»¬æ–°çš„ç®—æœ¯è¡¨è¾¾å¼è§£é‡Šå™¨çš„æºä»£ç äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè®¡ç®—å™¨çš„ä»£ç ï¼Œå®ƒå¯ä»¥å¤„ç†åŒ…å«æ•´æ•°å’Œä»»æ„æ•°é‡çš„ä¹˜æ³•å’Œé™¤æ³•ï¼ˆæ•´æ•°é™¤æ³•ï¼‰è¿ç®—ç¬¦çš„æœ‰æ•ˆç®—æœ¯è¡¨è¾¾å¼ã€‚ä½ è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å°†è¯æ³•åˆ†æå™¨é‡æ„ä¸ºä¸€ä¸ªå•ç‹¬çš„ç±» Lexerï¼Œå¹¶æ›´æ–°äº† Interpreter ç±»ï¼Œå°† Lexer å®ä¾‹ä½œä¸ºå‚æ•°:</p>
<pre><code class="language-python"># Token types
#
# EOF (end-of-file) token is used to indicate that
# there is no more input left for lexical analysis
INTEGER, MUL, DIV, EOF = 'INTEGER', 'MUL', 'DIV', 'EOF'


class Token(object):
    def __init__(self, type, value):
        # token type: INTEGER, MUL, DIV, or EOF
        self.type = type
        # token value: non-negative integer value, '*', '/', or None
        self.value = value

    def __str__(self):
        &quot;&quot;&quot;String representation of the class instance.

        Examples:
            Token(INTEGER, 3)
            Token(MUL, '*')
        &quot;&quot;&quot;
        return 'Token({type}, {value})'.format(
            type=self.type,
            value=repr(self.value)
        )

    def __repr__(self):
        return self.__str__()


class Lexer(object):
    def __init__(self, text):
        # client string input, e.g. &quot;3 * 5&quot;, &quot;12 / 3 * 4&quot;, etc
        self.text = text
        # self.pos is an index into self.text
        self.pos = 0
        self.current_char = self.text[self.pos]

    def error(self):
        raise Exception('Invalid character')

    def advance(self):
        &quot;&quot;&quot;Advance the `pos` pointer and set the `current_char` variable.&quot;&quot;&quot;
        self.pos += 1
        if self.pos &gt; len(self.text) - 1:
            self.current_char = None  # Indicates end of input
        else:
            self.current_char = self.text[self.pos]

    def skip_whitespace(self):
        while self.current_char is not None and self.current_char.isspace():
            self.advance()

    def integer(self):
        &quot;&quot;&quot;Return a (multidigit) integer consumed from the input.&quot;&quot;&quot;
        result = ''
        while self.current_char is not None and self.current_char.isdigit():
            result += self.current_char
            self.advance()
        return int(result)

    def get_next_token(self):
        &quot;&quot;&quot;Lexical analyzer (also known as scanner or tokenizer)

        This method is responsible for breaking a sentence
        apart into tokens. One token at a time.
        &quot;&quot;&quot;
        while self.current_char is not None:

            if self.current_char.isspace():
                self.skip_whitespace()
                continue

            if self.current_char.isdigit():
                return Token(INTEGER, self.integer())

            if self.current_char == '*':
                self.advance()
                return Token(MUL, '*')

            if self.current_char == '/':
                self.advance()
                return Token(DIV, '/')

            self.error()

        return Token(EOF, None)


class Interpreter(object):
    def __init__(self, lexer):
        self.lexer = lexer
        # set current token to the first token taken from the input
        self.current_token = self.lexer.get_next_token()

    def error(self):
        raise Exception('Invalid syntax')

    def eat(self, token_type):
        # compare the current token type with the passed token
        # type and if they match then &quot;eat&quot; the current token
        # and assign the next token to the self.current_token,
        # otherwise raise an exception.
        if self.current_token.type == token_type:
            self.current_token = self.lexer.get_next_token()
        else:
            self.error()

    def factor(self):
        &quot;&quot;&quot;Return an INTEGER token value.

        factor : INTEGER
        &quot;&quot;&quot;
        token = self.current_token
        self.eat(INTEGER)
        return token.value

    def expr(self):
        &quot;&quot;&quot;Arithmetic expression parser / interpreter.

        expr   : factor ((MUL | DIV) factor)*
        factor : INTEGER
        &quot;&quot;&quot;
        result = self.factor()

        while self.current_token.type in (MUL, DIV):
            token = self.current_token
            if token.type == MUL:
                self.eat(MUL)
                result = result * self.factor()
            elif token.type == DIV:
                self.eat(DIV)
                result = result // self.factor()

        return result


def main():
    while True:
        try:
            text = input('calc&gt; ')
        except EOFError:
            break
        if not text:
            continue
        lexer = Lexer(text)
        interpreter = Interpreter(lexer)
        result = interpreter.expr()
        print(result)


if __name__ == '__main__':
    main()

</code></pre>
<p>Save the above code into the <em>calc4.py</em> file or download it directly from <a href="https://github.com/rspivak/lsbasi/blob/master/part4/calc4.py">GitHub</a>. As usual, try it out and see for yourself that itÂ works.</p>
<p>å°†ä¸Šé¢çš„ä»£ç ä¿å­˜åˆ° calc4.py æ–‡ä»¶ä¸­ï¼Œæˆ–è€…ç›´æ¥ä» GitHub ä¸‹è½½ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œå°è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦æœ‰æ•ˆã€‚</p>
<p>This is a sample session that I ran on myÂ laptop:</p>
<p>è¿™æ˜¯æˆ‘åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šè¿è¡Œçš„ä¸€ä¸ªç¤ºä¾‹ä¼šè¯:</p>
<pre><code class="language-python">$ python calc4.py
calc&gt; 7 * 4 / 2
14
calc&gt; 7 * 4 / 2 * 3
42
calc&gt; 10 * 4  * 2 * 3 / 8
30
</code></pre>
<p>I know you couldnâ€™t wait for this part ğŸ˜ƒ Here are new exercises forÂ today:</p>
<p>æˆ‘çŸ¥é“ä½ å·²ç»è¿«ä¸åŠå¾…äº†:)è¿™é‡Œæ˜¯ä»Šå¤©çš„æ–°ç»ƒä¹ :</p>
<figure data-type="image" tabindex="16"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_exercises.png" alt="" loading="lazy"></figure>
<ul>
<li>Write a grammar that describes arithmetic expressions containing any number of +, -, *, or / operators. With the grammar you should be able to derive expressions like â€œ2 + 7 * 4â€, â€œ7 - 8 / 4â€, â€œ14 + 2 * 3 - 6 / 2â€, and soÂ on.
<ul>
<li>ç¼–å†™ä¸€ç§ grammarï¼Œæè¿°åŒ…å«ä»»æ„æ•°é‡çš„ + ã€-ã€ * æˆ–/è¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ã€‚ä½¿ç”¨è¿™ç§è¯­æ³•ï¼Œä½ åº”è¯¥èƒ½å¤Ÿæ´¾ç”Ÿå‡ºâ€œ2 + 7 * 4â€ã€â€œ7-8/4â€ã€â€œ14 + 2 * 3-6/2â€ç­‰è¡¨è¾¾å¼</li>
</ul>
</li>
<li>Using the grammar, write an interpreter that can evaluate arithmetic expressions containing any number of +, -, *, or / operators. Your interpreter should be able to handle expressions like â€œ2 + 7 * 4â€, â€œ7 - 8 / 4â€, â€œ14 + 2 * 3 - 6 / 2â€, and soÂ on.
<ul>
<li>ä½¿ç”¨grammarï¼Œç¼–å†™ä¸€ä¸ªè§£é‡Šå™¨ï¼Œå®ƒå¯ä»¥è®¡ç®—åŒ…å«ä»»æ„æ•°é‡çš„ + ã€-ã€ * æˆ–/è¿ç®—ç¬¦çš„ç®—æœ¯è¡¨è¾¾å¼ã€‚ä½ çš„è§£é‡Šå™¨åº”è¯¥èƒ½å¤Ÿå¤„ç†â€œ2 + 7 * 4â€ã€â€œ7-8/4â€ã€â€œ14 + 2 * 3-6/2â€ç­‰è¡¨è¾¾å¼</li>
</ul>
</li>
<li>If youâ€™ve finished the above exercises, relax and enjoyÂ ğŸ˜ƒ å¦‚æœä½ å·²ç»å®Œæˆäº†ä¸Šé¢çš„ç»ƒä¹ ï¼Œæ”¾æ¾å¹¶ä¸”äº«å—:)</li>
</ul>
<p>æˆ‘çš„ç­”æ¡ˆï¼ˆé˜…è¯»å®Œpart5æ–‡å­—ä¹‹åå†™çš„ï¼‰ï¼š</p>
<pre><code class="language-python">expr : term ((PLUS|MINUS)term)*
term : factor ((MUL|DIV)factor)*
factor : INTEGER
</code></pre>
<pre><code class="language-python"># Token types
#
# EOF (end-of-file) token is used to indicate that
# there is no more input left for lexical analysis
INTEGER, MUL, DIV,PLUS, MINUS, EOF = 'INTEGER', 'MUL', 'DIV', 'PLUS','MINUS','EOF'


class Token(object):
    def __init__(self, type, value):
        # token type: INTEGER, MUL, DIV, or EOF
        self.type = type
        # token value: non-negative integer value, '*', '/', or None
        self.value = value

    def __str__(self):
        &quot;&quot;&quot;String representation of the class instance.

        Examples:
            Token(INTEGER, 3)
            Token(MUL, '*')
        &quot;&quot;&quot;
        return 'Token({type}, {value})'.format(
            type=self.type,
            value=repr(self.value)
        )

    def __repr__(self):
        return self.__str__()


class Lexer(object):
    def __init__(self, text):
        # client string input, e.g. &quot;3 * 5&quot;, &quot;12 / 3 * 4&quot;, etc
        self.text = text
        # self.pos is an index into self.text
        self.pos = 0
        self.current_char = self.text[self.pos]

    def error(self):
        raise Exception('Invalid character')

    def advance(self):
        &quot;&quot;&quot;Advance the `pos` pointer and set the `current_char` variable.&quot;&quot;&quot;
        self.pos += 1
        if self.pos &gt; len(self.text) - 1:
            self.current_char = None  # Indicates end of input
        else:
            self.current_char = self.text[self.pos]

    def skip_whitespace(self):
        while self.current_char is not None and self.current_char.isspace():
            self.advance()

    def integer(self):
        &quot;&quot;&quot;Return a (multidigit) integer consumed from the input.&quot;&quot;&quot;
        result = ''
        while self.current_char is not None and self.current_char.isdigit():
            result += self.current_char
            self.advance()
        return int(result)

    def get_next_token(self):
        &quot;&quot;&quot;Lexical analyzer (also known as scanner or tokenizer)

        This method is responsible for breaking a sentence
        apart into tokens. One token at a time.
        &quot;&quot;&quot;
        while self.current_char is not None:

            if self.current_char.isspace():
                self.skip_whitespace()
                continue

            if self.current_char.isdigit():
                return Token(INTEGER, self.integer())
            
            if self.current_char == '+':
                self.advance()
                return Token(PLUS,'+')
            if self.current_char == '-':
                self.advance()
                return Token(MINUS,'-')

            if self.current_char == '*':
                self.advance()
                return Token(MUL, '*')

            if self.current_char == '/':
                self.advance()
                return Token(DIV, '/')

            self.error()

        return Token(EOF, None)


class Interpreter(object):
    def __init__(self, lexer):
        self.lexer = lexer
        # set current token to the first token taken from the input
        self.current_token = self.lexer.get_next_token()

    def error(self):
        raise Exception('Invalid syntax')

    def eat(self, token_type):
        # compare the current token type with the passed token
        # type and if they match then &quot;eat&quot; the current token
        # and assign the next token to the self.current_token,
        # otherwise raise an exception.
        if self.current_token.type == token_type:
            self.current_token = self.lexer.get_next_token()
        else:
            self.error()

    def factor(self):
        &quot;&quot;&quot;Return an INTEGER token value.

        factor : INTEGER
        &quot;&quot;&quot;
        token = self.current_token
        self.eat(INTEGER)
        return token.value

    def term(self):
        result = self.factor()

        while self.current_token.type in (MUL, DIV):
            token = self.current_token
            if token.type == MUL:
                self.eat(MUL)
                result = result * self.factor()
            elif token.type == DIV:
                self.eat(DIV)
                result = result // self.factor()

        return result

    def expr(self):
        &quot;&quot;&quot;Arithmetic expression parser / interpreter.

        expr   : factor ((MUL | DIV) factor)*
        factor : INTEGER
        &quot;&quot;&quot;
        result = self.term()

        while self.current_token.type in (PLUS, MINUS):
            token = self.current_token
            if token.type == PLUS:
                self.eat(PLUS)
                result = result + self.term()
            elif token.type == MINUS:
                self.eat(MINUS)
                result = result - self.term()
            
        return result

def main():
    while True:
        try:
            text = input('calc&gt; ')
        except EOFError:
            break
        if not text:
            continue
        lexer = Lexer(text)
        interpreter = Interpreter(lexer)
        result = interpreter.expr()
        print(result)


if __name__ == '__main__':
    main()

</code></pre>
<p><strong>Check yourÂ understanding.</strong></p>
<p>æ£€æŸ¥ä½ çš„ç†è§£ã€‚</p>
<p>Keeping in mind the grammar from todayâ€™s article, answer the following questions, referring to the picture below asÂ needed:</p>
<p>è®°ä½ä»Šå¤©æ–‡ç« çš„grammarï¼Œå›ç­”ä»¥ä¸‹é—®é¢˜ï¼Œæ ¹æ®éœ€è¦å‚è€ƒä¸‹é¢çš„å›¾ç‰‡:</p>
<figure data-type="image" tabindex="17"><img src="https://ruslanspivak.com/lsbasi-part4/lsbasi_part4_bnf1.png" alt="" loading="lazy"></figure>
<ol>
<li>What is a context-free grammarÂ (grammar)? ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ï¼Ÿ</li>
</ol>
<blockquote></blockquote>
<blockquote></blockquote>
<blockquote>
<p>åº”è¯¥å¦‚ä½•ç†è§£ã€Œä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ã€ï¼Ÿ - Towserçš„å›ç­” - çŸ¥ä¹ https://www.zhihu.com/question/21833944/answer/307309365<br>
â€‹</p>
</blockquote>
<blockquote>
<p><a href="https://www.zhihu.com/people/630612ff80641e9ec165af192743a792">@å¾è¾°</a> å›ç­”çš„ç‰¹åˆ«å¥½ã€‚<br>
é¢˜ä¸»çš„ä¸»è¦ç–‘æƒ‘åº”è¯¥åœ¨äºï¼šä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡ï¼Œä¸Šä¸‹æ–‡åœ¨å“ªé‡Œï¼Ÿä¸ºä»€ä¹ˆè¯´è¿™ä¸ªæ–‡æ³•ä¸Šä¸‹æ–‡æ— å…³ï¼Ÿ<br>
ç­”æ¡ˆå°±æ˜¯ï¼šåœ¨åº”ç”¨ä¸€ä¸ªäº§ç”Ÿå¼è¿›è¡Œæ¨å¯¼æ—¶ï¼Œå‰åå·²ç»æ¨å¯¼å‡ºçš„éƒ¨åˆ†ç»“æœå°±æ˜¯ä¸Šä¸‹æ–‡ã€‚ä¸Šä¸‹æ–‡æ— å…³çš„æ„æ€çš„ï¼Œåªè¦æ–‡æ³•çš„å®šä¹‰é‡Œæœ‰æŸä¸ªäº§ç”Ÿå¼ï¼Œä¸ç®¡ä¸€ä¸ªéç»ˆç»“ç¬¦å‰åçš„ä¸²æ˜¯ä»€ä¹ˆï¼Œå°±å¯ä»¥åº”ç”¨ç›¸åº”çš„äº§ç”Ÿå¼è¿›è¡Œæ¨å¯¼ã€‚ï¼ˆä»å½¢å¼ä¸Šæ¥çœ‹ï¼Œå°±æ˜¯äº§ç”Ÿå¼çš„å·¦è¾¹éƒ½æ˜¯å•ç‹¬ä¸€ä¸ªéç»ˆç»“ç¬¦ï¼Œå³å½¢å¦‚ S-&gt; ...ï¼Œè€Œä¸æ˜¯éç»ˆç»“ç¬¦å·¦å³è¿˜æœ‰åˆ«çš„ä¸œè¥¿ï¼Œä¾‹å¦‚ aSb -&gt; ...ï¼‰</p>
</blockquote>
<blockquote>
<p>è¿™ä¹ˆæè¿°æœ‰ç‚¹å„¿æŠ½è±¡ï¼Œæˆ‘ä¸¾ä¸€ä¸ªè‡ªç„¶è¯­è¨€çš„ä¾‹å­ï¼š<br>
<strong>ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ï¼š</strong><br>
äº§ç”Ÿå¼ï¼š<br>
Sent -&gt; S V O<br>
S -&gt; äºº | å¤©<br>
V -&gt; åƒ | ä¸‹<br>
O -&gt; é›¨ | é›ª | é¥­ | è‚‰</p>
</blockquote>
<blockquote>
<p>å…¶ä¸­è‹±æ–‡å­—æ¯éƒ½æ˜¯éç»ˆç»“ç¬¦ï¼ˆSVO åˆ†åˆ«è¡¨ç¤ºä¸»è°“å®¾ï¼‰ï¼Œæ±‰å­—éƒ½æ˜¯ç»ˆç»“ç¬¦ã€‚<br>
è¿™ä¸ªæ–‡æ³•å¯ä»¥ç”Ÿæˆå¦‚ä¸‹å¥å­ï¼ˆå…± 2<em>2</em>4=16 ç§ç»„åˆï¼Œæ‡’å¾—å†™å…¨äº†ï¼Œç®€å•å†™ 7 ç§æ„æ€æ„æ€ï¼‰ï¼š<br>
ï½›äººåƒé¥­ï¼Œå¤©ä¸‹é›¨ï¼Œäººåƒè‚‰ï¼Œå¤©ä¸‹é›ªï¼Œäººä¸‹é›ªï¼Œå¤©ä¸‹é¥­ï¼Œå¤©åƒè‚‰ï¼Œâ€¦â€¦ï½<br>
å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­æœ‰ä¸€äº›æ­é…åœ¨è¯­ä¹‰ä¸Šæ˜¯ä¸æ°å½“çš„ï¼Œä¾‹å¦‚â€œå¤©åƒè‚‰â€ã€‚å…¶ï¼ˆæœ€å·¦ï¼‰æ¨å¯¼è¿‡ç¨‹ä¸ºï¼š<br>
Sent -&gt; SVO -&gt; å¤©VO -&gt; å¤©åƒO -&gt; å¤©åƒè‚‰<br>
ä½†æ˜¯ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•é‡Œï¼Œå› ä¸ºæœ‰â€œV -&gt; åƒ | ä¸‹â€è¿™æ ·ä¸€æ¡äº§ç”Ÿå¼ï¼ŒV å°±æ°¸è¿œéƒ½å¯ä»¥æ¨å‡ºâ€œåƒâ€è¿™ä¸ªè¯ï¼Œå®ƒå¹¶ä¸åœ¨ä¹åº”ç”¨â€œV -&gt; åƒ | ä¸‹â€è¿™ä¸ªäº§ç”Ÿå¼è¿›è¡Œæ¨å¯¼æ—¶ V æ‰€åœ¨çš„ä¸Šä¸‹æ–‡ï¼ˆåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œå°±æ˜¯â€å¤©VOâ€œä¸­ V å·¦å³ä¸¤è¾¹çš„å­—ç¬¦ä¸²â€å¤©â€œå’Œâ€Oâ€œï¼‰ã€‚äº‹å®ä¸Šï¼Œåœ¨ V æ¨å‡ºâ€œåƒâ€è¿™ä¸€æ­¥ï¼Œå®ƒçš„å·¦è¾¹æ˜¯â€œå¤©â€è¿™ä¸ªè¯ï¼Œè€Œâ€å¤©â€œå’Œâ€åƒâ€œä¸æ­é…ï¼Œå¯¼è‡´æœ€åçš„å¥å­è¯»èµ·æ¥å¾ˆå¥‡æ€ªã€‚</p>
</blockquote>
<blockquote>
<p>é‚£<strong>ä¸Šä¸‹æ–‡æœ‰å…³æ–‡æ³•</strong>å‘¢ï¼Ÿäº§ç”Ÿå¼å¯ä»¥å®šä¹‰ä¸ºï¼ˆå…¶ä¸­å‰ä¸¤æ¡äº§ç”Ÿå¼ä»æ˜¯ä¸Šä¸‹æ–‡æ— å…³çš„ï¼Œåå››æ¡åˆ™æ˜¯ä¸Šä¸‹æ–‡æœ‰å…³çš„ï¼‰ï¼š<br>
Sent -&gt; S V O<br>
S -&gt; äºº | å¤©<br>
äººV -&gt; äººåƒ<br>
å¤©V -&gt; å¤©ä¸‹<br>
ä¸‹O -&gt; ä¸‹é›¨ | ä¸‹é›ª<br>
åƒO -&gt; åƒé¥­ | åƒè‚‰</p>
</blockquote>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå¯¹ V çš„æ¨å¯¼è¿‡ç¨‹æ–½åŠ äº†çº¦æŸï¼šè™½ç„¶ V è¿˜æ˜¯èƒ½æ¨å‡ºâ€åƒâ€œå’Œâ€ä¸‹â€œä¸¤ä¸ªè¯ï¼Œä½†æ˜¯ä»…ä»…å½“ V å·¦è¾¹æ˜¯â€äººâ€œæ—¶ï¼Œæ‰å…è®¸å®ƒæ¨å¯¼å‡ºâ€åƒâ€œï¼›è€Œå½“ V å·¦è¾¹æ˜¯â€å¤©â€œæ—¶ï¼Œå…è®¸å®ƒæ¨å¯¼å‡ºâ€ä¸‹â€œã€‚è¿™æ ·é€šè¿‡ä¸Šä¸‹æ–‡çš„çº¦æŸï¼Œå°±ä¿è¯äº†ä¸»è°“æ­é…çš„ä¸€è‡´æ€§ã€‚ç±»ä¼¼åœ°ï¼ŒåŒ…å« O çš„äº§ç”Ÿå¼ä¹Ÿçº¦æŸäº†åŠ¨å®¾æ­é…çš„ä¸€è‡´æ€§ã€‚<br>
è¿™æ ·ä¸€æ¥ï¼Œè¿™ä¸ªè¯­è¨€åŒ…å«çš„å¥å­å°±åªæœ‰ï½›äººåƒé¥­ï¼Œå¤©ä¸‹é›¨ï¼Œäººåƒè‚‰ï¼Œå¤©ä¸‹é›ªï½è¿™å››æ¡ï¼Œéƒ½æ˜¯è¯­ä¹‰ä¸Šåˆç†çš„ã€‚<br>
ä»¥â€äººåƒé¥­â€œä¸ºä¾‹ï¼Œæ¨å¯¼è¿‡ç¨‹ä¸ºï¼š<br>
Sent -&gt; SVO -&gt; äººVO -&gt; äººåƒO -&gt; äººåƒé¥­<br>
å…¶ä¸­ç¬¬ä¸‰æ­¥æ¨å¯¼æ˜¯è¿™æ ·çš„ï¼šéç»ˆç»“ç¬¦ V çš„ä¸Šæ–‡æ˜¯â€œäººâ€ï¼Œå› æ­¤å¯ä»¥åº”ç”¨â€œäººV -&gt; äººåƒâ€è¿™æ¡äº§ç”Ÿå¼ï¼Œå¾—åˆ°â€œäººVO -&gt; äººåƒOâ€ã€‚ç¬¬å››æ­¥ä¹Ÿç±»ä¼¼ã€‚</p>
</blockquote>
<blockquote>
<p>è€Œ <a href="https://www.zhihu.com/people/20529960b7c64153695a7488fb49aeab">@èŒƒå½¬</a> å›ç­”çš„æ˜¯è¯­æ³•çš„æ­§ä¹‰æ€§ï¼Œè¿™å’Œ CFG æ— å…³ã€‚æœ€ç®€å•çš„ä¾‹å­ï¼š<br>
å‡è®¾æœ‰å¦‚ä¸‹ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•ï¼š<br>
S -&gt; S1 | S2<br>
S1 -&gt; ab<br>
S2 -&gt; AB<br>
A -&gt; a<br>
B -&gt; b<br>
é‚£ä¹ˆå¯¹äº &quot;ab&quot; è¿™ä¸ªä¸²ï¼Œä¸€ç§æ¨å€’æ–¹å¼æ˜¯ S -&gt; S1 -&gt; abï¼Œå¦ä¸€ç§æ˜¯ S -&gt; S2 -&gt; AB -&gt; aB -&gt; abã€‚å‰ä¸€ç§è¦æŠŠ &quot;ab&quot; åˆèµ·æ¥ï¼Œåä¸€ç§è¦åˆ†å¼€ï¼Œè¿™åªæ˜¯è¯´æ˜è¯¥æ–‡æ³•æœ‰æ­§ä¹‰ï¼Œè€Œä¸èƒ½è¯´è¿™æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡æœ‰å…³æ–‡æ³•ã€‚äº‹å®ä¸Šï¼Œè¿˜æœ‰ä¸€äº›ä¸Šä¸‹æ–‡æ— å…³è¯­è¨€æ˜¯å›ºæœ‰æ­§ä¹‰çš„ï¼ˆèƒ½äº§ç”Ÿè¯¥è¯­è¨€çš„æ¯ä¸€ç§ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•éƒ½æœ‰æ­§ä¹‰ï¼‰ã€‚</p>
</blockquote>
<ol start="2">
<li>How many rules / productions does the grammarÂ have? è¯­æ³•æœ‰å¤šå°‘ä¸ªè§„åˆ™/äº§ç”Ÿå¼ï¼Ÿ</li>
</ol>
<blockquote>
<p>å¤šä¸ª<br>
å›¾ä¸­æœ‰ä¸¤ä¸ª</p>
</blockquote>
<ol start="3">
<li>What is a terminal? (Identify all terminals in theÂ picture) ä»€ä¹ˆæ˜¯ç»ˆç»“ç¬¦? (è¯†åˆ«å›¾ç‰‡ä¸­çš„æ‰€æœ‰ç»ˆç»“ç¬¦)</li>
</ol>
<blockquote>
<p>åƒMULã€ DIV å’Œ INTEGER è¿™æ ·çš„tokenç§°ä¸ºç»ˆç»“ç¬¦<br>
å›¾ä¸­çš„ç»ˆç»“ç¬¦æœ‰MULã€DIVã€INTEGER</p>
</blockquote>
<ol start="4">
<li>What is a non-terminal? (Identify all non-terminals in theÂ picture) ä»€ä¹ˆæ˜¯éç»ˆç»“ç¬¦? (è¯†åˆ«å›¾ç‰‡ä¸­çš„æ‰€æœ‰éç»ˆç»“ç¬¦)</li>
</ol>
<blockquote>
<p>åƒ expr å’Œ factor è¿™æ ·çš„å˜é‡ç§°ä¸ºéç»ˆç»“ç¬¦<br>
å›¾ä¸­çš„éç»ˆç»“ç¬¦æœ‰factorå’Œexpr</p>
</blockquote>
<ol start="5">
<li>What is a head of a rule? (Identify all heads / left-hand sides in theÂ picture) ä»€ä¹ˆæ˜¯è§„åˆ™çš„å¤´éƒ¨? (è¯†åˆ«å›¾ç‰‡ä¸­æ‰€æœ‰çš„header/left-head sides)</li>
</ol>
<blockquote>
<p>ä¸€æ¡è§„åˆ™ä¸­å†’å·å·¦è¾¹çš„ç»ˆç»“ç¬¦æ˜¯è§„åˆ™çš„head<br>
å›¾ä¸­çš„headeræœ‰ï¼šexprå’Œfactor</p>
</blockquote>
<ol start="6">
<li>What is a body of the rule? (Identify all bodies / right-hand sides in theÂ picture) è§„åˆ™çš„ä¸»ä½“æ˜¯ä»€ä¹ˆ? (è¯†åˆ«å›¾ç‰‡ä¸­æ‰€æœ‰çš„bodies/right-hand sides)</li>
</ol>
<blockquote>
<p>ä¸€æ¡è§„åˆ™ä¸­å†’å·å³è¾¹çš„ä¸€ç³»åˆ—ç»ˆç»“ç¬¦å’Œ/æˆ–éç»ˆç»“ç¬¦æ˜¯è§„åˆ™çš„body</p>
</blockquote>
<ol start="7">
<li>What is the start symbol of aÂ grammar? è¯­æ³•çš„å¼€å§‹ç¬¦å·æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ol>
<blockquote>
<p>ç¬¬ä¸€æ¡è§„åˆ™å·¦ä¾§çš„éç»ˆç»“ç¬¦ç§°ä¸º<strong>å¼€å§‹ç¬¦å·</strong>ã€‚<br>
å›¾ä¸­çš„grammarä¸­ï¼Œå¼€å§‹ç¬¦å·æ˜¯ exprã€‚</p>
</blockquote>
<p>Hey, you read all the way to the end! This post contained quite a bit of theory, so Iâ€™m really proud of you that you finishedÂ it.</p>
<p>å˜¿ï¼Œä½ ä»å¤´è¯»åˆ°å°¾ï¼è¿™ç¯‡æ–‡ç« åŒ…å«äº†ç›¸å½“å¤šçš„ç†è®ºï¼Œæ‰€ä»¥æˆ‘ä¸ºä½ å®Œæˆäº†å®ƒè€Œæ„Ÿåˆ°éª„å‚²ã€‚</p>
<p>Iâ€™ll be back next time with a new article - stay tuned and donâ€™t forget to do the exercises, they will do youÂ good.</p>
<p>ä¸‹æ¬¡æˆ‘ä¼šå¸¦ç€ä¸€ç¯‡æ–°æ–‡ç« å›æ¥â€”â€”è¯·ç»§ç»­å…³æ³¨ï¼Œåˆ«å¿˜äº†åšç»ƒä¹ ï¼Œå®ƒä»¬ä¼šå¯¹ä½ æœ‰å¥½å¤„çš„ã€‚</p>
<p>Here is a list of books I recommend that will help you in your study of interpreters andÂ compilers:</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘æ¨èçš„ä¸€äº›ä¹¦ç±ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©ä½ å­¦ä¹ è§£é‡Šå™¨å’Œç¼–è¯‘å™¨:</p>
<ol>
<li><a href="http://www.amazon.com/gp/product/193435645X/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=193435645X&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=MP4DCXDV6DJMEJBL">Language Implementation Patterns: Create Your Own Domain-Specific and General Programming Languages (Pragmatic Programmers)</a><br>
è¯­è¨€å®ç°æ¨¡å¼: åˆ›å»ºæ‚¨è‡ªå·±çš„ç‰¹å®šé¢†åŸŸå’Œé€šç”¨ç¼–ç¨‹è¯­è¨€(å®ç”¨ç¨‹åºå‘˜)</li>
<li><a href="http://www.amazon.com/gp/product/0470177071/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0470177071&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=UCLGQTPIYSWYKRRM">Writing Compilers and Interpreters: A Software Engineering Approach</a><br>
ç¼–å†™ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨: ä¸€ç§è½¯ä»¶å·¥ç¨‹æ–¹æ³•</li>
<li><a href="http://www.amazon.com/gp/product/052182060X/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=052182060X&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=ZSKKZMV7YWR22NMW">Modern Compiler Implementation in Java</a><br>
ç°ä»£ç¼–è¯‘å™¨åœ¨ Java ä¸­çš„å®ç°</li>
<li><a href="http://www.amazon.com/gp/product/1461446988/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1461446988&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=PAXWJP5WCPZ7RKRD">Modern Compiler Design</a><br>
ç°ä»£ç¼–è¯‘å™¨è®¾è®¡</li>
<li><a href="http://www.amazon.com/gp/product/0321486811/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0321486811&amp;linkCode=as2&amp;tag=russblo0b-20&amp;linkId=GOEGDQG4HIHU56FQ">Compilers: Principles, Techniques, and Tools (2nd Edition)</a><br>
ç¼–è¯‘å™¨: åŸç†ã€æŠ€æœ¯å’Œå·¥å…·(ç¬¬äºŒç‰ˆ)</li>
</ol>
<p><strong>All articles in this series:</strong></p>
<p>æœ¬ç³»åˆ—çš„æ‰€æœ‰æ–‡ç« :</p>
<ul>
<li><a href="https://ruslanspivak.com/lsbasi-part1/">Let's Build A Simple Interpreter. Part 1. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part2/">Let's Build A Simple Interpreter. Part 2. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part3/">Let's Build A Simple Interpreter. Part 3. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part4/">Let's Build A Simple Interpreter. Part 4. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part5/">Let's Build A Simple Interpreter. Part 5. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part6/">Let's Build A Simple Interpreter. Part 6. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part7/">Let's Build A Simple Interpreter. Part 7: Abstract Syntax Trees è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬7éƒ¨åˆ†: æŠ½è±¡è¯­æ³•æ ‘</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part8/">Let's Build A Simple Interpreter. Part 8. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part9/">Let's Build A Simple Interpreter. Part 9. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part10/">Let's Build A Simple Interpreter. Part 10. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part11/">Let's Build A Simple Interpreter. Part 11. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part12/">Let's Build A Simple Interpreter. Part 12. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part13/">Let's Build A Simple Interpreter. Part 13: Semantic Analysis è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬13éƒ¨åˆ†: è¯­ä¹‰åˆ†æ</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part14/">Let's Build A Simple Interpreter. Part 14: Nested Scopes and a Source-to-Source Compiler è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬14éƒ¨åˆ†: åµŒå¥—ä½œç”¨åŸŸå’Œæºåˆ°æºç¼–è¯‘å™¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part15/">Let's Build A Simple Interpreter. Part 15. è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬15éƒ¨åˆ†</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part16/">Let's Build A Simple Interpreter. Part 16: Recognizing Procedure Calls è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬16éƒ¨åˆ†: è¯†åˆ«è¿‡ç¨‹è°ƒç”¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part17/">Let's Build A Simple Interpreter. Part 17: Call Stack and Activation Records è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬17éƒ¨åˆ†: è°ƒç”¨å †æ ˆå’Œæ¿€æ´»è®°å½•</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part18/">Let's Build A Simple Interpreter. Part 18: Executing Procedure Calls è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬18éƒ¨åˆ†: æ‰§è¡Œè¿‡ç¨‹è°ƒç”¨</a></li>
<li><a href="https://ruslanspivak.com/lsbasi-part19/">Let's Build A Simple Interpreter. Part 19: Nested Procedure Calls è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„è§£é‡Šå™¨ã€‚ç¬¬19éƒ¨åˆ†: åµŒå¥—è¿‡ç¨‹è°ƒç”¨</a></li>
</ul>

                        </div>
                        
                            <div class="post-toc">
                                
                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>ztree</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/">https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR ç " target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/&sharesource=qzone&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part4.&pics=https://lzxzl.github.io/images/avatar.png?v=1747748455692&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="æ–°æµªå¾®åš" target="_blank" href="https://service.weibo.com/share/share.php?url=https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/&sharesource=weibo&title=[ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part4. + " - " + &pic="https://lzxzl.github.io/images/avatar.png?v=1747748455692 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://lzxzl.github.io/tag/GqQg6_YXk/">#
                    ç¼–è¯‘åŸç†
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/">
                                                                                            [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part5.
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/">
                                                                                                    [ç¿»è¯‘ä¸å­¦ä¹ ] Letâ€™s Build A Simple Interpreter. Part3.
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '2a44a295dd16ae7d05b8',
        clientSecret: '8030257bc11446a193cf383767567daca0e26312',
        repo: 'lzxzl.github.io',
        owner: 'lzxzl',
        admin: ['lzxzl'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        ztree
                            
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        ztree &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://lzxzl.github.io/" target="_blank">
                                                ztree
                                            </a>
            </div>
            <div id="update" style="display:none;">
                off
            </div>
            
                    <script>
                        var port = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + port + '</div>')
                    </script>
        </footer>
        
                <script>
                    
                    
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    var newDate = new Date();
                    newDate.setTime(1747748455692);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
        </div>
</body>
<script>
    scroll();
</script>

</html>