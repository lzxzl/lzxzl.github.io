{"posts":[{"fileName":"cve-2024-43047-itw-map-collision-leads-to-uaf-on-4x-kernels-and-some-5x-kernel-configurations","abstract":"","description":"经过前面的分析，CVE-2024-33060 和 CVE-2024-49848 极有可能是攻击者实际在野利用的漏洞。但有两个矛盾点： 若漏洞触发的是 CVE-2024-33060，理论上应产生某些内核日志，但实际攻击样本（ITW arti...","title":"CVE-2024-43047 (ITW) Map collision leads to UAF on 4.x kernels, and some 5.x kernel configurations","tags":[{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2024-43047-itw-map-collision-leads-to-uaf-on-4x-kernels-and-some-5x-kernel-configurations/","stats":{"text":"6 min read","time":301000,"words":1083,"minutes":6},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#%E6%BC%8F%E6%B4%9E\">漏洞</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n<li><a href=\"#patch\">Patch</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n</li>\n</ul>\n","date":"2025-05-20 21:16:59","dateFormat":"2025-05-20"},{"fileName":"cve-2024-49848-fastrpc_attr_keep_map-logic-bug-allows-fastrpc_internal_munmap_fd-to-racily-free-in-use-mappings-leading-to-uaf","abstract":"","description":" FASTRPC_ATTR_KEEP_MAP 的逻辑漏洞导致 fastrpc_internal_munmap_fd 在竞态条件下释放仍在使用中的内存映射，导致 UAF。 在 fastrpc_internal_mem_unmap 和 fas...","title":"CVE-2024-49848 FASTRPC_ATTR_KEEP_MAP logic bug allows fastrpc_internal_munmap_fd to racily free in-use mappings leading to UAF","tags":[{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2024-49848-fastrpc_attr_keep_map-logic-bug-allows-fastrpc_internal_munmap_fd-to-racily-free-in-use-mappings-leading-to-uaf/","stats":{"text":"19 min read","time":1135000,"words":3707,"minutes":19},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-%E6%BC%8F%E6%B4%9E\">1 漏洞</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n<li><a href=\"#patch\">Patch</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2025-05-20 21:13:01","dateFormat":"2025-05-20"},{"fileName":"pz-issue-42451713fixed-with-cve-2024-33060-incorrect-searching-algorithm-in-fastrpc_mmap_find-leads-to-kernel-address-space-info-leak","abstract":"","description":" fastrpc_mmap_find 中的搜索算法不正确，导致内核地址空间信息泄露。 这个洞也被 CVE-2024-33060 的patch给修复了，因此共享同一个cve 1 漏洞 fastrpc_mmap_create 函数使用攻击者可...","title":"PZ Issue 42451713(fixed with CVE-2024-33060) - Incorrect searching algorithm in fastrpc_mmap_find leads to kernel address space info leak","tags":[{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"}],"feature":"","link":"https://lzxzl.github.io/post/pz-issue-42451713fixed-with-cve-2024-33060-incorrect-searching-algorithm-in-fastrpc_mmap_find-leads-to-kernel-address-space-info-leak/","stats":{"text":"6 min read","time":353000,"words":1274,"minutes":6},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-%E6%BC%8F%E6%B4%9E\">1 漏洞</a></li>\n<li><a href=\"#2-patch\">2 Patch</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2025-01-27 21:27:42","dateFormat":"2025-01-27"},{"fileName":"solidity-hacks","abstract":"","description":" 2025.1.19: 0x01~0x02 Hacks 0x01 Re-Entrancy（重入攻击） demo学习 部署 EtherStore 合约 账号1 Alice 和帐号2 Bob 各自存入 1 Ether 到 EtherStor...","title":"Solidity Hacks","tags":[],"feature":"","link":"https://lzxzl.github.io/post/solidity-hacks/","stats":{"text":"9 min read","time":514000,"words":1709,"minutes":9},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#hacks\">Hacks</a>\n<ul>\n<li><a href=\"#0x01-re-entrancy%E9%87%8D%E5%85%A5%E6%94%BB%E5%87%BB\">0x01 Re-Entrancy（重入攻击）</a>\n<ul>\n<li><a href=\"#demo%E5%AD%A6%E4%B9%A0\">demo学习</a></li>\n<li><a href=\"#real-world-exampledao\">Real World Example:DAO</a></li>\n</ul>\n</li>\n<li><a href=\"#0x02-arithmetic-overflow-and-underflow\">0x02 Arithmetic Overflow and Underflow</a>\n<ul>\n<li><a href=\"#real-world-example-powhc-and-batch-transfer-overflow-cve-201810299\">Real-World Example: PoWHC and Batch Transfer Overflow (CVE-2018–10299)</a></li>\n</ul>\n</li>\n<li><a href=\"#0x03-self-destruct\">0x03 Self Destruct</a></li>\n<li><a href=\"#0x04-accessing-private-data\">0x04 Accessing Private Data</a></li>\n<li><a href=\"#0x05-delegatecall\">0x05 Delegatecall</a></li>\n<li><a href=\"#0x06-source-of-randomness\">0x06 Source of Randomness</a></li>\n<li><a href=\"#0x07-denial-of-service\">0x07 Denial of Service</a></li>\n<li><a href=\"#0x08-phishing-with-txorigin\">0x08 Phishing with tx.origin</a></li>\n<li><a href=\"#0x09-hiding-malicious-code-with-external-contract\">0x09 Hiding Malicious Code with External Contract</a></li>\n<li><a href=\"#0x0a-honeypot\">0x0A Honeypot</a></li>\n<li><a href=\"#0x0b-front-running\">0x0B Front Running</a></li>\n<li><a href=\"#0x0c-block-timestamp-manipulation\">0x0C Block Timestamp Manipulation</a></li>\n<li><a href=\"#0x0d-signature-replay\">0x0D Signature Replay</a></li>\n<li><a href=\"#0x0e-bypass-contract-size-check\">0x0E Bypass Contract Size Check</a></li>\n<li><a href=\"#0x0f-deploy-different-contracts-at-the-same-address\">0x0F Deploy Different Contracts at the Same Address</a></li>\n<li><a href=\"#0x10-vault-inflation\">0x10 Vault Inflation</a></li>\n<li><a href=\"#0x11-weth-permit\">0x11 WETH Permit</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2025-01-19 12:09:47","dateFormat":"2025-01-19"},{"fileName":"cve-2024-33060-uaf-race-of-global-maps-in-fastrpc_mmap_create-and-epilogue-functions","abstract":"","description":" qualcomm-dsp-driver: adsprpc 在 fastrpc_mmap_create（及其收尾函数）中全局映射的 UAF(Use After Free) 竞争条件 1 前置知识 互斥锁 “互斥锁”（Mutual Excl...","title":"CVE-2024-33060 UAF race of global maps in fastrpc_mmap_create (and epilogue functions)","tags":[{"name":"samsung","slug":"cLODIMrMR9","used":true,"link":"https://lzxzl.github.io/tag/cLODIMrMR9/"},{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2024-33060-uaf-race-of-global-maps-in-fastrpc_mmap_create-and-epilogue-functions/","stats":{"text":"23 min read","time":1339000,"words":5373,"minutes":23},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86\">1 前置知识</a>\n<ul>\n<li><a href=\"#%E4%BA%92%E6%96%A5%E9%94%81\">互斥锁</a>\n<ul>\n<li><a href=\"#1-%E4%B8%B4%E7%95%8C%E5%8C%BA%E4%B8%8E%E6%8E%92%E4%BB%96%E6%80%A7\">1. 临界区与排他性</a></li>\n<li><a href=\"#2-%E4%BA%92%E6%96%A5%E9%94%81%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C\">2. 互斥锁的基本操作</a></li>\n</ul>\n</li>\n<li><a href=\"#fastrpc_mmap\">fastrpc_mmap</a></li>\n</ul>\n</li>\n<li><a href=\"#2-%E6%BC%8F%E6%B4%9E\">2 漏洞</a></li>\n<li><a href=\"#3-poc\">3 PoC</a></li>\n<li><a href=\"#4-patch\">4 patch</a></li>\n<li><a href=\"#5-%E6%80%BB%E7%BB%93\">5 总结</a></li>\n<li><a href=\"#6-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">6 参考文献</a></li>\n</ul>\n","date":"2025-01-10 20:17:49","dateFormat":"2025-01-10"},{"fileName":"solidity-ru-men-bi-ji","abstract":"","description":" 2025.01.01: 0x00~0x01 (Basic) 2025.01.02: 0x02~0x04 (Basic) 2025.01.03: 0x05~0x0A (Basic) 2025.01.04: 0x0B~0x0F (Basic)...","title":"solidity入门笔记","tags":[{"name":"web3","slug":"lA8opWZT2D","used":true,"link":"https://lzxzl.github.io/tag/lA8opWZT2D/"},{"name":"solidity","slug":"42dj8xvgT9v","used":true,"link":"https://lzxzl.github.io/tag/42dj8xvgT9v/"}],"feature":"","link":"https://lzxzl.github.io/post/solidity-ru-men-bi-ji/","stats":{"text":"119 min read","time":7083000,"words":26000,"minutes":119},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#basic\">Basic</a>\n<ul>\n<li><a href=\"#0x00-primitive-data-types\">0x00 Primitive Data Types</a></li>\n<li><a href=\"#0x01-variables\">0x01 Variables</a></li>\n<li><a href=\"#0x02-constants\">0x02 Constants</a></li>\n<li><a href=\"#0x03-immutable\">0x03 Immutable</a></li>\n<li><a href=\"#0x04-reading-and-writing-to-a-state-variable\">0x04 Reading and Writing to a State Variable</a></li>\n<li><a href=\"#0x05-ether-and-wei\">0x05 Ether and Wei</a></li>\n<li><a href=\"#0x06-gas\">0x06 Gas</a></li>\n<li><a href=\"#0x07-if-else\">0x07 If / Else</a></li>\n<li><a href=\"#0x08-for-and-while-loop\">0x08 For and While Loop</a></li>\n<li><a href=\"#0x09-mapping\">0x09 Mapping</a></li>\n<li><a href=\"#0xa-array\">0xA Array</a></li>\n<li><a href=\"#0x0b-enum\">0x0B Enum</a></li>\n<li><a href=\"#0x0c-user-defined-value-types\">0x0C User Defined Value Types</a></li>\n<li><a href=\"#0x0d-structs\">0x0D Structs</a></li>\n<li><a href=\"#0x0e-data-locations-storage-memory-and-calldata\">0x0E Data Locations - Storage, Memory and Calldata</a></li>\n<li><a href=\"#0x0f-transient-storage\">0x0F Transient Storage</a></li>\n<li><a href=\"#0x10-function\">0x10 Function</a></li>\n<li><a href=\"#0x11-view-and-pure-functions\">0x11 View and Pure Functions</a></li>\n<li><a href=\"#0x12-error\">0x12 Error</a></li>\n<li><a href=\"#0x13-function-modifier\">0x13 Function Modifier</a></li>\n<li><a href=\"#0x14-events\">0x14 Events</a></li>\n<li><a href=\"#0x15-events-advanced\">0x15 Events Advanced</a></li>\n<li><a href=\"#0x16-constructor\">0x16 Constructor</a></li>\n<li><a href=\"#0x17-inheritance\">0x17 Inheritance</a></li>\n<li><a href=\"#0x18-shadowing-inherited-state-variables\">0x18 Shadowing Inherited State Variables</a></li>\n<li><a href=\"#0x19-calling-parent-contracts\">0x19 Calling Parent Contracts</a></li>\n<li><a href=\"#0x1a-visibility\">0x1A Visibility</a></li>\n<li><a href=\"#0x1b-interface\">0x1B Interface</a></li>\n<li><a href=\"#0x1c-payable\">0x1C Payable</a></li>\n<li><a href=\"#0x1d-sending-ether-transfer-send-call\">0x1D Sending Ether (transfer, send, call)</a></li>\n<li><a href=\"#0x1e-fallback\">0x1E Fallback</a></li>\n<li><a href=\"#0x1f-call\">0x1F Call</a></li>\n<li><a href=\"#0x20-delegatecall\">0x20 Delegatecall</a></li>\n<li><a href=\"#0x21-function-selector\">0x21 Function Selector</a></li>\n<li><a href=\"#0x22-calling-other-contract\">0x22 Calling Other Contract</a></li>\n<li><a href=\"#0x23-contract-that-creates-other-contracts\">0x23 Contract that Creates other Contracts</a></li>\n<li><a href=\"#0x24-try-catch\">0x24 Try Catch</a></li>\n<li><a href=\"#0x25-import\">0x25 Import</a></li>\n<li><a href=\"#0x26-library\">0x26 Library</a></li>\n<li><a href=\"#0x27-abi-encode\">0x27 ABI Encode</a></li>\n<li><a href=\"#0x28-abi-decode\">0x28 ABI Decode</a></li>\n<li><a href=\"#0x2a-verifying-signature\">0x2A Verifying Signature</a></li>\n<li><a href=\"#0x2b-gas-saving-techniques\">0x2B Gas Saving Techniques</a></li>\n<li><a href=\"#0x2c-bitwise-operators\">0x2C Bitwise Operators</a>\n<ul>\n<li><a href=\"#most-significant-bit\">Most significant bit</a></li>\n<li><a href=\"#most-significant-bit-in-assembly\">Most significant bit in assembly</a></li>\n</ul>\n</li>\n<li><a href=\"#0x2d-unchecked-math\">0x2D Unchecked Math</a></li>\n<li><a href=\"#0x2e-assembly-variable\">0x2E Assembly Variable</a></li>\n<li><a href=\"#0x2f-assembly-conditional-statements\">0x2F Assembly Conditional Statements</a></li>\n<li><a href=\"#0x30-assembly-loop\">0x30 Assembly Loop</a></li>\n<li><a href=\"#0x31-assembly-error\">0x31 Assembly Error</a></li>\n<li><a href=\"#0x32-assembly-math\">0x32 Assembly Math</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2025-01-01 00:16:34","dateFormat":"2025-01-01"},{"fileName":"cve-2023-6241-fen-xi-yu-fu-xian","abstract":"<blockquote>\n<p>对这篇文章 <a href=\"https://github.blog/security/vulnerability-research/gaining-kernel-code-execution-on-an-mte-enabled-pixel-8/\">Gaining kernel code execution on an MTE-enabled Pixel 8</a> 的分析与复现<br>\nArm Mali GPU<br>\n（买了台 pixel8，也刚好拿来当备用机~）</p>\n</blockquote>\n<ul>\n<li>镜像版本：<a href=\"https://developers.google.com/android/images?hl=zh-cn\">UD1A.231105.004</a></li>\n<li>ndk版本：26.2.11394342</li>\n<li>open-cl header版本：<a href=\"https://github.com/KhronosGroup/OpenCL-Headers/releases/tag/v2023.04.17\">v2023.04.17</a></li>\n</ul>\n<h1 id=\"复现\">复现</h1>\n<ul>\n<li>编译</li>\n</ul>\n<pre><code class=\"language-bash\"># 1. 拉依赖库\n╰─ adb pull vendor/lib64/egl/libGLES_mali.so .\n\n# 2. 拷贝opencl header到exp目录\n╰─ cp -r ../OpenCL-Headers-2023.04.17/CL .\n\n# 3. 编译\n╰─ /Users/lzx/Library/Android/sdk/ndk/26.2.11394342/toolchains/llvm/prebuilt/darwin-x86_64/bin/aarch64-linux-android34-clang -DSHELL -DCL_TARGET_OPENCL_VERSION=300 -I. -L. mali_jit_csf.c mem_read_write.c mempool_utils.c -lGLES_mali -o mali_jit_csf\n\n# 4. 得到 mali_jit_csf\n</code></pre>\n<ul>\n<li>运行</li>\n</ul>\n<pre><code class=\"language-bash\">╰─ adb push mali_jit_csf /data/local/tmp\n\n╰─ adb shell\nshiba:/ $ cd /data/local/tmp\nshiba:/data/local/tmp $ LD_LIBRARY_PATH=/vendor/lib64/egl ./mali_jit_csf\nmali_fd 3\ncorrupted_jit_addr 6000001000\nkernel success\nkernel success\nqueue kernel\njit_grow addr 6000001000\nSize after grow: 22f6\nFinal grow size: 23c7\nkeep alive jit_addr 60023d1000\nSize after free: 21fd, trim_level 6\nwriting to gpu_va 6002301000\nfound reused page 5fffef6000, 0\npgd entry found at index 0 400008972ef443\noverwrite addr : 5ffff00b50 b50\noverwrite addr : 5fffb00b50 b50\noverwrite addr : 5fff900b50 b50\noverwrite addr : 5ffff00714 714\noverwrite addr : 5fffb00714 714\noverwrite addr : 5fff900714 714\nresult 50\nshiba:/data/local/tmp # id\nuid=0(root) gid=0(root) groups=0(root) context=u:r:kernel:s0\nshiba:/data/local/tmp # getenforce\ngetenforce: Couldn't get enforcing status: No such file or directory\n1|shiba:/data/local/tmp # ^C\n130|shiba:/data/local/tmp # ^D\nshiba:/data/local/tmp $\n</code></pre>\n<p>第一次运行的时候，确实如readme里所说卡住了，第二次运行就没事了。</p>\n<blockquote>\n<p>When running the first time, the exploit sometimes stalls after printing the last <code>overwrite addr</code> message. If that happens (stalled for more than 10 seconds, though pausing for a few seconds is normal), then simply kill the exploit and rerun it. It should not stall the second time.</p>\n</blockquote>\n<h1 id=\"漏洞根因\">漏洞根因</h1>\n<h1 id=\"poc\">PoC</h1>\n<h1 id=\"patch\">Patch</h1>\n<h1 id=\"结论\">结论</h1>\n<h1 id=\"参考文献\">参考文献</h1>\n<ul>\n<li>https://github.blog/security/vulnerability-research/gaining-kernel-code-execution-on-an-mte-enabled-pixel-8/</li>\n<li>https://github.com/github/securitylab/tree/main/SecurityExploits/Android/Mali/CVE_2023_6241</li>\n<li>https://developers.google.com/android/images?hl=zh-cn</li>\n<li>https://github.com/KhronosGroup/OpenCL-Headers/releases/tag/v2023.04.17</li>\n</ul>\n","description":" 对这篇文章 Gaining kernel code execution on an MTE-enabled Pixel 8 的分析与复现 Arm Mali GPU （买了台 pixel8，也刚好拿来当备用机~） 镜像版本：UD1A.2...","title":"CVE-2023-6241分析与复现","tags":[{"name":"gpu","slug":"LCPtoskbRl","used":true,"link":"https://lzxzl.github.io/tag/LCPtoskbRl/"},{"name":"mali","slug":"BKUV3xCGrH","used":true,"link":"https://lzxzl.github.io/tag/BKUV3xCGrH/"},{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2023-6241-fen-xi-yu-fu-xian/","stats":{"text":"3 min read","time":139000,"words":412,"minutes":3},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E5%A4%8D%E7%8E%B0\">复现</a></li>\n<li><a href=\"#%E6%BC%8F%E6%B4%9E%E6%A0%B9%E5%9B%A0\">漏洞根因</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n<li><a href=\"#patch\">Patch</a></li>\n<li><a href=\"#%E7%BB%93%E8%AE%BA\">结论</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2024-12-31 02:23:31","dateFormat":"2024-12-31"},{"fileName":"cve-2024-21455-is_compat-flag-leads-to-access-of-userland-provided-addresses-as-kernel-pointers","abstract":"","description":" qualcomm-dsp-driver: adsprpc 漏洞 为了支持 32 位用户空间进程，64 位内核包含一个可以支持 ioctl 的“兼容层”（compatibility layer）。这个层的职责是将 32 位结构体转换为它们...","title":"CVE-2024-21455 is_compat flag leads to access of userland provided addresses as kernel pointers","tags":[{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"},{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2024-21455-is_compat-flag-leads-to-access-of-userland-provided-addresses-as-kernel-pointers/","stats":{"text":"7 min read","time":370000,"words":1461,"minutes":7},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E6%BC%8F%E6%B4%9E\">漏洞</a>\n<ul>\n<li><a href=\"#%E6%BC%8F%E6%B4%9E%E6%A8%A1%E5%BC%8F%E5%B0%8F%E7%BB%93\">漏洞模式小结</a></li>\n</ul>\n</li>\n<li><a href=\"#poc\">PoC</a></li>\n<li><a href=\"#patch\">Patch</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2024-12-27 01:15:14","dateFormat":"2024-12-27"},{"fileName":"cve-2024-38402-refcount-leak-leading-to-uaf-in-fastrpc_get_process_gids","abstract":"","description":" qualcomm-dsp-driver: adsprpc 该漏洞是与task相关联的 group_info 结构体的引用计数泄漏导致的UAF。在 fastrpc_get_process_gids 函数中，调用了 get_current_...","title":"CVE-2024-38402 refcount leak leading to UAF in fastrpc_get_process_gids","tags":[{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"},{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2024-38402-refcount-leak-leading-to-uaf-in-fastrpc_get_process_gids/","stats":{"text":"4 min read","time":222000,"words":691,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2024-12-24 23:20:50","dateFormat":"2024-12-24"},{"fileName":"cve-2021-25458-kernel-null-pointer-dereference-in-exynos-ion-implementation","abstract":"","description":" https://labs.taszk.io/blog/post/60_ss_ion_null_deref/ Exynos ION内核驱动程序中存在一个ION内存缓冲区类型混淆漏洞。该漏洞可能导致将未初始化的内存视为有效指针，并导致内核空...","title":"CVE-2021-25458 Kernel NULL Pointer Dereference in Exynos ION Implementation","tags":[{"name":"samsung","slug":"cLODIMrMR9","used":true,"link":"https://lzxzl.github.io/tag/cLODIMrMR9/"},{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/"},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-25458-kernel-null-pointer-dereference-in-exynos-ion-implementation/","stats":{"text":"4 min read","time":203000,"words":861,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2024-12-24 22:29:18","dateFormat":"2024-12-24"},{"fileName":"cve-2009-2910-linux-kernel-x86-64-register-leak-by-jon-oberheide","abstract":"","description":"Introduction versions &lt;= 2.6.32-rc1 The x86-64 registers r8-r11 may be leaked to 32-bit unprivileged userspace appl...","title":"CVE-2009-2910-Linux Kernel x86-64 Register Leak by Jon Oberheide","tags":[{"name":"info-leak","slug":"XOAss1DVS","used":true,"link":"https://lzxzl.github.io/tag/XOAss1DVS/"},{"name":"linux kernel exploit","slug":"LlmtM56SL","used":true,"link":"https://lzxzl.github.io/tag/LlmtM56SL/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2009-2910-linux-kernel-x86-64-register-leak-by-jon-oberheide/","stats":{"text":"18 min read","time":1027000,"words":3834,"minutes":18},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#introduction\">Introduction</a></li>\n<li><a href=\"#the-vulnerability\">The Vulnerability</a></li>\n<li><a href=\"#the-exploit\">The Exploit</a>\n<ul>\n<li><a href=\"#exp1\">Exp1</a></li>\n<li><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88code32-%E8%83%BD%E6%8C%87%E7%A4%BA%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%9A%84%E4%BB%A3%E7%A0%81%E6%98%AF32%E4%BD%8D\">为什么.code32 能指示接下来的代码是32位？</a>\n<ul>\n<li><a href=\"#%E6%B1%87%E7%BC%96%E5%99%A8%E7%9A%84%E6%A8%A1%E5%BC%8F%E6%8E%A7%E5%88%B6\">汇编器的模式控制</a></li>\n<li><a href=\"#%E6%8C%87%E7%A4%BA%E6%B1%87%E7%BC%96%E5%99%A8%E7%9A%84%E7%9B%AE%E6%A0%87%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84\">指示汇编器的目标体系结构</a></li>\n</ul>\n</li>\n<li><a href=\"#exp2\">exp2</a>\n<ul>\n<li><a href=\"#%E6%8C%87%E4%BB%A4%E9%9B%86%E5%92%8C%E8%AF%AD%E6%B3%95%E8%BD%AC%E6%8D%A2\">指令集和语法转换</a></li>\n<li><a href=\"#32%E4%BD%8D%E5%88%B064%E4%BD%8D%E7%9A%84%E8%BD%AC%E6%8D%A2\">32位到64位的转换</a></li>\n<li><a href=\"#%E8%BF%94%E5%9B%9E%E5%88%B032%E4%BD%8D%E4%BB%A3%E7%A0%81\">返回到32位代码</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#the-fix\">The Fix</a></li>\n<li><a href=\"#references\">References</a></li>\n</ul>\n","date":"2024-05-07 01:54:11","dateFormat":"2024-05-07"},{"fileName":"cve-2009-3001-linux-kernel-getname-stack-memory-disclosures-by-jon-oberheide","abstract":"","description":"The Vulnerability getname()函数是内核中地址族的一个功能，用于检索有关给定套接字的信息。这些信息以sockaddr结构体的形式存在，可以通过getsockname(2)和getpeername(2)系统调用分别从用...","title":"CVE-2009-3001 — Linux Kernel getname() Stack Memory Disclosures by Jon Oberheide","tags":[{"name":"protocol stack","slug":"kkTayTYwi","used":true,"link":"https://lzxzl.github.io/tag/kkTayTYwi/"},{"name":"linux kernel exploit","slug":"LlmtM56SL","used":true,"link":"https://lzxzl.github.io/tag/LlmtM56SL/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2009-3001-linux-kernel-getname-stack-memory-disclosures-by-jon-oberheide/","stats":{"text":"8 min read","time":451000,"words":1615,"minutes":8},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#the-vulnerability\">The Vulnerability</a>\n<ul>\n<li><a href=\"#%E5%B0%8F%E7%BB%93\">小结</a></li>\n</ul>\n</li>\n<li><a href=\"#the-exploit\">The Exploit</a></li>\n<li><a href=\"#the-fix\">The Fix</a></li>\n<li><a href=\"#references\">References</a></li>\n</ul>\n","date":"2024-05-06 00:26:02","dateFormat":"2024-05-06"},{"fileName":"cve-2023-22436-linux-nei-he-yin-yong-ji-shu","abstract":"","description":" 不多说了，都是理由，还是不够自律。2023.10.24 漏洞编号 相关漏洞 漏洞描述 漏洞影响 CVSS3.1基础得分 受影响的版本 受影响的仓库 修复链接 参考链接 OpenHarmony-SA-2...","title":"CVE-2023-22436 - Linux内核 - 引用计数","tags":[{"index":6,"name":"Linux Kernel PWN","slug":"LKPWN","used":true,"link":"https://lzxzl.github.io/tag/LKPWN/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2023-22436-linux-nei-he-yin-yong-ji-shu/","stats":{"text":"4 min read","time":206000,"words":711,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-10-24 23:20:21","dateFormat":"2023-10-24"},{"fileName":"cve-2022-20447-lan-ya-pan-uaf","abstract":"","description":" 2023.09.19 CVE-2022-20447 A-233604485 ID High 13 patch 分析 在BNEP_WriteBuf -&gt; bnepu_check_send_packet中，是有场景可能导...","title":"CVE-2022-20447 - 蓝牙PAN - UAF","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20447-lan-ya-pan-uaf/","stats":{"text":"4 min read","time":193000,"words":604,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-19 01:18:08","dateFormat":"2023-09-19"},{"fileName":"cve-2022-20410-lan-ya-zheng-shu-yi-chu-greateroob-read","abstract":"","description":" 2023.09.17 CVE-2022-20410 A-205570663 ID High 10, 11, 12, 12L, 13 patch diff --git a/system/stack/avrc/avrc_par...","title":"CVE-2022-20410 - 蓝牙 - 整数溢出->OOB Read","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20410-lan-ya-zheng-shu-yi-chu-greateroob-read/","stats":{"text":"4 min read","time":188000,"words":610,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-17 23:01:09","dateFormat":"2023-09-17"},{"fileName":"cve-2022-20395-mediaprovider-lu-jing-chuan-yue","abstract":"","description":" 昨天出去玩了，没带电脑，所以今天补上昨天的。2023.09.17补2023.09.16 CVE-2022-20395 A-221855295 EoP High 11, 12, 12L, 13 patch 分析 在Medi...","title":"CVE-2022-20395 - MediaProvider - 路径穿越","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20395-mediaprovider-lu-jing-chuan-yue/","stats":{"text":"5 min read","time":244000,"words":703,"minutes":5},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-17 22:56:18","dateFormat":"2023-09-17"},{"fileName":"cve-2022-20445-lan-ya-sdp-zheng-shu-yi-chu","abstract":"","description":" 2023.09.15 CVE-2022-20445 A-225876506 ID High 10, 11, 12, 12L, 13 patch 分析 没有校验packet中的cur_handles，导致后续的三次整数溢出。...","title":"CVE-2022-20445  - 蓝牙SDP - 整数溢出","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20445-lan-ya-sdp-zheng-shu-yi-chu/","stats":{"text":"4 min read","time":218000,"words":770,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-16 02:22:24","dateFormat":"2023-09-16"},{"fileName":"cve-2022-20224-lan-ya-hfp-client-yue-jie-du","abstract":"","description":" 2023.09.14 CVE-2022-20224 A-220732646 ID High 10, 11, 12, 12L patch 分析 也很容易根据patch看出来，while循环中遍历buf的时候，只判断了是否遇到...","title":"CVE-2022-20224 - 蓝牙HFP Client - 越界读","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20224-lan-ya-hfp-client-yue-jie-du/","stats":{"text":"1 min read","time":25000,"words":94,"minutes":1},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-15 00:25:27","dateFormat":"2023-09-15"},{"fileName":"cve-2022-20229-lan-ya-hfp-client-yue-jie-xie","abstract":"","description":" 2023.09.14 CVE-2022-20229 A-224536184 RCE Critical 10, 11, 12, 12L patch 分析 下面的函数bta_hf_client_handle_cind_list...","title":"CVE-2022-20229 - 蓝牙HFP Client - 越界写","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20229-lan-ya-hfp-client-yue-jie-xie/","stats":{"text":"3 min read","time":160000,"words":625,"minutes":3},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#hfp\">HFP</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-15 00:24:29","dateFormat":"2023-09-15"},{"fileName":"cve-2022-20344-surfaceflinger-race-condition","abstract":"","description":" 2023.09.13 CVE-2022-20344 A-232541124 [2] EoP High 10, 11, 12, 12L patch 分析 根据patch来看，漏洞根因很简单：SurfaceF...","title":"CVE-2022-20344 - SurfaceFlinger - Race Condition","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2022-20344-surfaceflinger-race-condition/","stats":{"text":"1 min read","time":25000,"words":108,"minutes":1},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-14 00:02:12","dateFormat":"2023-09-14"},{"fileName":"cve-2021-39805-lan-ya-l2cap-oob-read","abstract":"","description":" 2023.09.12 CVE-2021-39805 A-212694559 ID High 12, 12L patch 分析 该漏洞发生在L2CAP的Enhanced Credit Based Flow Control M...","title":"CVE-2021-39805 - 蓝牙L2CAP - OOB Read","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39805-lan-ya-l2cap-oob-read/","stats":{"text":"2 min read","time":64000,"words":223,"minutes":2},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-12 23:05:00","dateFormat":"2023-09-12"},{"fileName":"cve-2021-39703-usb-fu-wu-luo-ji-lou-dong","abstract":"","description":" 2023.09.11 CVE-2021-39703 A-207057578 EoP High 12 patch 分析 这个洞挺有意思的：AOSP里面需要手动授权才能开启USB MTP模式，在断开连接一个已启用MTP的设备之...","title":"CVE-2021-39703 - USB服务 - 逻辑漏洞","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39703-usb-fu-wu-luo-ji-lou-dong/","stats":{"text":"4 min read","time":194000,"words":807,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#usb-mtp%E6%A8%A1%E5%BC%8F\">USB MTP模式</a></li>\n<li><a href=\"#usb-%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F\">USB 调试模式</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-12 00:41:16","dateFormat":"2023-09-12"},{"fileName":"cve-2021-39804-libheif-kong-zhi-zhen-jie-yin-yong","abstract":"","description":" 2023.09.11 补 2023.09.10 CVE-2021-39804 A-215002587 DoS High 11, 12, 12L patch 分析 这个也不难分析，看patch就能看明白。传给atoi的值如果...","title":"CVE-2021-39804 - libheif - 空指针解引用","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39804-libheif-kong-zhi-zhen-jie-yin-yong/","stats":{"text":"3 min read","time":123000,"words":449,"minutes":3},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-12 00:40:06","dateFormat":"2023-09-12"},{"fileName":"cve-2021-39675-nfc-oob-write","abstract":"","description":" 2023.09.11 补 2023.09.09 CVE-2021-39675 A-205729183 EoP 严重 12 patch 分析 很明显，没有判断传入的size的上限，可能导致OOB Write。 /******...","title":"CVE-2021-39675 - NFC - OOB Write","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39675-nfc-oob-write/","stats":{"text":"4 min read","time":205000,"words":564,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-12 00:38:55","dateFormat":"2023-09-12"},{"fileName":"cve-2021-39665-libstagefright-oob-readmd","abstract":"","description":" 2023.09.11 补 2023.09.08 哎，8号卡在一个蓝牙cve，分析不出来就顿住了。不能这样了，以后遇到分析不出来的就先挂着吧。 CVE-2021-39665 A-204077881 ID 高 12 patch ...","title":"CVE-2021-39665 - libstagefright - OOB Read","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39665-libstagefright-oob-readmd/","stats":{"text":"4 min read","time":236000,"words":824,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-12 00:36:46","dateFormat":"2023-09-12"},{"fileName":"cve-2021-39629-nfc-uaf","abstract":"","description":" 2023.09.07 CVE-2021-39629 A-197353344 EoP 高 9、10、11、12 patch 分析 漏洞点位于phTmlNfc_Init函数，该函数会malloc一个chunk...","title":"CVE-2021-39629 - NFC - UAF","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39629-nfc-uaf/","stats":{"text":"13 min read","time":728000,"words":2521,"minutes":13},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a>\n<ul>\n<li><a href=\"#phtmlnfc_init\">phTmlNfc_Init</a></li>\n<li><a href=\"#phtmlnfc_cleanup-free\">phTmlNfc_CleanUp - Free</a></li>\n<li><a href=\"#phtmlnfc_shutdown_cleanup-free\">phTmlNfc_Shutdown_CleanUp - Free</a></li>\n<li><a href=\"#phtmlnfc_shutdown\">phTmlNfc_Shutdown</a></li>\n<li><a href=\"#phtmlnfc_tmlthread-use\">phTmlNfc_TmlThread - Use</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-08 00:22:07","dateFormat":"2023-09-08"},{"fileName":"cve-2021-39659-telecom-java-zheng-shu-yi-chu","abstract":"","description":" 2023.09.06 CVE-2021-39659 A-208267659 DoS 高 10、11、12 patch Fix sorting issue during emergency call att...","title":"CVE-2021-39659 - telecom - Java整数溢出","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39659-telecom-java-zheng-shu-yi-chu/","stats":{"text":"2 min read","time":103000,"words":368,"minutes":2},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-07 01:01:29","dateFormat":"2023-09-07"},{"fileName":"cve-2021-39623-media-libstagefright-heap-oob-write","abstract":"","description":" 2023.09.05 CVE-2021-39623 A-194105348 EoP 高 9、10、11、12 patch SimpleDecodingSource:Prevent OOB write in...","title":"CVE-2021-39623 - media - libstagefright - heap OOB Write","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/cve-2021-39623-media-libstagefright-heap-oob-write/","stats":{"text":"9 min read","time":519000,"words":1836,"minutes":9},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-06 22:00:49","dateFormat":"2023-09-06"},{"fileName":"new_cve-2021-39632-recovery-yue-jie-xie","abstract":"","description":" 2023.09.04 CVE-2021-39632 A-202159709 EoP 高 11、12 patch Do not write past end of inotify event structure. 分析 ...","title":"CVE-2021-39632 - Recovery - 越界写","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/new_cve-2021-39632-recovery-yue-jie-xie/","stats":{"text":"4 min read","time":200000,"words":659,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#patch\">patch</a></li>\n<li><a href=\"#%E5%88%86%E6%9E%90\">分析</a></li>\n<li><a href=\"#%E5%B0%8F%E7%BB%93\">小结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-06 21:56:09","dateFormat":"2023-09-06"},{"fileName":"android-an-quan-gong-gao-cve-fen-xi-kai-pian","abstract":"","description":"哎，挖不出洞愁啊。 今天是2023年9月6日，前两天各分析了一个Android安全公告里的CVE，今天继续，并打算一直保持下去，在公告里每天挑一个cve分析一下，贴到博客来监督自己。 每个CVE最少把漏洞根因搞懂吧。 已分析列表 202...","title":"Android安全公告CVE分析 - 开篇&总览","tags":[{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/"}],"feature":"","link":"https://lzxzl.github.io/post/android-an-quan-gong-gao-cve-fen-xi-kai-pian/","stats":{"text":"2 min read","time":93000,"words":330,"minutes":2},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#%E5%B7%B2%E5%88%86%E6%9E%90%E5%88%97%E8%A1%A8\">已分析列表</a></li>\n<li><a href=\"#%E6%90%9C%E9%9B%86%E7%9A%84%E8%B5%84%E6%96%99\">搜集的资料</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-09-06 21:51:45","dateFormat":"2023-09-06"},{"fileName":"aosp-shang-de-libfuzzer-chang-shi","abstract":"<p>这篇主要是记录根据Google官方文档<a href=\"https://source.android.google.cn/docs/security/test/libfuzzer?hl=zh-cn\"> 通过 libFuzzer 进行模糊测试 </a>来尝试在AOSP上使用libfuzzer的记录</p>\n<h2 id=\"0-环境准备\">0 环境准备</h2>\n<ul>\n<li>设备：Pixel 4</li>\n<li>aosp源码：android-13.0.0_r7（这个源码是之前就下载好了的，所以我这里就不去下载main/master分支的了）</li>\n<li>下面命令中的<a href=\"https://developers.google.cn/android/drivers?hl=zh-cn\">驱动程序二进制文件</a>可以根据自己的手机环境下载相应的文件。</li>\n</ul>\n<pre><code class=\"language-shell\">mkdir ~/bin\nexport PATH=~/bin:$PATH\ncurl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo\nchmod a+x ~/bin/repo\nrepo init -u https://android.googlesource.com/platform/manifest -b android-13.0.0_r7\nrepo sync -c -j8\nwget https://dl.google.com/dl/android/aosp/google_devices-flame-tp1a.221005.002.b2-22399ead.tgz\ntar xvf google_devices-flame-tp1a.221005.002.b2-22399ead.tgz\n./extract-google_devices-flame.sh\nwget https://dl.google.com/dl/android/aosp/qcom-flame-tp1a.221005.002.b2-358af558.tgz\ntar xvf qcom-flame-tp1a.221005.002.b2-358af558.tgz\n./extract-qcom-flame.sh\n. build/envsetup.sh\nlunch\n\n</code></pre>\n<blockquote>\n<p>注意：lunch命令中选择相应的选项，我这里是flame。选择相应选项后，会设置一些环境变量。</p>\n</blockquote>\n<pre><code class=\"language-shell\">ztree@ubuntu2:~/aosp/android-13.0.0_r7$ lunch\n\nYou're building on Linux\n\nLunch menu .. Here are the common combinations:\n     1. aosp_arm-eng\n     2. aosp_arm64-eng\n     ......\n     22. aosp_flame-userdebug\n     23. aosp_flame_car-userdebug\n     ......\n\nWhich would you like? [aosp_arm-eng]\nPick from common choices above (e.g. 13) or specify your own (e.g. aosp_barbet-eng): 22\n\nHint: next time you can simply run 'lunch aosp_flame-userdebug'\n\n============================================\nPLATFORM_VERSION_CODENAME=REL\nPLATFORM_VERSION=13\nTARGET_PRODUCT=aosp_flame\nTARGET_BUILD_VARIANT=userdebug\nTARGET_BUILD_TYPE=release\nTARGET_ARCH=arm64\nTARGET_ARCH_VARIANT=armv8-a\nTARGET_CPU_VARIANT=generic\nTARGET_2ND_ARCH=arm\nTARGET_2ND_ARCH_VARIANT=armv8-a\nTARGET_2ND_CPU_VARIANT=generic\nHOST_ARCH=x86_64\nHOST_2ND_ARCH=x86\nHOST_OS=linux\nHOST_OS_EXTRA=Linux-5.19.0-46-generic-x86_64-Ubuntu-22.04.2-LTS\nHOST_CROSS_OS=windows\nHOST_CROSS_ARCH=x86\nHOST_CROSS_2ND_ARCH=x86_64\nHOST_BUILD_TYPE=release\nBUILD_ID=TP1A.221005.002\nOUT_DIR=out\nPRODUCT_SOONG_NAMESPACES=hardware/google/av hardware/google/camera hardware/google/interfaces hardware/google/pixel device/google/coral hardware/qcom/sm8150/display hardware/qcom/sm8150/data/ipacfg-mgr hardware/qcom/sm8150/gps vendor/google/airbrush/floral vendor/google/biometrics/face/florence vendor/google/camera vendor/google/darwinn vendor/google_devices/common/proprietary/confirmatioui_hal vendor/google_nos/host/android vendor/qcom/sm8150 vendor/qcom/sm8150/proprietary/commonsys/telephony-apps/DataStatusNotification vendor/qcom/sm8150/proprietary/gps vendor/qcom/sm8150/proprietary/qmi vendor/qcom/sm8150/codeaurora/location vendor/google/interfaces vendor/google_nos/test/system-test-harness vendor/qcom/sensors vendor/google/tools/sensors vendor/qcom/sm7250/codeaurora/commonsys/telephony/ims/ims-ext-common vendor/qcom/sm7250/codeaurora/dataservices/rmnetctl vendor/qcom/sm7250/proprietary/commonsys/qcrilOemHook vendor/qcom/sm7250/proprietary/commonsys/telephony-apps/ims vendor/qcom/sm7250/proprietary/commonsys/telephony-apps/QtiTelephonyService vendor/qcom/sm7250/proprietary/commonsys/telephony-apps/xdivert vendor/qcom/sm7250/proprietary/qcril-data-hal vendor/qcom/sm7250/proprietary/qcril-hal vendor/qcom/sm7250/proprietary/data vendor/qcom/proprietary/bluetooth/hidl_client vendor/qcom/flame/proprietary\n============================================\n</code></pre>\n<h2 id=\"1-编译并刷入镜像\">1 编译并刷入镜像</h2>\n<pre><code class=\"language-shell\"># 编译/构建\nm\n\n# 进入fastboot模式\nadb reboot bootloader\n\n# fastboot命令查看设备，确认fastboot命令是否能正常使用\nfastboot device\n\n# 解锁引导加载程序（如果之前就解锁过，不执行该条命令也可以）\nfastboot oem unlock\n\n# 刷入新编译的映像\nfastboot flashall\n</code></pre>\n<h3 id=\"探索1fastboot-device报错无权限\">探索1：<code>fastboot device</code>报错无权限</h3>\n<p>如果<code>fastboot device</code>报错如下：</p>\n<pre><code class=\"language-shell\">ztree@ubuntu2:~/aosp/android-13.0.0_r7$ fastboot devices\nno permissions (missing udev rules? user is in the plugdev group); see [http://developer.android.com/tools/device.html]\tfastboot\n</code></pre>\n<p>解决办法如下：</p>\n<pre><code class=\"language-shell\"># 查看usb设备信息，可以看到idVendor是18d1，idProduct是4ee0\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ lsusb\nBus 004 Device 004: ID 18d1:4ee0 Google Inc. Nexus/Pixel Device (fastboot)\nBus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\nBus 003 Device 003: ID 0489:e0cd Foxconn / Hon Hai Wireless_Device\nBus 003 Device 002: ID 04f3:0c4b Elan Microelectronics Corp. ELAN:Fingerprint\nBus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\nBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\nBus 001 Device 003: ID 5986:212b Acer, Inc Integrated Camera\nBus 001 Device 002: ID 046d:c542 Logitech, Inc. Wireless Receiver\nBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\n\n# 查看之前为解决adb device报错无权限而添加的规则文件\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ sudo cat /etc/udev/rules.d/90-android.rules\nSUBSYSTEM==&quot;usb&quot;,ATTRS{idVendor}==&quot;18d1&quot;,ATTRS{idProduct}==&quot;4ee7&quot;,MODE=&quot;0666&quot;,GROUP=&quot;plugdev&quot;,SYMLINK+=&quot;android&quot;,SYMLINK+=&quot;android_adb&quot;\n\n# 复制一份，命名为91-android.rules\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ sudo cp /etc/udev/rules.d/90-android.rules /etc/udev/rules.d/91-android.rules\n\n# 编辑新规则文件，idVendor仍然是18d1，修改idProduct为4ee0\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ sudo vim /etc/udev/rules.d/91-android.rules\n\n# 刷新规则，重启udev服务\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ sudo udevadm control --reload-rules\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ sudo service udev restart\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ sudo udevadm trigger\n\n# 再次尝试fastboot device，成功\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ fastboot devices\n9B081FFAZ0052M\tfastboot\n\n</code></pre>\n<blockquote>\n<p>如果是adb遇到了这个错误，还要重启adb。</p>\n</blockquote>\n<h3 id=\"探索2-fastboot-flashall-是怎么刷镜像的\">探索2： fastboot flashall 是怎么刷镜像的？</h3>\n<pre><code class=\"language-shell\">ztree@ubuntu2:~/aosp/android-13.0.0_r7$ fastboot --help\nusage: fastboot [OPTION...] COMMAND...\n\nflashing:\n......\n flashall                   Flash all partitions from $ANDROID_PRODUCT_OUT.\n                            On A/B devices, flashed slot is set as active.\n                            Secondary images may be flashed to inactive slot.\n</code></pre>\n<p>可以看到<code>flashall</code>选项是将环境变量<code>$ANDROID_PRODUCT_OUT</code>中的内容刷到设备中，而该环境变量是在执行<code>. build/envsetup.sh</code>和<code>lunch</code>命令的时候，根据选择的选项而设置的。</p>\n<pre><code class=\"language-shell\">ztree@ubuntu2:~/aosp/android-13.0.0_r7$ echo $ANDROID_PRODUCT_OUT\n/home/ztree/aosp/android-13.0.0_r7/out/target/product/flame\n</code></pre>\n<h2 id=\"2-编译一个google自有的libfuzzer脚本手机\">2 编译一个Google自有的libfuzzer脚本（手机）</h2>\n<p>先尝试在手机上跑libfuzzer，因为有些模块会不支持在host上编译和运行</p>\n<pre><code class=\"language-c\">ztree@ubuntu2:~/aosp/android-13.0.0_r7$ SANITIZE_TARGET=hwaddress m metadataretriever_fuzzer\n......\n[100% 595/595] Install out/target/product/flame/system/lib64/libstagefright.so\n\n#### build completed successfully (03:08 (mm:ss)) ####\n\n</code></pre>\n<p>这个fuzzer是在 frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp 中定义的，也可以从<a href=\"https://cs.android.com/android/platform/superproject/main/+/main:frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp\">这里</a>查看。</p>\n<h2 id=\"3-运行手机\">3 运行（手机）</h2>\n<pre><code class=\"language-shell\"># 手机进入root模式\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ adb root\n\n# 同步更新data目录下的文件到手机（主要是把data/fuzz目录同步到手机上去，该目录包含fuzzer和一些库文件）\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ adb sync data\n/data/: 140 files pushed, 0 skipped. 278.6 MB/s (353442745 bytes in 1.210s)\n\n# 进入手机shell，执行libfuzzer\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ adb shell\nflame:/ # cd /data/fuzz/                                                                                                                                                                                  \nflame:/data/fuzz # ls\narm64\nflame:/data/fuzz # cd arm64/                                                                                                                                                                              \nflame:/data/fuzz/arm64 # ls\nlib  metadataretriever_fuzzer\nflame:/data/fuzz/arm64 # cd metadataretriever_fuzzer/                                                                                                                                                     \nflame:/data/fuzz/arm64/metadataretriever_fuzzer # ls\nconfig.json  metadataretriever_fuzzer\n1|flame:/data/fuzz/arm64/metadataretriever_fuzzer # mkdir corpus\nflame:/data/fuzz/arm64/metadataretriever_fuzzer # ./metadataretriever_fuzzer ./corpus/   \nINFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 3179219735\n......\nINFO:        0 files found in ./corpus/\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes\nINFO: A corpus is not provided, starting from an empty corpus\n#2\tINITED cov: 809 ft: 792 corp: 1/1b exec/s: 0 rss: 67Mb\n\tNEW_FUNC[1/19]: 0x7c1515b130  (/data/fuzz/arm64/lib/libdatasource.so+0xc130) (BuildId: e0f84a9199bae756b2cabb11bc30efe4)\n ......\n</code></pre>\n<h3 id=\"探索3adb-sync\">探索3：adb sync</h3>\n<pre><code class=\"language-shell\">ztree@ubuntu2:~/aosp/android-13.0.0_r7$ adb --help\nAndroid Debug Bridge version 1.0.41\nVersion 34.0.1-9680074\nInstalled as /home/ztree/Android/Sdk/platform-tools/adb\n\n......\n\nfile transfer:\n......\n sync [-l] [-z ALGORITHM] [-Z] [all|data|odm|oem|product|system|system_ext|vendor]\n     sync a local build from $ANDROID_PRODUCT_OUT to the device (default all)\n     -n: dry run: push files to device without storing to the filesystem\n     -l: list files that would be copied, but don't copy them\n     -z: enable compression with a specified algorithm (any/none/brotli/lz4/zstd)\n     -Z: disable compression\n\n</code></pre>\n<pre><code class=\"language-shell\"># 该环境变量前面也看过了，是在执行. build/envsetup.sh和lunch命令时设置好的\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ echo $ANDROID_PRODUCT_OUT\n/home/ztree/aosp/android-13.0.0_r7/out/target/product/flame\n</code></pre>\n<h2 id=\"4-尝试编译host版本的libfuzzer\">4 尝试编译host版本的libfuzzer</h2>\n<pre><code class=\"language-shell\"># 在Android.bp中加上支持host的编译选项\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ vim frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp\n\n\ncc_fuzz {\n    name: &quot;metadataretriever_fuzzer&quot;,\n    host_supported: true, // 加上这一行\n    srcs: [\n        &quot;metadataretriever_fuzzer.cpp&quot;,\n    ],\n    defaults: [\n        &quot;libmediaplayerserviceFuzzer_defaults&quot;,\n    ],\n    static_libs: [\n        &quot;libplayerservice_datasource&quot;,\n    ],\n    shared_libs: [\n        &quot;libdatasource&quot;,\n        &quot;libdrmframework&quot;,\n    ],\n}\n\n\n# 编译\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ SANITIZE_HOST=address m metadataretriever_fuzzer\n\n报错如下，也就是依赖的库文件没有x86-64的版本：\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libmediaplayerservice&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:static\navailable variants:\n  os:android,image:,arch:arm64_armv8-a (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk: (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk: (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libplayerservice_datasource&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:static\navailable variants:\n  os:android,image:,arch:arm64_armv8-a (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:static)\n  os:android,image:,arch:arm64_armv8-a,sdk: (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:static)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm_armv8-a (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:static)\n  os:android,image:,arch:arm_armv8-a,sdk: (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:static)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:static\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libmedia&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:shared\navailable variants:\n  os:android,image:,arch:arm64_armv8-a (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk: (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk: (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libstagefright&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:shared\navailable variants:\n  os:android,image:,arch:arm64_armv8-a (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk: (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk: (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libdatasource&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:shared\navailable variants:\n  os:android,image:,arch:arm64_armv8-a (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk: (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk: (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:static\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libdrmframework&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:shared\navailable variants:\n  os:android,image:,arch:arm64_armv8-a (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk: (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm64_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk: (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:\n  os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:latest (alias to os:android,image:,arch:arm_armv8-a,sdk:,link:shared,version:)\n20:11:52 soong bootstrap failed with: exit status 1\n\n#### failed to build some targets (14 seconds) ####\n\n</code></pre>\n<p>那重新执行一下lunch命令，选择x86-64版本会咋样？</p>\n<pre><code class=\"language-shell\"># 目标设备选择x64版本的\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ lunch aosp_x86_64-eng\n\n============================================\nPLATFORM_VERSION_CODENAME=REL\nPLATFORM_VERSION=13\nTARGET_PRODUCT=aosp_x86_64\nTARGET_BUILD_VARIANT=eng\nTARGET_BUILD_TYPE=release\nTARGET_ARCH=x86_64\nTARGET_ARCH_VARIANT=x86_64\nTARGET_2ND_ARCH=x86\nTARGET_2ND_ARCH_VARIANT=x86_64\nHOST_ARCH=x86_64\nHOST_2ND_ARCH=x86\nHOST_OS=linux\nHOST_OS_EXTRA=Linux-5.19.0-46-generic-x86_64-Ubuntu-22.04.2-LTS\nHOST_CROSS_OS=windows\nHOST_CROSS_ARCH=x86\nHOST_CROSS_2ND_ARCH=x86_64\nHOST_BUILD_TYPE=release\nBUILD_ID=TP1A.221005.002\nOUT_DIR=out\nPRODUCT_SOONG_NAMESPACES=device/generic/goldfish device/generic/goldfish-opengl hardware/google/camera hardware/google/camera/devices/EmulatedCamera\n\n# 重新编译\nztree@ubuntu2:~/aosp/android-13.0.0_r7$ SANITIZE_HOST=address m metadataretriever_fuzzer\n......\nerror: frameworks/av/media/libmediaplayerservice/fuzzer/Android.bp:77:1: dependency &quot;libdrmframework&quot; of &quot;metadataretriever_fuzzer&quot; missing variant:\n  os:linux_glibc,arch:x86_64,link:shared\navailable variants:\n  os:android,image:,arch:x86_64 (alias to os:android,image:,arch:x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_64,sdk: (alias to os:android,image:,arch:x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_64,sdk:,link:shared (alias to os:android,image:,arch:x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_64,sdk:,link:shared,version:\n  os:android,image:,arch:x86_64,sdk:,link:shared,version:latest (alias to os:android,image:,arch:x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_x86_64 (alias to os:android,image:,arch:x86_x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_x86_64,sdk: (alias to os:android,image:,arch:x86_x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_x86_64,sdk:,link:shared (alias to os:android,image:,arch:x86_x86_64,sdk:,link:shared,version:)\n  os:android,image:,arch:x86_x86_64,sdk:,link:shared,version:\n  os:android,image:,arch:x86_x86_64,sdk:,link:shared,version:latest (alias to os:android,image:,arch:x86_x86_64,sdk:,link:shared,version:)\n20:18:15 soong bootstrap failed with: exit status 1\n\n#### failed to build some targets (13 seconds) ####\n\n</code></pre>\n<p>还是不行，可以看到目标依赖是<code>os:linux_glibc</code>，而可用的依赖版本是<code>os:android</code>。暂时不知道哪些模块是可以host上运行libfuzzer，以后遇上再补充吧。</p>\n","description":"这篇主要是记录根据Google官方文档 通过 libFuzzer 进行模糊测试 来尝试在AOSP上使用libfuzzer的记录 0 环境准备 设备：Pixel 4 aosp源码：android-13.0.0_r7（这个源码是之前就下载好了...","title":"AOSP上的libfuzzer尝试","tags":[{"index":-1,"name":"FUZZ","slug":"ns5QF4Wmy","used":true,"link":"https://lzxzl.github.io/tag/ns5QF4Wmy/"}],"feature":"","link":"https://lzxzl.github.io/post/aosp-shang-de-libfuzzer-chang-shi/","stats":{"text":"20 min read","time":1148000,"words":3342,"minutes":20},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#0-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\">0 环境准备</a></li>\n<li><a href=\"#1-%E7%BC%96%E8%AF%91%E5%B9%B6%E5%88%B7%E5%85%A5%E9%95%9C%E5%83%8F\">1 编译并刷入镜像</a>\n<ul>\n<li><a href=\"#%E6%8E%A2%E7%B4%A21fastboot-device%E6%8A%A5%E9%94%99%E6%97%A0%E6%9D%83%E9%99%90\">探索1：<code>fastboot device</code>报错无权限</a></li>\n<li><a href=\"#%E6%8E%A2%E7%B4%A22-fastboot-flashall-%E6%98%AF%E6%80%8E%E4%B9%88%E5%88%B7%E9%95%9C%E5%83%8F%E7%9A%84\">探索2： fastboot flashall 是怎么刷镜像的？</a></li>\n</ul>\n</li>\n<li><a href=\"#2-%E7%BC%96%E8%AF%91%E4%B8%80%E4%B8%AAgoogle%E8%87%AA%E6%9C%89%E7%9A%84libfuzzer%E8%84%9A%E6%9C%AC%E6%89%8B%E6%9C%BA\">2 编译一个Google自有的libfuzzer脚本（手机）</a></li>\n<li><a href=\"#3-%E8%BF%90%E8%A1%8C%E6%89%8B%E6%9C%BA\">3 运行（手机）</a>\n<ul>\n<li><a href=\"#%E6%8E%A2%E7%B4%A23adb-sync\">探索3：adb sync</a></li>\n</ul>\n</li>\n<li><a href=\"#4-%E5%B0%9D%E8%AF%95%E7%BC%96%E8%AF%91host%E7%89%88%E6%9C%AC%E7%9A%84libfuzzer\">4 尝试编译host版本的libfuzzer</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-08-27 20:27:12","dateFormat":"2023-08-27"},{"fileName":"angstromctf2023-pwn","abstract":"","description":" 因为某原因，最近要看看ctf。 angstromctf2023早在4月就结束了。今天打开一看，诶，还能访问。那就下载下来做一做。 另外，搜到了一个youtube视频专门讲这个比赛的wp，下面的记录，以及pwn环境（docker）很多参考了...","title":"angstromctf2023 - pwn","tags":[{"index":-1,"name":"ctf","slug":"ctf","used":true,"link":"https://lzxzl.github.io/tag/ctf/"}],"feature":"","link":"https://lzxzl.github.io/post/angstromctf2023-pwn/","stats":{"text":"62 min read","time":3683000,"words":11630,"minutes":62},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-queue\">1 queue</a>\n<ul>\n<li><a href=\"#11-%E8%BF%90%E8%A1%8C\">1.1 运行</a></li>\n<li><a href=\"#12-%E5%8F%8D%E7%BC%96%E8%AF%91\">1.2 反编译</a></li>\n<li><a href=\"#13-%E8%B0%83%E8%AF%95\">1.3 调试</a></li>\n<li><a href=\"#14-exp\">1.4 exp</a></li>\n</ul>\n</li>\n<li><a href=\"#2-gaga\">2 gaga</a>\n<ul>\n<li><a href=\"#21-%E8%BF%90%E8%A1%8C\">2.1 运行</a></li>\n<li><a href=\"#22-%E5%8F%8D%E7%BC%96%E8%AF%91%E5%88%86%E6%9E%90\">2.2 反编译&amp;分析</a>\n<ul>\n<li><a href=\"#gaga0\">gaga0</a>\n<ul>\n<li><a href=\"#exp\">exp</a></li>\n</ul>\n</li>\n<li><a href=\"#gaga1\">gaga1</a></li>\n<li><a href=\"#gaga2\">gaga2</a></li>\n</ul>\n</li>\n<li><a href=\"#23-%E8%B0%83%E8%AF%95\">2.3 调试</a></li>\n</ul>\n</li>\n<li><a href=\"#3-leek\">3 leek</a>\n<ul>\n<li><a href=\"#31-%E8%BF%90%E8%A1%8C\">3.1 运行</a></li>\n<li><a href=\"#32-%E5%8F%8D%E7%BC%96%E8%AF%91\">3.2 反编译</a></li>\n<li><a href=\"#33-exp\">3.3 exp</a></li>\n</ul>\n</li>\n<li><a href=\"#4-widget\">4 widget</a>\n<ul>\n<li><a href=\"#41-%E8%BF%90%E8%A1%8C\">4.1 运行</a></li>\n<li><a href=\"#42-%E5%8F%8D%E7%BC%96%E8%AF%91\">4.2 反编译</a></li>\n<li><a href=\"#43-exp\">4.3 exp</a></li>\n<li><a href=\"#44-exp2\">4.4 exp2</a></li>\n</ul>\n</li>\n<li><a href=\"#5-slack\">5 slack</a>\n<ul>\n<li><a href=\"#51-%E8%BF%90%E8%A1%8C\">5.1 运行</a></li>\n<li><a href=\"#52-%E5%8F%8D%E7%BC%96%E8%AF%91\">5.2 反编译</a></li>\n<li><a href=\"#53-%E8%B0%83%E8%AF%95\">5.3 调试</a>\n<ul>\n<li><a href=\"#531-%E6%B3%84%E9%9C%B2%E6%A0%88%E5%9C%B0%E5%9D%80%E5%92%8Clibc%E5%9C%B0%E5%9D%80\">5.3.1 泄露栈地址和libc地址</a></li>\n<li><a href=\"#532-%E4%BF%AE%E6%94%B9%E5%8F%98%E9%87%8Fi%E7%9A%84%E5%80%BC%E4%B8%BA%E4%B8%80%E4%B8%AA%E5%A4%A7%E8%B4%9F%E6%95%B0\">5.3.2 修改变量i的值为一个大负数</a></li>\n<li><a href=\"#533-%E8%A6%86%E5%86%99main_ret%E4%B8%BArop%E9%93%BE\">5.3.3 覆写<code>main_ret</code>为rop链</a></li>\n</ul>\n</li>\n<li><a href=\"#54-exp\">5.4 exp</a></li>\n</ul>\n</li>\n<li><a href=\"#6-noleek\">6 noleek</a>\n<ul>\n<li><a href=\"#61-%E8%BF%90%E8%A1%8C%E5%88%86%E6%9E%90\">6.1 运行分析</a>\n<ul>\n<li><a href=\"#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8\">格式化字符串中<code>*</code>的作用</a></li>\n</ul>\n</li>\n<li><a href=\"#62-%E8%B0%83%E8%AF%95\">6.2 调试</a></li>\n<li><a href=\"#63-exp\">6.3 exp</a></li>\n</ul>\n</li>\n<li><a href=\"#7-sailors-revenge\">7 Sailor's Revenge</a></li>\n<li><a href=\"#%E5%B0%8F%E7%BB%93\">小结</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-07-16 18:47:36","dateFormat":"2023-07-16"},{"fileName":"syzkaller-shi-yong-linux","abstract":"","description":"1 环境准备 前提：支持kvm 宿主机OS版本： ztree@ubuntu2:~$ lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Descript...","title":"syzkaller使用-Linux","tags":[{"index":-1,"name":"FUZZ","slug":"ns5QF4Wmy","used":true,"link":"https://lzxzl.github.io/tag/ns5QF4Wmy/"}],"feature":"","link":"https://lzxzl.github.io/post/syzkaller-shi-yong-linux/","stats":{"text":"47 min read","time":2767000,"words":8755,"minutes":47},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\">1 环境准备</a>\n<ul>\n<li><a href=\"#11-%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E4%BE%9D%E8%B5%96\">1.1 安装软件依赖</a></li>\n<li><a href=\"#12-%E5%AE%89%E8%A3%85golang%E7%8E%AF%E5%A2%83\">1.2 安装golang环境</a></li>\n<li><a href=\"#13-%E8%AE%BE%E7%BD%AEgolang%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95\">1.3 设置golang工作目录</a></li>\n<li><a href=\"#14-%E7%BC%96%E8%AF%91syzkaller\">1.4 编译syzkaller</a></li>\n</ul>\n</li>\n<li><a href=\"#2-linux-kernel-amd64\">2 Linux Kernel - Amd64</a>\n<ul>\n<li><a href=\"#21-%E6%8B%89%E5%8F%96linux%E4%BB%A3%E7%A0%81\">2.1 拉取linux代码</a></li>\n<li><a href=\"#22-%E7%94%9F%E6%88%90%E9%BB%98%E8%AE%A4%E7%9A%84%E5%86%85%E6%A0%B8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\">2.2 生成默认的内核配置文件</a></li>\n<li><a href=\"#23-%E5%9F%BA%E4%BA%8E%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6kvm_guestconfig\">2.3 基于默认配置文件合并<code>kvm_guest.config</code></a></li>\n<li><a href=\"#24-%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6config\">2.4 修改配置文件<code>.config</code></a></li>\n<li><a href=\"#25-%E7%A1%AE%E8%AE%A4%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84config%E5%92%8C%E5%86%85%E6%A0%B8%E6%BA%90%E4%BB%A3%E7%A0%81%E6%A0%91%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9%E6%98%AF%E5%8C%B9%E9%85%8D%E7%9A%84\">2.5 确认修改后的<code>.config</code>和内核源代码树中的配置选项是匹配的</a></li>\n<li><a href=\"#26-%E5%BC%80%E5%A7%8B%E7%BC%96%E8%AF%91linux%E5%86%85%E6%A0%B8\">2.6 开始编译Linux内核</a></li>\n<li><a href=\"#27-%E6%9E%84%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%95%9C%E5%83%8F\">2.7 构建文件系统镜像</a></li>\n<li><a href=\"#28-%E8%BF%90%E8%A1%8Csyzkaller\">2.8 运行syzkaller</a>\n<ul>\n<li><a href=\"#281-isolated%E6%A8%A1%E5%BC%8F\">2.8.1 isolated模式</a></li>\n<li><a href=\"#282-qemu%E6%A8%A1%E5%BC%8F\">2.8.2 qemu模式</a></li>\n</ul>\n</li>\n<li><a href=\"#29-%E4%BE%8B%E5%AD%90-fuzz%E9%A9%B1%E5%8A%A8\">2.9 例子 - fuzz驱动</a>\n<ul>\n<li><a href=\"#291-%E7%BC%96%E8%AF%91%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%BC%8F%E6%B4%9E%E7%9A%84%E9%A9%B1%E5%8A%A8\">2.9.1 编译一个带漏洞的驱动</a></li>\n<li><a href=\"#292-%E6%B7%BB%E5%8A%A0syzkaller%E8%A7%84%E5%88%99\">2.9.2 添加syzkaller规则</a></li>\n<li><a href=\"#293-%E7%A1%AE%E8%AE%A4%E7%BC%96%E8%AF%91%E4%BA%86syz-extract%E5%92%8Csyz-sysgen\">2.9.3 确认编译了syz-extract和syz-sysgen</a></li>\n<li><a href=\"#294-%E4%BD%BF%E7%94%A8-syz-extract-%E7%94%9F%E6%88%90-const-%E6%96%87%E4%BB%B6\">2.9.4 使用 <strong>syz-extract</strong> 生成 .const 文件</a></li>\n<li><a href=\"#295-%E8%BF%90%E8%A1%8Csyz-gen\">2.9.5 运行syz-gen</a></li>\n<li><a href=\"#296-%E9%87%8D%E6%96%B0%E7%BC%96%E8%AF%91syzkaller\">2.9.6 重新编译syzkaller</a></li>\n<li><a href=\"#297-%E4%BF%AE%E6%94%B9testcfg\">2.9.7 修改test.cfg</a></li>\n<li><a href=\"#298-fuzz-%E9%A9%B1%E5%8A%A8test\">2.9.8 fuzz 驱动test</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-07-04 22:16:45","dateFormat":"2023-07-04"},{"fileName":"pwncollege-race-condictions-geng-xin-zhong","abstract":"","description":"TOCTOU level1.0 运行查看 该程序会打开一个文件，文件名是命令行中的第一个参数argv[1]。且该程序会检查文件path中不能包含flag，文件不能是一个符号链接。 hacker@race-conditions-level-...","title":"pwn.college - race condictions","tags":[],"feature":"","link":"https://lzxzl.github.io/post/pwncollege-race-condictions-geng-xin-zhong/","stats":{"text":"12 min read","time":673000,"words":2105,"minutes":12},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#toctou\">TOCTOU</a></li>\n<li><a href=\"#level10\">level1.0</a>\n<ul>\n<li><a href=\"#%E8%BF%90%E8%A1%8C%E6%9F%A5%E7%9C%8B\">运行查看</a></li>\n<li><a href=\"#ida%E5%8F%8D%E7%BC%96%E8%AF%91\">IDA反编译</a></li>\n<li><a href=\"#expolit\">Expolit</a></li>\n</ul>\n</li>\n<li><a href=\"#level11\">level1.1</a>\n<ul>\n<li><a href=\"#%E8%BF%90%E8%A1%8C%E6%9F%A5%E7%9C%8B-2\">运行查看</a></li>\n<li><a href=\"#ida%E5%8F%8D%E7%BC%96%E8%AF%91-2\">IDA反编译</a></li>\n<li><a href=\"#exploit\">Exploit</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-06-27 23:56:02","dateFormat":"2023-06-27"},{"fileName":"bluetooth-gatt-ble_ctf","abstract":"","description":"环境搭建 # 1、安装esptool ztree@ubuntu2:~/bt/ble_ctf$ sudo apt install esptool # 2、clone ble_ctf仓库 ztree@ubuntu2:~/bt$ git clo...","title":"Bluetooth - GATT - BLE_CTF","tags":[{"index":-1,"name":"Bluetooth","slug":"Bluetooth","used":true,"link":"https://lzxzl.github.io/tag/Bluetooth/"}],"feature":"","link":"https://lzxzl.github.io/post/bluetooth-gatt-ble_ctf/","stats":{"text":"43 min read","time":2541000,"words":7092,"minutes":43},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\">环境搭建</a></li>\n<li><a href=\"#flag-1\">Flag 1</a></li>\n<li><a href=\"#flag-0x002e\">Flag 0x002e</a>\n<ul>\n<li><a href=\"#handle\">handle</a></li>\n</ul>\n</li>\n<li><a href=\"#flag-0x0030\">Flag 0x0030</a></li>\n<li><a href=\"#flag-0x0016\">Flag 0x0016</a></li>\n<li><a href=\"#flag-0x0032\">Flag 0x0032</a></li>\n<li><a href=\"#flag-0x0034\">Flag 0x0034</a></li>\n<li><a href=\"#flag-0x0036\">Flag 0x0036</a></li>\n<li><a href=\"#flag-0x0038\">Flag 0x0038</a></li>\n<li><a href=\"#flag-0x003c\">Flag 0x003c</a></li>\n<li><a href=\"#flag-0x003e\">Flag 0x003e</a></li>\n<li><a href=\"#flag-0x0040\">Flag 0x0040</a></li>\n<li><a href=\"#flag-0x0042\">Flag 0x0042</a></li>\n<li><a href=\"#flag-0x0046\">Flag 0x0046</a>\n<ul>\n<li><a href=\"#gatt-indication%E5%92%8C-gatt-notification%E7%9A%84%E5%8C%BA%E5%88%AB\">Gatt Indication和 Gatt Notification的区别</a></li>\n</ul>\n</li>\n<li><a href=\"#flag-0x0048\">Flag 0x0048</a></li>\n<li><a href=\"#flag-0x004c\">Flag 0x004c</a></li>\n<li><a href=\"#flag-0x004e\">Flag 0x004e</a></li>\n<li><a href=\"#flag-0x0050\">Flag 0x0050</a></li>\n<li><a href=\"#flag-0x0052\">Flag 0x0052</a></li>\n<li><a href=\"#flag-0x0054\">Flag 0x0054</a></li>\n<li><a href=\"#flag-0x0056\">Flag 0x0056</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-06-27 23:49:10","dateFormat":"2023-06-27"},{"fileName":"codeql-ru-men-u-boot-challenge","abstract":"","description":" 根据GitHub Security Lab CTF 2: U-Boot Challenge来学习codeql， 官方的那个github机器人好像已经没了？那就自己写完跟网上的“标准答案”对比一下吧 1 环境搭建 1.1 codeql-c...","title":"CodeQL入门 - U-Boot Challenge","tags":[{"index":-1,"name":"CodeAudit","slug":"CodeAudit","used":true,"link":"https://lzxzl.github.io/tag/CodeAudit/"}],"feature":"","link":"https://lzxzl.github.io/post/codeql-ru-men-u-boot-challenge/","stats":{"text":"22 min read","time":1272000,"words":4402,"minutes":22},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\">1 环境搭建</a>\n<ul>\n<li><a href=\"#11-codeql-cli-visual-studio-code-%E6%8F%92%E4%BB%B6codeql\">1.1 codeql-cli &amp; visual studio code &amp; 插件codeql</a></li>\n<li><a href=\"#12-clone-vscode-codeql-starter\">1.2 clone vscode-codeql-starter</a></li>\n<li><a href=\"#13-%E4%B8%8B%E8%BD%BDu-boot%E5%B7%B2%E6%9C%89%E6%95%B0%E6%8D%AE%E5%BA%93\">1.3 下载u-boot已有数据库</a></li>\n<li><a href=\"#14-%E5%AF%BC%E5%85%A5vscode-codeql-starter\">1.4 导入vscode-codeql-starter</a></li>\n<li><a href=\"#15-%E5%AF%BC%E5%85%A5u-boot-%E6%95%B0%E6%8D%AE%E5%BA%93\">1.5 导入u-boot 数据库</a></li>\n<li><a href=\"#16-clone-%E8%AF%BE%E7%A8%8B%E4%BB%93%E5%BA%93\">1.6 clone 课程仓库</a></li>\n<li><a href=\"#17-%E6%8A%8A%E8%AF%BE%E7%A8%8B%E4%BB%93%E5%BA%93%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%89%8D%E9%9D%A2%E7%9A%84starter-workspace\">1.7 把课程仓库添加到前面的starter workspace</a></li>\n</ul>\n</li>\n<li><a href=\"#2-step-0-finding-the-definition-of-memcpy-ntohl-ntohll-and-ntohs\">2 Step 0: Finding the definition of memcpy, ntohl, ntohll, and ntohs</a>\n<ul>\n<li><a href=\"#21-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E5%90%8D%E4%B8%BAstrlen%E7%9A%84%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89\">2.1 找到所有名为strlen的函数定义</a></li>\n<li><a href=\"#22-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E5%90%8D%E4%B8%BAmemcpy%E7%9A%84%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89\">2.2 找到所有名为memcpy的函数定义</a></li>\n<li><a href=\"#23-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E5%90%8D%E4%B8%BAntohl-ntohll%E5%92%8C-ntohs%E7%9A%84%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E6%88%96%E5%AE%8F%E5%AE%9A%E4%B9%89\">2.3 找到所有名为<code>ntohl</code>、 <code>ntohll</code>和 <code>ntohs</code>的函数定义或宏定义</a></li>\n</ul>\n</li>\n<li><a href=\"#3-step-1-finding-the-calls-to-memcpy-ntohl-ntohll-and-ntohs\">3 Step 1: Finding the calls to memcpy, ntohl, ntohll, and ntohs</a>\n<ul>\n<li><a href=\"#31-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89memcpy%E7%9A%84%E8%B0%83%E7%94%A8\">3.1 找到所有memcpy的调用</a></li>\n<li><a href=\"#32-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89ntohl-ntohll-%E5%92%8C-ntohs%E7%9A%84%E8%B0%83%E7%94%A8\">3.2 找到所有<code>ntohl</code>、 <code>ntohll</code> 和 <code>ntohs</code>的调用</a></li>\n<li><a href=\"#33-%E6%89%BE%E5%88%B0%E6%89%80%E6%9C%89%E5%8C%85%E5%90%AB%E4%B8%8A%E9%9D%A2%E5%AE%8F%E8%B0%83%E7%94%A8%E7%9A%84%E8%A1%A8%E8%BE%BE%E5%BC%8F\">3.3 找到所有包含上面宏调用的表达式</a></li>\n</ul>\n</li>\n<li><a href=\"#4-step-2-data-flow-analysis\">4 Step 2: Data flow analysis</a>\n<ul>\n<li><a href=\"#5-step-3-find-additional-vulnerabilities\">5 Step 3: Find additional vulnerabilities</a></li>\n<li><a href=\"#%E6%A0%B9%E6%8D%AEq21%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\">根据Q2.1查询结果进行代码审计</a>\n<ul>\n<li><a href=\"#cve-2019-14192-cve-2019-14193-%E5%92%8C-cve-2019-14199\">CVE-2019-14192、 CVE-2019-14193 和 CVE-2019-14199</a></li>\n<li><a href=\"#cve-2019-14197-cve-2019-14200-cve-2019-14201-cve-2019-14202-cve-2019-14203-%E5%92%8C-cve-2019-14204\">CVE-2019-14197、CVE-2019-14200、 CVE-2019-14201、CVE-2019-14202、CVE-2019-14203 和 CVE-2019-14204</a></li>\n<li><a href=\"#cve-2019-14195\">CVE-2019-14195</a></li>\n<li><a href=\"#cve-2019-14196\">CVE-2019-14196</a></li>\n<li><a href=\"#cve-2019-14194cve-2019-14198\">CVE-2019-14194/CVE-2019-14198</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a>\n<ul>\n<li><a href=\"#%E9%81%97%E7%95%99%E9%97%AE%E9%A2%98\">遗留问题</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-06-11 03:21:05","dateFormat":"2023-06-11"},{"fileName":"pawnyable4-shou-xi-holstein-mo-kuai-yu-hong-fa-lou-dong","abstract":"","description":"首先回顾一下初始化的过程：/init -&gt; /sbin/init -&gt;......-&gt;/etc/init.d/rcS-&gt;/etc/init.d/S99pawnyable # /etc/init.d/S99pawnya...","title":"Pawnyable4 - 熟悉Holstein模块与触发漏洞","tags":[{"index":6,"name":"Linux Kernel PWN","slug":"LKPWN","used":true,"link":"https://lzxzl.github.io/tag/LKPWN/"}],"feature":"","link":"https://lzxzl.github.io/post/pawnyable4-shou-xi-holstein-mo-kuai-yu-hong-fa-lou-dong/","stats":{"text":"12 min read","time":707000,"words":2249,"minutes":12},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#holstein%E6%A8%A1%E5%9D%97\">Holstein模块</a>\n<ul>\n<li><a href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E9%80%80%E5%87%BA\">初始化和退出</a></li>\n<li><a href=\"#open\">open</a></li>\n<li><a href=\"#close\">close</a></li>\n<li><a href=\"#read\">read</a></li>\n<li><a href=\"#write\">write</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E\">栈溢出漏洞</a></li>\n<li><a href=\"#%E8%A7%A6%E5%8F%91%E6%BC%8F%E6%B4%9E\">触发漏洞</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-03-12 06:34:16","dateFormat":"2023-03-12"},{"fileName":"pawnyable3-bian-yi-he-chuan-shu-exp","abstract":"","description":"在qemu上运行exp 在 qemu 上编写、构建和运行exp很麻烦，因为每次内核崩溃时，都必须重新开始。所以在本地编译好exp后再把它发送到 qemu会方便的多。 又由于每次都输入一大串命令很麻烦，所以把这些命令放在一个 shell 脚本...","title":"Pawnyable3 - 编译和传输exp","tags":[{"index":6,"name":"Linux Kernel PWN","slug":"LKPWN","used":true,"link":"https://lzxzl.github.io/tag/LKPWN/"}],"feature":"","link":"https://lzxzl.github.io/post/pawnyable3-bian-yi-he-chuan-shu-exp/","stats":{"text":"8 min read","time":465000,"words":1631,"minutes":8},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E5%9C%A8qemu%E4%B8%8A%E8%BF%90%E8%A1%8Cexp\">在qemu上运行exp</a></li>\n<li><a href=\"#%E5%9C%A8%E8%BF%9C%E7%A8%8B%E6%9C%BA%E5%99%A8%E4%B8%8A%E8%BF%90%E8%A1%8Cexp\">在远程机器上运行exp</a></li>\n</ul>\n","date":"2023-03-11 02:37:48","dateFormat":"2023-03-11"},{"fileName":"pawnyable2-linux-kernel-lou-dong-huan-jie-ji-zhu","abstract":"","description":"本文是以pawnyable里对内核漏洞缓解技术的文章security mechanism的学习、扩展。借鉴ctf-wiki里对内核漏洞缓解技术的分类方式，从异常检测、随机化、隔离、访问控制四个角度来学习内核中的防御机制。其中有部分文字从ct...","title":"Pawnyable2 - Linux Kernel 漏洞缓解技术","tags":[{"index":6,"name":"Linux Kernel PWN","slug":"LKPWN","used":true,"link":"https://lzxzl.github.io/tag/LKPWN/"}],"feature":"","link":"https://lzxzl.github.io/post/pawnyable2-linux-kernel-lou-dong-huan-jie-ji-zhu/","stats":{"text":"36 min read","time":2156000,"words":8475,"minutes":36},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#%E5%BC%82%E5%B8%B8%E6%A3%80%E6%B5%8B\">异常检测</a>\n<ul>\n<li><a href=\"#kernel-stack-canary\">Kernel Stack Canary</a>\n<ul>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81\">查看开启状态</a></li>\n<li><a href=\"#%E5%BC%80%E5%90%AF\">开启</a></li>\n<li><a href=\"#%E5%85%B3%E9%97%AD\">关闭</a></li>\n<li><a href=\"#%E7%BB%95%E8%BF%87\">绕过</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E9%9A%8F%E6%9C%BA%E5%8C%96\">随机化</a>\n<ul>\n<li><a href=\"#kaslr\">KASLR</a>\n<ul>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81-2\">查看开启状态</a></li>\n<li><a href=\"#%E5%85%B3%E9%97%AD-2\">关闭</a>\n<ul>\n<li><a href=\"#%E7%89%A9%E7%90%86%E6%9C%BA%E8%99%9A%E6%8B%9F%E6%9C%BA\">物理机/虚拟机</a></li>\n<li><a href=\"#qemu\">qemu</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%BC%80%E5%90%AF-2\">开启</a>\n<ul>\n<li><a href=\"#%E7%89%A9%E7%90%86%E6%9C%BA%E8%99%9A%E6%8B%9F%E6%9C%BA-2\">物理机/虚拟机</a></li>\n<li><a href=\"#qemu-2\">qemu</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%BB%95%E8%BF%87-2\">绕过</a></li>\n</ul>\n</li>\n<li><a href=\"#fgkaslr\">FGKASLR</a>\n<ul>\n<li><a href=\"#%E5%BC%80%E5%90%AF-3\">开启</a></li>\n<li><a href=\"#%E5%85%B3%E9%97%AD-3\">关闭</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E9%9A%94%E7%A6%BB\">隔离</a>\n<ul>\n<li><a href=\"#%E9%BB%98%E8%AE%A4userkernel\">默认（User&amp;Kernel）</a></li>\n<li><a href=\"#smepuserkernel\">SMEP（User&amp;Kernel）</a>\n<ul>\n<li><a href=\"#%E5%87%BA%E7%8E%B0%E7%9A%84%E5%8E%9F%E5%9B%A0\">出现的原因</a></li>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81-3\">查看开启状态</a></li>\n<li><a href=\"#%E5%BC%80%E5%90%AF-4\">开启</a>\n<ul>\n<li><a href=\"#%E7%89%A9%E7%90%86%E6%9C%BA%E8%99%9A%E6%8B%9F%E6%9C%BA-3\">物理机/虚拟机</a></li>\n<li><a href=\"#qemu-3\">qemu</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%85%B3%E9%97%AD-4\">关闭</a></li>\n<li><a href=\"#%E7%BB%95%E8%BF%87-3\">绕过</a></li>\n</ul>\n</li>\n<li><a href=\"#smapuserkernel\">SMAP（User&amp;Kernel ）</a>\n<ul>\n<li><a href=\"#%E5%87%BA%E7%8E%B0%E7%9A%84%E5%8E%9F%E5%9B%A0-2\">出现的原因</a>\n<ul>\n<li><a href=\"#%E9%98%BB%E6%AD%A2stack-pivot\">阻止Stack Pivot</a></li>\n<li><a href=\"#%E9%98%B2%E6%AD%A2%E5%86%85%E6%A0%B8%E7%BC%96%E7%A8%8B%E9%94%99%E8%AF%AF\">防止内核编程错误</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81-4\">查看开启状态</a></li>\n<li><a href=\"#%E5%BC%80%E5%90%AF-5\">开启</a>\n<ul>\n<li><a href=\"#%E7%89%A9%E7%90%86%E6%9C%BA%E8%99%9A%E6%8B%9F%E6%9C%BA-4\">物理机/虚拟机</a></li>\n<li><a href=\"#qemu-4\">qemu</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%85%B3%E9%97%AD-5\">关闭</a></li>\n<li><a href=\"#%E7%BB%95%E8%BF%87-4\">绕过</a>\n<ul>\n<li><a href=\"#%E8%AE%BE%E7%BD%AE-cr4-%E5%AF%84%E5%AD%98%E5%99%A8\">设置 CR4 寄存器</a></li>\n<li><a href=\"#copy_fromto_user\">copy_from/to_user</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#kptiuserkernel\">KPTI（User&amp;Kernel）</a>\n<ul>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81-5\">查看开启状态</a></li>\n<li><a href=\"#qemu%E5%BC%80%E5%90%AF%E5%92%8C%E5%85%B3%E9%97%AD\">qemu开启和关闭</a></li>\n<li><a href=\"#%E7%BB%95%E8%BF%87-5\">绕过</a></li>\n<li><a href=\"#cpu-%E6%BC%8F%E6%B4%9E%E7%BC%93%E8%A7%A3%E6%8A%80%E6%9C%AF\">CPU 漏洞缓解技术</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%A0%86%E5%9D%97%E9%9A%94%E7%A6%BBinside-kernel\">堆块隔离（Inside Kernel）</a></li>\n</ul>\n</li>\n<li><a href=\"#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6\">访问控制</a>\n<ul>\n<li><a href=\"#dmesg_restrict%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2\">dmesg_restrict（信息泄露）</a>\n<ul>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81-6\">查看开启状态</a></li>\n<li><a href=\"#%E5%BC%80%E5%90%AF-6\">开启</a></li>\n<li><a href=\"#%E5%85%B3%E9%97%AD-6\">关闭</a></li>\n</ul>\n</li>\n<li><a href=\"#kadrkptr_restrict%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2\">KADR（kptr_restrict）（信息泄露）</a>\n<ul>\n<li><a href=\"#%E6%9F%A5%E7%9C%8B%E5%BC%80%E5%90%AF%E7%8A%B6%E6%80%81-7\">查看开启状态</a></li>\n<li><a href=\"#%E5%BC%80%E5%90%AF-7\">开启</a></li>\n<li><a href=\"#%E5%85%B3%E9%97%AD-7\">关闭</a></li>\n</ul>\n</li>\n<li><a href=\"#__ro_after_init\">__ro_after_init</a></li>\n<li><a href=\"#mmap_min_addr\">mmap_min_addr</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n","date":"2023-03-10 01:18:34","dateFormat":"2023-03-10"},{"fileName":"pawnyable1-linux-kernel-pwn-jian-jie-yu-diao-shi-huan-jing-da-jian","abstract":"","description":"1 内核漏洞利用的特点 2 调试环境搭建 2.1 启动 ########## 1、安装qemu lzx@ubuntu:~$ sudo apt install qemu-system ########## 2、解压 lzx@ubuntu:...","title":"Pawnyable1 - Linux Kernel PWN 简介与调试环境搭建","tags":[{"index":6,"name":"Linux Kernel PWN","slug":"LKPWN","used":true,"link":"https://lzxzl.github.io/tag/LKPWN/"}],"feature":"","link":"https://lzxzl.github.io/post/pawnyable1-linux-kernel-pwn-jian-jie-yu-diao-shi-huan-jing-da-jian/","stats":{"text":"11 min read","time":625000,"words":2071,"minutes":11},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#1-%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9A%84%E7%89%B9%E7%82%B9\">1 内核漏洞利用的特点</a></li>\n<li><a href=\"#2-%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\">2 调试环境搭建</a>\n<ul>\n<li><a href=\"#21-%E5%90%AF%E5%8A%A8\">2.1 启动</a></li>\n<li><a href=\"#22-gdb%E8%B0%83%E8%AF%95%E5%86%85%E6%A0%B8\">2.2 gdb调试内核</a>\n<ul>\n<li><a href=\"#221-%E8%8E%B7%E5%8F%96root%E6%9D%83%E9%99%90\">2.2.1 获取root权限</a></li>\n<li><a href=\"#222-attach%E5%88%B0gdb\">2.2.2 attach到gdb</a></li>\n<li><a href=\"#223-gdb%E5%9F%BA%E7%A1%80%E8%B0%83%E8%AF%95\">2.2.3 gdb基础调试</a></li>\n<li><a href=\"#224-gdb%E8%B0%83%E8%AF%95%E9%A9%B1%E5%8A%A8\">2.2.4 gdb调试驱动</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\">参考文献</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-03-04 00:42:17","dateFormat":"2023-03-04"},{"fileName":"lesslesstu-jie-mi-ma-ji-zhu-greatergreater-di-1-2-zhang-bi-ji","abstract":"","description":"第1章 环游密码世界 1.2 密码 发送者（sender）：当某个人向另一个人发送信息时，发出信息的人称为发送者。 接收者（receiver）：收到信息的人称为接收者。 消息（message）：被发送的信息 窃听者（eavesdroppe...","title":"《图解密码技术》第1-2章 - 笔记","tags":[],"feature":"","link":"https://lzxzl.github.io/post/lesslesstu-jie-mi-ma-ji-zhu-greatergreater-di-1-2-zhang-bi-ji/","stats":{"text":"4 min read","time":208000,"words":978,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li><a href=\"#%E7%AC%AC1%E7%AB%A0-%E7%8E%AF%E6%B8%B8%E5%AF%86%E7%A0%81%E4%B8%96%E7%95%8C\">第1章 环游密码世界</a>\n<ul>\n<li><a href=\"#12-%E5%AF%86%E7%A0%81\">1.2 密码</a></li>\n<li><a href=\"#13-%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E4%B8%8E%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81\">1.3 对称密码与公钥密码</a></li>\n<li><a href=\"#14-%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E6%8A%80%E6%9C%AF\">1.4 其他密码技术</a></li>\n<li><a href=\"#15-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AE%B6%E7%9A%84%E5%B7%A5%E5%85%B7%E7%AE%B1\">1.5 密码学家的工具箱</a></li>\n<li><a href=\"#16-%E9%9A%90%E5%86%99%E6%9C%AF%E4%B8%8E%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0\">1.6 隐写术与数字水印</a></li>\n<li><a href=\"#17-%E5%AF%86%E7%A0%81%E4%B8%8E%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B8%B8%E8%AF%86\">1.7 密码与信息安全常识</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%AC%AC2%E7%AB%A0-%E5%8E%86%E5%8F%B2%E4%B8%8A%E7%9A%84%E5%AF%86%E7%A0%81\">第2章 历史上的密码</a>\n<ul>\n<li><a href=\"#21-%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81\">2.1 凯撒密码</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n","date":"2022-04-29 11:40:08","dateFormat":"2022-04-29"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-12","abstract":"","description":" “Be not afraid of going slowly; be afraid only of standing still.” - Chinese proverb. “不怕慢，只怕原地踏步”——中国谚语。 Hello, and w...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part 12.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-12/","stats":{"text":"13 min read","time":760000,"words":2629,"minutes":13},"isTop":false,"toc":"","date":"2021-12-06 17:59:26","dateFormat":"2021-12-06"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-11","abstract":"","description":"I was sitting in my room the other day and thinking about how much we had covered, and I thought I would recap what we’v...","title":"[翻译与学习] Let's Build A Simple Interpreter. Part 11.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-11/","stats":{"text":"35 min read","time":2093000,"words":7229,"minutes":35},"isTop":false,"toc":"","date":"2021-12-06 17:26:07","dateFormat":"2021-12-06"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10","abstract":"","description":"Today we will continue closing the gap between where we are right now and where we want to be: a fully functional interp...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part 10.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-10/","stats":{"text":"24 min read","time":1382000,"words":4642,"minutes":24},"isTop":false,"toc":"","date":"2021-12-06 14:40:55","dateFormat":"2021-12-06"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-9","abstract":"","description":"I remember when I was in university (a long time ago) and learning systems programming, I believed that the only “real” ...","title":"[翻译与学习] Let's Build A Simple Interpreter. Part 9","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-9/","stats":{"text":"34 min read","time":2013000,"words":6998,"minutes":34},"isTop":false,"toc":"","date":"2021-12-06 11:27:28","dateFormat":"2021-12-06"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-8","abstract":"","description":"Today we’ll talk about unary operators, namely unary plus (+) and unary minus (-) operators. 今天我们将讨论一元运算符，即一元加号(+)和一元减号(...","title":"[翻译与学习] Let's Build A Simple Interpreter. Part 8.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part-8/","stats":{"text":"11 min read","time":655000,"words":2188,"minutes":11},"isTop":false,"toc":"","date":"2021-12-06 09:02:55","dateFormat":"2021-12-06"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part7-abstract-syntax-trees","abstract":"","description":"As I promised you last time, today I will talk about one of the central data structures that we’ll use throughout the re...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part7. Abstract Syntax Trees","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part7-abstract-syntax-trees/","stats":{"text":"44 min read","time":2602000,"words":8881,"minutes":44},"isTop":false,"toc":"","date":"2021-12-05 21:29:54","dateFormat":"2021-12-05"},{"fileName":"lets-build-a-simple-interpreter-part6-java-ban-ben","abstract":"","description":"学到Part6，用Java重写了解释器。 把这几个类拆开放了，共三个文件： src ├── Interpreter.java ├── Lexer.java └── Token.java Token.java pub...","title":"Let’s Build A Simple Interpreter. Part6. —— Java版本","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/lets-build-a-simple-interpreter-part6-java-ban-ben/","stats":{"text":"6 min read","time":348000,"words":1111,"minutes":6},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"#tokenjava\">Token.java</a></li>\n<li><a href=\"#lexerjava-%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8\">Lexer.java （词法分析器）</a></li>\n<li><a href=\"#interpreterjava%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8%E5%92%8C%E8%A7%A3%E9%87%8A%E5%99%A8\">Interpreter.java（语法分析器和解释器）</a></li>\n<li><a href=\"#%E6%B5%8B%E8%AF%95\">测试</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n","date":"2021-11-11 22:25:42","dateFormat":"2021-11-11"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part6","abstract":"","description":"Today is the day 😃 “Why?” you might ask. The reason is that today we’re wrapping up our discussion of arithmetic expres...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part6.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part6/","stats":{"text":"13 min read","time":762000,"words":2456,"minutes":13},"isTop":false,"toc":"","date":"2021-11-11 22:18:04","dateFormat":"2021-11-11"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5","abstract":"","description":"How do you tackle something as complex as understanding how to create an interpreter or compiler? In the beginning it al...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part5.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part5/","stats":{"text":"25 min read","time":1462000,"words":4986,"minutes":25},"isTop":false,"toc":"","date":"2021-11-11 22:07:33","dateFormat":"2021-11-11"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4","abstract":"","description":"Have you been passively learning the material in these articles or have you been actively practicing it? I hope you’ve b...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part4.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part4/","stats":{"text":"34 min read","time":2025000,"words":7083,"minutes":34},"isTop":false,"toc":"","date":"2021-11-11 21:24:31","dateFormat":"2021-11-11"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3","abstract":"","description":"I woke up this morning and I thought to myself: “Why do we find it so difficult to learn a new skill?” 今天早上我醒来，我对自己说: “为...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part3.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part3/","stats":{"text":"26 min read","time":1550000,"words":5235,"minutes":26},"isTop":false,"toc":"","date":"2021-11-11 21:20:29","dateFormat":"2021-11-11"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part2","abstract":"","description":"In their amazing book “The 5 Elements of Effective Thinking” the authors Burger and Starbird share a story about how the...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part2.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part2/","stats":{"text":"21 min read","time":1245000,"words":4124,"minutes":21},"isTop":false,"toc":"","date":"2021-11-11 20:31:46","dateFormat":"2021-11-11"},{"fileName":"fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part1","abstract":"","description":" “If you don’t know how compilers work, then you don’t know how computers work. If you’re not 100% sure whether you know...","title":"[翻译与学习] Let’s Build A Simple Interpreter. Part1.","tags":[{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/"}],"feature":"","link":"https://lzxzl.github.io/post/fan-yi-yu-xue-xi-lets-build-a-simple-interpreter-part1/","stats":{"text":"27 min read","time":1612000,"words":5898,"minutes":27},"isTop":false,"toc":"","date":"2021-11-11 18:11:42","dateFormat":"2021-11-11"}],"tags":[{"name":"driver","slug":"-TOvc86iuIg","used":true,"link":"https://lzxzl.github.io/tag/-TOvc86iuIg/","count":8},{"name":"cve","slug":"n9VHR0XHxuk","used":true,"link":"https://lzxzl.github.io/tag/n9VHR0XHxuk/","count":7},{"name":"samsung","slug":"cLODIMrMR9","used":true,"link":"https://lzxzl.github.io/tag/cLODIMrMR9/","count":2},{"name":"web3","slug":"lA8opWZT2D","used":true,"link":"https://lzxzl.github.io/tag/lA8opWZT2D/","count":1},{"name":"solidity","slug":"42dj8xvgT9v","used":true,"link":"https://lzxzl.github.io/tag/42dj8xvgT9v/","count":1},{"name":"gpu","slug":"LCPtoskbRl","used":true,"link":"https://lzxzl.github.io/tag/LCPtoskbRl/","count":1},{"name":"mali","slug":"BKUV3xCGrH","used":true,"link":"https://lzxzl.github.io/tag/BKUV3xCGrH/","count":1},{"index":-1,"name":"Android-CVE","slug":"Android-CVE","used":true,"link":"https://lzxzl.github.io/tag/Android-CVE/","count":20},{"name":"info-leak","slug":"XOAss1DVS","used":true,"link":"https://lzxzl.github.io/tag/XOAss1DVS/","count":1},{"name":"linux kernel exploit","slug":"LlmtM56SL","used":true,"link":"https://lzxzl.github.io/tag/LlmtM56SL/","count":2},{"name":"protocol stack","slug":"kkTayTYwi","used":true,"link":"https://lzxzl.github.io/tag/kkTayTYwi/","count":1},{"index":6,"name":"Linux Kernel PWN","slug":"LKPWN","used":true,"link":"https://lzxzl.github.io/tag/LKPWN/","count":5},{"index":-1,"name":"FUZZ","slug":"ns5QF4Wmy","used":true,"link":"https://lzxzl.github.io/tag/ns5QF4Wmy/","count":2},{"index":-1,"name":"ctf","slug":"ctf","used":true,"link":"https://lzxzl.github.io/tag/ctf/","count":1},{"index":-1,"name":"Bluetooth","slug":"Bluetooth","used":true,"link":"https://lzxzl.github.io/tag/Bluetooth/","count":1},{"index":-1,"name":"CodeAudit","slug":"CodeAudit","used":true,"link":"https://lzxzl.github.io/tag/CodeAudit/","count":1},{"index":-1,"name":"编译原理","slug":"GqQg6_YXk","used":true,"link":"https://lzxzl.github.io/tag/GqQg6_YXk/","count":13}],"menus":[{"link":"/","name":"首页","openType":"Internal"},{"link":"/archives","name":"归档","openType":"Internal"},{"link":"/tags","name":"标签","openType":"Internal"},{"link":"/post/about","name":"关于","openType":"Internal"}],"themeConfig":{"themeName":"Chic","postPageSize":10,"archivesPageSize":50,"siteName":"ztree","siteDescription":"","footerInfo":"ztree","showFeatureImage":true,"domain":"https://lzxzl.github.io","postUrlFormat":"SLUG","tagUrlFormat":"SHORT_ID","dateFormat":"YYYY-MM-DD","feedFullText":true,"feedCount":10,"archivesPath":"archives","postPath":"post","tagPath":"tag"},"customConfig":{"Valine":"off","author":"ztree","baidu":"on","bs":"","cdnSetting":"","copyright":"on","description":"竹杖芒鞋轻胜马，谁怕？一蓑烟雨任平生。","donate":"off","donate_alipay":"","donate_wechat":"","facebook":"","friends":[{"description":"","siteLink":"","siteLogo":"","siteName":""}],"ga":"","github":"https://github.com/lzxzl","icpcode":"","icpinfo":"","instagram":"","keywords":"Binary","language":"zh","linkedin":"","list":"on","live2d":"off","live2dDebug":"off","love_click_animation":"off","music":"off","musicModel":"fixed","musics":[{"description":"","siteLink":"","siteLogo":"","siteName":""}],"platformLink":"https://lzxzl.github.io/","platformName":"ztree","prismSetting":"https://fastly.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/css/Card/prism.min.css","qq":"1371418134","rss":"","send":"","sentence":"off","siteFont":"-apple-system,BlinkMacSystemFont,'Helvetica Neue','PingFang SC','Hiragino Sans GB','Droid Sans Fallback','Microsoft YaHei',sans-serif","supportAuthor":"off","tumblr":"","twitter":"","update":"off","valineAppId":"","valineAppKey":"","valineAvatar":"mp","valineHighlight":true,"valinePageSize":10,"valinePlaceholder":"来都来了，不妨评论一下","valineRecordIp":true,"valineVisitor":true,"version":"1.7.6","view":"on","weather":"on","weibo":"","youtube":""},"utils":{"now":1747748455692}}